(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[915],{27063:(e,t,s)=>{"use strict";s.d(t,{CG:()=>c,Fm:()=>x,Qs:()=>f,cj:()=>d,h:()=>u,qp:()=>g});var a=s(95155),l=s(12115),i=s(93409),r=s(83101),n=s(65229),o=s(64269);let d=i.bL,c=i.l9;i.bm;let m=i.ZL,p=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(i.hJ,{className:(0,o.cn)("fixed inset-0 z-50 bg-black/50 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...l,ref:t})});p.displayName=i.hJ.displayName;let h=(0,r.F)("fixed z-50 gap-4 bg-white p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-300",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),u=l.forwardRef((e,t)=>{let{side:s="right",className:l,children:r,...d}=e;return(0,a.jsxs)(m,{children:[(0,a.jsx)(p,{}),(0,a.jsxs)(i.UC,{ref:t,className:(0,o.cn)(h({side:s}),l),...d,children:[r,(0,a.jsxs)(i.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-white transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-astralis-blue focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-slate-100",children:[(0,a.jsx)(n.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});u.displayName=i.UC.displayName;let x=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...s})};x.displayName="SheetHeader";let g=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(i.hE,{ref:t,className:(0,o.cn)("text-lg font-semibold text-astralis-navy",s),...l})});g.displayName=i.hE.displayName;let f=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(i.VY,{ref:t,className:(0,o.cn)("text-sm text-slate-600",s),...l})});f.displayName=i.VY.displayName},30592:(e,t,s)=>{Promise.resolve().then(s.bind(s,50707))},50707:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>M});var a=s(95155),l=s(12115),i=s(64903),r=s(44521),n=s(49476),o=s(86948),d=s(64269);let c={0:"bg-slate-100 text-slate-600",1:"bg-blue-100 text-blue-600",2:"bg-orange-100 text-orange-600",3:"bg-red-100 text-red-600"};function m(e){let{item:t,isDragging:s=!1}=e,{attributes:l,listeners:i,setNodeRef:m,transform:p}=(0,r.PM)({id:t.id}),h=p?{transform:"translate3d(".concat(p.x,"px, ").concat(p.y,"px, 0)")}:void 0;return(0,a.jsx)("div",{ref:m,style:h,...i,...l,className:(0,d.cn)("transition-all duration-200 cursor-grab active:cursor-grabbing touch-none",s&&"opacity-50 scale-95"),children:(0,a.jsx)(o.Zp,{variant:"default",hover:!0,className:(0,d.cn)("border-2 transition-colors",s&&"border-purple-500 bg-purple-50 shadow-lg shadow-purple-200"),children:(0,a.jsx)(o.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)("div",{className:"mt-1 text-slate-400",children:(0,a.jsx)(n.A,{className:"w-4 h-4"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h4",{className:"font-medium text-sm text-astralis-navy line-clamp-2",children:t.title}),t.description&&(0,a.jsx)("p",{className:"text-xs text-slate-500 mt-1 line-clamp-2",children:t.description}),t.tags&&t.tags.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-1 mt-2",children:t.tags.slice(0,3).map(e=>(0,a.jsx)("span",{className:"text-xs px-2 py-0.5 bg-slate-100 text-slate-600 rounded",children:e},e))}),t.priority>0&&(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsxs)("span",{className:(0,d.cn)("text-xs px-2 py-0.5 rounded font-medium",c[t.priority]||c[0]),children:["P",t.priority]})})]})]})})})})}var p=s(6191),h=s(51834),u=s(3998),x=s(65142),g=s(76444),f=s(31120),j=function(e){return e[e.NONE=0]="NONE",e[e.LOW=1]="LOW",e[e.MEDIUM=2]="MEDIUM",e[e.HIGH=3]="HIGH",e[e.URGENT=4]="URGENT",e}({}),N=function(e){return e.NOT_STARTED="NOT_STARTED",e.IN_PROGRESS="IN_PROGRESS",e.BLOCKED="BLOCKED",e.COMPLETED="COMPLETED",e}({});let v=[{value:j.NONE,label:"None",color:"text-slate-600"},{value:j.LOW,label:"Low",color:"text-blue-600"},{value:j.MEDIUM,label:"Medium",color:"text-yellow-600"},{value:j.HIGH,label:"High",color:"text-orange-600"},{value:j.URGENT,label:"Urgent",color:"text-red-600"}],b=[{value:N.NOT_STARTED,label:"Not Started"},{value:N.IN_PROGRESS,label:"In Progress"},{value:N.BLOCKED,label:"Blocked"},{value:N.COMPLETED,label:"Completed"}];function y(e){let{pipelineId:t,stageId:s,stageName:i,onItemCreated:r,trigger:n}=e,[o,d]=(0,l.useState)(!1),[c,m]=(0,l.useState)(!1),[y,w]=(0,l.useState)({title:"",description:"",priority:j.NONE,status:N.NOT_STARTED,dueDate:"",tags:""}),C=()=>{d(!1),w({title:"",description:"",priority:j.NONE,status:N.NOT_STARTED,dueDate:"",tags:""})},E=async e=>{e.preventDefault(),m(!0);try{let e=y.tags.split(",").map(e=>e.trim()).filter(e=>e.length>0),a=await fetch("/api/pipelines/".concat(t,"/items"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:y.title,description:y.description||void 0,priority:y.priority,status:y.status,dueDate:y.dueDate||null,tags:e,stageId:s})});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to create item")}null==r||r(),C()}catch(e){console.error("Error creating item:",e),alert(e instanceof Error?e.message:"Failed to create item")}finally{m(!1)}};return(0,a.jsxs)(h.lG,{open:o,onOpenChange:d,children:[(0,a.jsx)(h.zM,{asChild:!0,children:n||(0,a.jsxs)(u.$,{variant:"outline",size:"sm",className:"w-full gap-2",children:[(0,a.jsx)(p.A,{className:"w-4 h-4"}),"Add Item"]})}),(0,a.jsx)(h.Cf,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("form",{onSubmit:E,children:[(0,a.jsxs)(h.c7,{children:[(0,a.jsx)(h.L3,{children:"New Item"}),(0,a.jsxs)(h.rr,{children:["Add a new item to ",(0,a.jsx)("span",{className:"font-medium",children:i})]})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(g.J,{htmlFor:"title",children:["Title ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(x.p,{id:"title",value:y.title,onChange:e=>w({...y,title:e.target.value}),placeholder:"Enter item title...",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"description",children:"Description"}),(0,a.jsx)(f.T,{id:"description",value:y.description,onChange:e=>w({...y,description:e.target.value}),placeholder:"Describe this item...",rows:4})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"priority",children:"Priority"}),(0,a.jsx)("select",{id:"priority",value:y.priority,onChange:e=>w({...y,priority:Number(e.target.value)}),className:"w-full px-3 py-2 border border-slate-200 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-astralis-blue focus:border-transparent",children:v.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"status",children:"Status"}),(0,a.jsx)("select",{id:"status",value:y.status,onChange:e=>w({...y,status:e.target.value}),className:"w-full px-3 py-2 border border-slate-200 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-astralis-blue focus:border-transparent",children:b.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"dueDate",children:"Due Date"}),(0,a.jsx)(x.p,{id:"dueDate",type:"date",value:y.dueDate,onChange:e=>w({...y,dueDate:e.target.value})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"tags",children:"Tags"}),(0,a.jsx)(x.p,{id:"tags",value:y.tags,onChange:e=>w({...y,tags:e.target.value}),placeholder:"e.g., bug, feature, urgent (comma-separated)"}),(0,a.jsx)("p",{className:"text-xs text-slate-500",children:"Separate multiple tags with commas"})]})]}),(0,a.jsxs)(h.Es,{children:[(0,a.jsx)(u.$,{type:"button",variant:"outline",onClick:C,disabled:c,children:"Cancel"}),(0,a.jsx)(u.$,{type:"submit",disabled:c,children:c?"Creating...":"Create Item"})]})]})})]})}function w(e){let{stage:t,items:s,pipelineId:l,onItemCreated:i}=e,{setNodeRef:n,isOver:o}=(0,r.zM)({id:t.id});return(0,a.jsx)("div",{className:"flex-shrink-0 w-80",children:(0,a.jsxs)("div",{className:"bg-slate-100 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[t.color&&(0,a.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:t.color}}),(0,a.jsx)("h3",{className:"font-semibold text-astralis-navy",children:t.name})]}),(0,a.jsx)("span",{className:"text-sm text-slate-500 bg-white px-2 py-1 rounded",children:s.length})]}),(0,a.jsxs)("div",{ref:n,className:(0,d.cn)("space-y-3 min-h-[200px] transition-colors",o&&"bg-astralis-blue/10 rounded-lg p-2"),children:[s.map(e=>(0,a.jsx)(m,{item:e},e.id)),0===s.length&&(0,a.jsx)("div",{className:"text-center py-12 text-slate-400 text-sm",children:"Drop items here"})]}),(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)(y,{pipelineId:l,stageId:t.id,stageName:t.name,onItemCreated:i})})]})})}function C(e){let{pipeline:t,onRefetch:s}=e,[n,o]=(0,l.useState)(null),d=(0,i.Cs)(),c=(0,r.FR)((0,r.MS)(r.AN,{activationConstraint:{distance:8}})),p=()=>{null==s||s()};return(0,a.jsxs)(r.Mp,{sensors:c,collisionDetection:r.fp,onDragStart:e=>{let{active:s}=e,a=t.stages.flatMap(e=>e.items).find(e=>e.id===s.id);a&&o(a)},onDragEnd:e=>{let{active:s,over:a}=e;if(!a)return void o(null);let l=s.id,i=a.id,r=t.stages.find(e=>e.items.some(e=>e.id===l));if(!r||r.id===i)return void o(null);d.mutate({itemId:l,pipelineId:t.id,targetStageId:i}),o(null)},children:[(0,a.jsx)("div",{className:"flex gap-6 h-full overflow-x-auto pb-6",children:t.stages.map(e=>(0,a.jsx)(w,{stage:e,items:e.items,pipelineId:t.id,onItemCreated:p},e.id))}),(0,a.jsx)(r.Hd,{children:n?(0,a.jsx)("div",{className:"rotate-2 scale-105",children:(0,a.jsx)(m,{item:n,isDragging:!0})}):null})]})}var E=s(21190),S=s(71360);let D=["#64748b","#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899","#14b8a6"];function T(e){let{pipelineId:t,stages:s,onStagesChange:i}=e,[r,o]=(0,l.useState)(!1),[c,m]=(0,l.useState)(null),[j,N]=(0,l.useState)(!1),[v,b]=(0,l.useState)({name:"",description:"",color:D[0]}),y=e=>{e?(m(e),b({name:e.name,description:e.description||"",color:e.color||D[0]})):(m(null),b({name:"",description:"",color:D[0]})),o(!0)},w=()=>{o(!1),m(null),b({name:"",description:"",color:D[0]})},C=async e=>{e.preventDefault(),N(!0);try{if(c){if(!(await fetch("/api/pipelines/".concat(t,"/stages/").concat(c.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)})).ok)throw Error("Failed to update stage")}else if(!(await fetch("/api/pipelines/".concat(t,"/stages"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...v,order:s.length})})).ok)throw Error("Failed to create stage");null==i||i(),w()}catch(e){console.error("Error saving stage:",e),alert(e instanceof Error?e.message:"Failed to save stage")}finally{N(!1)}},T=async e=>{if(confirm("Are you sure you want to delete this stage? This cannot be undone."))try{let s=await fetch("/api/pipelines/".concat(t,"/stages/").concat(e),{method:"DELETE"});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to delete stage")}null==i||i()}catch(e){console.error("Error deleting stage:",e),alert(e instanceof Error?e.message:"Failed to delete stage")}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-3",children:[s.map(e=>(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-white border border-slate-200 rounded-lg hover:border-slate-300 transition-colors",children:[(0,a.jsx)("button",{className:"text-slate-400 hover:text-slate-600 cursor-grab","aria-label":"Drag to reorder",children:(0,a.jsx)(n.A,{className:"w-4 h-4"})}),e.color&&(0,a.jsx)("div",{className:"w-3 h-3 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h4",{className:"font-medium text-sm text-astralis-navy truncate",children:e.name}),e.description&&(0,a.jsx)("p",{className:"text-xs text-slate-500 truncate",children:e.description})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(u.$,{variant:"ghost",size:"icon",onClick:()=>y(e),className:"h-8 w-8",children:(0,a.jsx)(E.A,{className:"w-4 h-4"})}),(0,a.jsx)(u.$,{variant:"ghost",size:"icon",onClick:()=>T(e.id),className:"h-8 w-8 text-red-600 hover:text-red-700 hover:bg-red-50",children:(0,a.jsx)(S.A,{className:"w-4 h-4"})})]})]},e.id)),(0,a.jsxs)(u.$,{variant:"outline",onClick:()=>y(),className:"w-full",children:[(0,a.jsx)(p.A,{className:"w-4 h-4 mr-2"}),"Add Stage"]})]}),(0,a.jsx)(h.lG,{open:r,onOpenChange:o,children:(0,a.jsx)(h.Cf,{children:(0,a.jsxs)("form",{onSubmit:C,children:[(0,a.jsxs)(h.c7,{children:[(0,a.jsx)(h.L3,{children:c?"Edit Stage":"New Stage"}),(0,a.jsx)(h.rr,{children:c?"Update the stage details":"Create a new stage in this pipeline"})]}),(0,a.jsxs)("div",{className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"name",children:"Stage Name"}),(0,a.jsx)(x.p,{id:"name",value:v.name,onChange:e=>b({...v,name:e.target.value}),placeholder:"e.g., Backlog, In Progress, Review",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{htmlFor:"description",children:"Description (Optional)"}),(0,a.jsx)(f.T,{id:"description",value:v.description,onChange:e=>b({...v,description:e.target.value}),placeholder:"Describe this stage...",rows:3})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(g.J,{children:"Color"}),(0,a.jsx)("div",{className:"flex gap-2",children:D.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>b({...v,color:e}),className:(0,d.cn)("w-8 h-8 rounded-full border-2 transition-all",v.color===e?"border-astralis-navy scale-110":"border-transparent hover:scale-105"),style:{backgroundColor:e},"aria-label":"Select ".concat(e)},e))})]})]}),(0,a.jsxs)(h.Es,{children:[(0,a.jsx)(u.$,{type:"button",variant:"outline",onClick:w,disabled:j,children:"Cancel"}),(0,a.jsx)(u.$,{type:"submit",disabled:j,children:j?"Saving...":c?"Update Stage":"Create Stage"})]})]})})})]})}var I=s(35626),O=s(15870),k=s(52619),F=s.n(k),A=s(27063);function M(e){let{params:t}=e,{id:s}=(0,l.use)(t),{data:r,isLoading:n,error:o,refetch:d}=(0,i.IM)(s),[c,m]=(0,l.useState)(!1);return n?(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-astralis-blue"})}):o||!r?(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-red-600",children:"Failed to load pipeline"})}):(0,a.jsxs)("div",{className:"space-y-6 h-full flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)(F(),{href:"/pipelines",children:(0,a.jsxs)(u.$,{variant:"ghost",size:"sm",className:"gap-2",children:[(0,a.jsx)(I.A,{className:"w-4 h-4"}),"Back"]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-astralis-navy",children:r.name}),r.description&&(0,a.jsx)("p",{className:"text-slate-600 mt-1",children:r.description})]})]}),(0,a.jsxs)(A.cj,{open:c,onOpenChange:m,children:[(0,a.jsx)(A.CG,{asChild:!0,children:(0,a.jsxs)(u.$,{variant:"outline",className:"gap-2",children:[(0,a.jsx)(O.A,{className:"w-4 h-4"}),"Manage Stages"]})}),(0,a.jsxs)(A.h,{children:[(0,a.jsxs)(A.Fm,{children:[(0,a.jsx)(A.qp,{children:"Pipeline Stages"}),(0,a.jsx)(A.Qs,{children:"Add, edit, or remove stages in this pipeline"})]}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsx)(T,{pipelineId:r.id,stages:r.stages,onStagesChange:()=>{d()}})})]})]})]}),0===r.stages.length?(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center max-w-md",children:[(0,a.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-slate-100 flex items-center justify-center",children:(0,a.jsx)(O.A,{className:"w-8 h-8 text-slate-400"})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-astralis-navy mb-2",children:"No stages yet"}),(0,a.jsx)("p",{className:"text-slate-600 mb-6",children:"Get started by creating stages for your pipeline. Stages help organize work items as they move through your workflow."}),(0,a.jsxs)(u.$,{onClick:()=>m(!0),className:"gap-2",children:[(0,a.jsx)(O.A,{className:"w-4 h-4"}),"Create First Stage"]})]})}):(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,a.jsx)(C,{pipeline:r,onRefetch:d})})]})}},64903:(e,t,s)=>{"use strict";s.d(t,{Cs:()=>c,IM:()=>d,be:()=>o});var a=s(22454),l=s(99776),i=s(80549),r=s(36489),n=s(37507);function o(){var e;let{data:t}=(0,r.useSession)(),s=null==t||null==(e=t.user)?void 0:e.orgId;return(0,a.I)({queryKey:s?n.fQ.list(s):["pipelines"],queryFn:async()=>{if(!s)throw Error("No organization ID");let e=await fetch("/api/pipelines?orgId=".concat(s));if(!e.ok)throw Error("Failed to fetch pipelines");return(await e.json()).pipelines},enabled:!!s,staleTime:3e4})}function d(e){var t;let{data:s}=(0,r.useSession)(),l=null==s||null==(t=s.user)?void 0:t.orgId;return(0,a.I)({queryKey:n.fQ.detail(e),queryFn:async()=>{let t=await fetch("/api/pipelines/".concat(e,"?orgId=").concat(l));if(!t.ok)throw Error("Failed to fetch pipeline");return await t.json()},enabled:!!e&&!!l,refetchInterval:3e4})}function c(){let e=(0,l.jE)();return(0,i.n)({mutationFn:async e=>{let{itemId:t,pipelineId:s,targetStageId:a}=e,l=await fetch("/api/pipelines/".concat(s,"/items/").concat(t,"/move"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({targetStageId:a})});if(!l.ok)throw Error("Failed to move item");return l.json()},onMutate:async t=>{let{itemId:s,pipelineId:a,targetStageId:l}=t,i=n.fQ.detail(a);await e.cancelQueries({queryKey:i});let r=e.getQueryData(i);return e.setQueryData(i,e=>{if(!e)return e;let t=e.stages.map(t=>{let a=t.items.filter(e=>e.id!==s);if(t.id===l){let i=e.stages.flatMap(e=>e.items).find(e=>e.id===s);if(i)return{...t,items:[...a,{...i,stageId:l}]}}return{...t,items:a}});return{...e,stages:t}}),{previousPipeline:r}},onError:(t,s,a)=>{(null==a?void 0:a.previousPipeline)&&e.setQueryData(n.fQ.detail(s.pipelineId),a.previousPipeline)},onSettled:(t,s,a)=>{e.invalidateQueries({queryKey:n.fQ.detail(a.pipelineId)})}})}}},e=>{e.O(0,[9779,2619,6489,2259,3297,1738,6770,8972,5655,8441,1255,7358],()=>e(e.s=30592)),_N_E=e.O()}]);