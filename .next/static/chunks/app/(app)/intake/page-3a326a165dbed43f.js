(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[44],{11647:(e,t,s)=>{"use strict";s.d(t,{E:()=>i});var a=s(95155),r=s(64269);let l={default:"bg-slate-100 text-slate-700",primary:"bg-astralis-blue/10 text-astralis-blue",secondary:"bg-slate-200 text-slate-800",success:"bg-green-100 text-green-700",warning:"bg-orange-100 text-orange-700",error:"bg-red-100 text-red-700"};function i(e){let{children:t,className:s,variant:i="default"}=e;return(0,a.jsx)("span",{className:(0,r.cn)("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",l[i],s),children:t})}},18332:(e,t,s)=>{"use strict";s.d(t,{Fc:()=>m,TN:()=>h,XL:()=>p});var a=s(95155),r=s(12115),l=s(83101),i=s(23327),n=s(61362),d=s(78874),o=s(6132),c=s(64269);let u=(0,l.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-white border-slate-300 text-slate-900",success:"border-green-500/50 bg-green-50 text-green-900 [&>svg]:text-green-600",error:"border-red-500/50 bg-red-50 text-red-900 [&>svg]:text-red-600",warning:"border-yellow-500/50 bg-yellow-50 text-yellow-900 [&>svg]:text-yellow-600",info:"border-blue-500/50 bg-blue-50 text-blue-900 [&>svg]:text-astralis-blue"}},defaultVariants:{variant:"default"}}),x={default:i.A,success:n.A,error:d.A,warning:o.A,info:i.A},m=r.forwardRef((e,t)=>{let{className:s,variant:r="default",showIcon:l=!1,children:i,...n}=e,d=x[r||"default"];return(0,a.jsxs)("div",{ref:t,role:"alert",className:(0,c.cn)(u({variant:r}),s),...n,children:[l&&(0,a.jsx)(d,{className:"h-4 w-4"}),i]})});m.displayName="Alert";let p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("h5",{ref:t,className:(0,c.cn)("mb-1 font-semibold leading-none tracking-tight",s),...r})});p.displayName="AlertTitle";let h=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,c.cn)("text-sm [&_p]:leading-relaxed",s),...r})});h.displayName="AlertDescription"},49625:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>V});var a=s(95155),r=s(12115),l=s(22454),i=s(36489),n=s(37507),d=s(64662),o=s(86948),c=s(11647);let u={NEW:"bg-blue-100 text-blue-700",ROUTING:"bg-yellow-100 text-yellow-700",ASSIGNED:"bg-purple-100 text-purple-700",PROCESSING:"bg-orange-100 text-orange-700",COMPLETED:"bg-green-100 text-green-700",REJECTED:"bg-red-100 text-red-700"},x={FORM:"bg-slate-100 text-slate-700",EMAIL:"bg-blue-100 text-blue-700",CHAT:"bg-purple-100 text-purple-700",API:"bg-green-100 text-green-700"};function m(e){let{requests:t}=e;return(0,a.jsx)(o.Zp,{variant:"default",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Title"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Source"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Priority"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Created"})]})}),(0,a.jsxs)("tbody",{className:"bg-white divide-y divide-slate-200",children:[t.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-slate-50 cursor-pointer",children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm font-medium text-astralis-navy",children:e.title})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)(c.E,{className:x[e.source],children:e.source})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)(c.E,{className:u[e.status],children:e.status})}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-500",children:["P",e.priority]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-500",children:(0,d.GP)(new Date(e.createdAt),"MMM d, yyyy")})]},e.id)),0===t.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:5,className:"px-6 py-12 text-center text-slate-500",children:"No intake requests found"})})]})]})})})}var p=s(22544),h=s(33602),f=s(54879),g=s(51834),j=s(3998),y=s(65142),N=s(76444),b=s(31120),w=s(14744),v=s(24033),R=s(12108),S=s(5917),E=s(64269);let A=w.bL;w.YJ;let k=w.WT,P=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(w.l9,{ref:t,className:(0,E.cn)("flex h-10 w-full items-center justify-between rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-500","transition-all duration-150 ease-out","focus:outline-none focus:ring-2 focus:ring-astralis-blue focus:ring-offset-0","disabled:cursor-not-allowed disabled:opacity-50","[&>span]:line-clamp-1",s),...l,children:[r,(0,a.jsx)(w.In,{asChild:!0,children:(0,a.jsx)(v.A,{className:"h-4 w-4 opacity-50"})})]})});P.displayName=w.l9.displayName;let I=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(w.PP,{ref:t,className:(0,E.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(R.A,{className:"h-4 w-4"})})});I.displayName=w.PP.displayName;let C=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(w.wn,{ref:t,className:(0,E.cn)("flex cursor-default items-center justify-center py-1",s),...r,children:(0,a.jsx)(v.A,{className:"h-4 w-4"})})});C.displayName=w.wn.displayName;let O=r.forwardRef((e,t)=>{let{className:s,children:r,position:l="popper",...i}=e;return(0,a.jsx)(w.ZL,{children:(0,a.jsxs)(w.UC,{ref:t,className:(0,E.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-slate-300 bg-white text-slate-900 shadow-[0_4px_12px_rgba(0,0,0,0.1)]","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:l,...i,children:[(0,a.jsx)(I,{}),(0,a.jsx)(w.LM,{className:(0,E.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,a.jsx)(C,{})]})})});O.displayName=w.UC.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(w.JU,{ref:t,className:(0,E.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold text-slate-900",s),...r})}).displayName=w.JU.displayName;let q=r.forwardRef((e,t)=>{let{className:s,children:r,...l}=e;return(0,a.jsxs)(w.q7,{ref:t,className:(0,E.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none","transition-colors duration-150 ease-out","focus:bg-astralis-blue/10 focus:text-astralis-blue","data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(w.VF,{children:(0,a.jsx)(S.A,{className:"h-4 w-4 text-astralis-blue"})})}),(0,a.jsx)(w.p4,{children:r})]})});q.displayName=w.q7.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(w.wv,{ref:t,className:(0,E.cn)("-mx-1 my-1 h-px bg-slate-300",s),...r})}).displayName=w.wv.displayName;var F=s(18332),T=s(99776),_=s(80549),M=s(99349);let D=f.Ik({title:f.Yj().min(2,"Title must be at least 2 characters"),description:f.Yj().optional(),source:f.k5(["FORM","EMAIL","CHAT","API"]),priority:f.au.number().int().min(0).max(10)});function L(e){let{open:t,onOpenChange:s,onSuccess:l}=e,{data:d}=(0,i.useSession)(),o=function(){let e=(0,T.jE)();return(0,_.n)({mutationFn:async e=>{let t=await fetch("/api/intake",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw{...await t.json().catch(()=>({})),status:t.status};return t.json()},onSuccess:(t,s)=>{e.invalidateQueries({queryKey:n.Ni.list(s.orgId)}),e.invalidateQueries({queryKey:n.Ni.stats(s.orgId)})},onError:e=>{let t=(0,M._R)(e);(0,M.vV)(t,"useCreateIntake")}})}(),[c,u]=(0,r.useState)(null),[x,m]=(0,r.useState)("FORM"),{register:f,handleSubmit:w,formState:{errors:v},reset:R,setValue:S}=(0,p.mN)({resolver:(0,h.u)(D),defaultValues:{source:"FORM",priority:0}}),E=async e=>{var t;if(!(null==d||null==(t=d.user)?void 0:t.orgId))return void u("Organization ID not found. Please sign in again.");u(null);try{await o.mutateAsync({title:e.title,description:e.description,source:e.source,priority:e.priority,requestData:{createdBy:d.user.email,createdAt:new Date().toISOString()},orgId:d.user.orgId}),R(),m("FORM"),s(!1),null==l||l()}catch(e){u(e instanceof Error?e.message:"Failed to create intake request")}},I=()=>{o.isPending||(R(),m("FORM"),u(null),s(!1))};return(0,a.jsx)(g.lG,{open:t,onOpenChange:I,children:(0,a.jsxs)(g.Cf,{className:"sm:max-w-[500px]",children:[(0,a.jsx)(g.c7,{children:(0,a.jsx)(g.L3,{children:"Create New Intake Request"})}),(0,a.jsxs)("form",{onSubmit:w(E),className:"space-y-4",children:[c&&(0,a.jsx)(F.Fc,{variant:"error",children:(0,a.jsx)(F.TN,{children:c})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(N.J,{htmlFor:"title",children:["Request Title ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(y.p,{id:"title",placeholder:"e.g., New Customer Support Request",...f("title"),disabled:o.isPending}),v.title&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:v.title.message})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"description",children:"Description (optional)"}),(0,a.jsx)(b.T,{id:"description",placeholder:"Provide additional details about the request...",rows:4,...f("description"),disabled:o.isPending}),v.description&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:v.description.message})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(N.J,{htmlFor:"source",children:["Source ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)(A,{value:x,onValueChange:e=>{m(e),S("source",e)},disabled:o.isPending,children:[(0,a.jsx)(P,{children:(0,a.jsx)(k,{placeholder:"Select source"})}),(0,a.jsxs)(O,{children:[(0,a.jsx)(q,{value:"FORM",children:"Form Submission"}),(0,a.jsx)(q,{value:"EMAIL",children:"Email"}),(0,a.jsx)(q,{value:"CHAT",children:"Chat"}),(0,a.jsx)(q,{value:"API",children:"API"})]})]}),v.source&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:v.source.message})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(N.J,{htmlFor:"priority",children:"Priority (0-10)"}),(0,a.jsx)(y.p,{id:"priority",type:"number",min:"0",max:"10",defaultValue:"0",...f("priority",{valueAsNumber:!0}),disabled:o.isPending}),v.priority&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:v.priority.message})]}),(0,a.jsxs)(g.Es,{children:[(0,a.jsx)(j.$,{type:"button",variant:"outline",onClick:I,disabled:o.isPending,children:"Cancel"}),(0,a.jsx)(j.$,{type:"submit",variant:"primary",disabled:o.isPending,children:o.isPending?"Creating...":"Create Request"})]})]})]})})}var J=s(63581),U=s(6191);function V(){let[e,t]=(0,r.useState)(!1),[s,d]=(0,r.useState)({}),{data:o,isLoading:c,error:u,refetch:x}=function(e){var t;let{data:s}=(0,i.useSession)(),a=null==s||null==(t=s.user)?void 0:t.orgId,r=new URLSearchParams({orgId:a||"",...(null==e?void 0:e.status)&&{status:e.status},...(null==e?void 0:e.source)&&{source:e.source},...(null==e?void 0:e.limit)&&{limit:e.limit.toString()},...(null==e?void 0:e.offset)&&{offset:e.offset.toString()}});return(0,l.I)({queryKey:a?n.Ni.list(a,e):["intake"],queryFn:async()=>{if(!a)throw Error("No organization ID");let e=await fetch("/api/intake?".concat(r));if(!e.ok)throw Error("Failed to fetch intake requests");let t=await e.json();return{requests:t.intakeRequests,total:t.pagination.total}},enabled:!!a,staleTime:1e4})}(s);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-astralis-navy",children:"Intake Queue"}),(0,a.jsx)("p",{className:"text-slate-600 mt-1",children:"Review and route incoming requests"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(j.$,{variant:"outline",className:"gap-2",children:[(0,a.jsx)(J.A,{className:"w-4 h-4"}),"Filters"]}),(0,a.jsxs)(j.$,{variant:"primary",className:"gap-2",onClick:()=>t(!0),children:[(0,a.jsx)(U.A,{className:"w-4 h-4"}),"New Request"]})]})]}),c?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-astralis-blue"})}):u?(0,a.jsx)("div",{className:"text-center py-12 text-red-600",children:"Failed to load intake requests"}):(0,a.jsx)(m,{requests:(null==o?void 0:o.requests)||[]})]}),(0,a.jsx)(L,{open:e,onOpenChange:t,onSuccess:()=>{x()}})]})}},63477:(e,t,s)=>{Promise.resolve().then(s.bind(s,49625))},99349:(e,t,s)=>{"use strict";function a(e){return e instanceof TypeError?{message:"Network error. Please check your connection.",code:"NETWORK_ERROR"}:e instanceof Response?{message:"Request failed with status ".concat(e.status),status:e.status,code:"HTTP_ERROR"}:e&&"object"==typeof e&&"message"in e?{message:String(e.message),status:"status"in e?Number(e.status):void 0,code:"code"in e?String(e.code):void 0,details:"details"in e?e.details:void 0}:e instanceof Error?{message:e.message,code:"UNKNOWN_ERROR"}:{message:"An unexpected error occurred",code:"UNKNOWN_ERROR"}}function r(e,t){new Date().toISOString(),e.message,e.status,e.code,e.details}s.d(t,{_R:()=>a,vV:()=>r})}},e=>{e.O(0,[9779,9633,6489,2392,2259,3297,1738,1634,6093,3499,5655,8441,1255,7358],()=>e(e.s=63477)),_N_E=e.O()}]);