(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4610],{3998:(e,t,s)=>{"use strict";s.d(t,{$:()=>d});var a=s(95155),l=s(12115),r=s(32467),i=s(83101),n=s(64269);let c=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-semibold transition-all duration-150 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-astralis-blue focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{primary:"bg-astralis-blue text-white shadow-md hover:bg-[#245a92] hover:shadow-lg hover:scale-105 dark:bg-astralis-blue dark:hover:bg-[#245a92]",secondary:"border-2 border-astralis-blue text-astralis-blue hover:bg-astralis-blue hover:text-white shadow-sm hover:shadow-md dark:border-astralis-blue dark:text-astralis-blue dark:hover:bg-astralis-blue dark:hover:text-white",destructive:"bg-error text-white shadow-sm hover:bg-error/90 hover:shadow-md dark:bg-error dark:hover:bg-error/90",outline:"border-2 border-slate-300 bg-white text-slate-700 hover:bg-slate-100 hover:border-slate-400 dark:border-slate-600 dark:bg-slate-800 dark:text-slate-200 dark:hover:bg-slate-700 dark:hover:border-slate-500",ghost:"text-slate-700 hover:bg-slate-100 dark:text-slate-200 dark:hover:bg-slate-800",link:"text-astralis-blue underline-offset-4 hover:underline dark:text-astralis-blue"},size:{default:"h-12 px-6 py-3 text-base",sm:"h-11 px-4 py-2 text-sm",lg:"h-14 px-8 py-4 text-lg",icon:"h-12 w-12"}},defaultVariants:{variant:"primary",size:"lg"}}),d=l.forwardRef((e,t)=>{let{className:s,variant:l,size:i,asChild:d=!1,...o}=e,m=d?r.DX:"button";return(0,a.jsx)(m,{className:(0,n.cn)(c({variant:l,size:i,className:s})),ref:t,...o})});d.displayName="Button"},6132:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},11647:(e,t,s)=>{"use strict";s.d(t,{E:()=>i});var a=s(95155),l=s(64269);let r={default:"bg-slate-100 text-slate-700",primary:"bg-astralis-blue/10 text-astralis-blue",secondary:"bg-slate-200 text-slate-800",success:"bg-green-100 text-green-700",warning:"bg-orange-100 text-orange-700",error:"bg-red-100 text-red-700"};function i(e){let{children:t,className:s,variant:i="default"}=e;return(0,a.jsx)("span",{className:(0,l.cn)("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",r[i],s),children:t})}},11793:(e,t,s)=>{Promise.resolve().then(s.bind(s,72751))},18332:(e,t,s)=>{"use strict";s.d(t,{Fc:()=>h,TN:()=>p,XL:()=>u});var a=s(95155),l=s(12115),r=s(83101),i=s(23327),n=s(61362),c=s(78874),d=s(6132),o=s(64269);let m=(0,r.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-white border-slate-300 text-slate-900",success:"border-green-500/50 bg-green-50 text-green-900 [&>svg]:text-green-600",error:"border-red-500/50 bg-red-50 text-red-900 [&>svg]:text-red-600",warning:"border-yellow-500/50 bg-yellow-50 text-yellow-900 [&>svg]:text-yellow-600",info:"border-blue-500/50 bg-blue-50 text-blue-900 [&>svg]:text-astralis-blue"}},defaultVariants:{variant:"default"}}),x={default:i.A,success:n.A,error:c.A,warning:d.A,info:i.A},h=l.forwardRef((e,t)=>{let{className:s,variant:l="default",showIcon:r=!1,children:i,...n}=e,c=x[l||"default"];return(0,a.jsxs)("div",{ref:t,role:"alert",className:(0,o.cn)(m({variant:l}),s),...n,children:[r&&(0,a.jsx)(c,{className:"h-4 w-4"}),i]})});h.displayName="Alert";let u=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("h5",{ref:t,className:(0,o.cn)("mb-1 font-semibold leading-none tracking-tight",s),...l})});u.displayName="AlertTitle";let p=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("text-sm [&_p]:leading-relaxed",s),...l})});p.displayName="AlertDescription"},23327:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},27063:(e,t,s)=>{"use strict";s.d(t,{CG:()=>o,Fm:()=>p,Qs:()=>g,cj:()=>d,h:()=>u,qp:()=>f});var a=s(95155),l=s(12115),r=s(93409),i=s(83101),n=s(65229),c=s(64269);let d=r.bL,o=r.l9;r.bm;let m=r.ZL,x=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.hJ,{className:(0,c.cn)("fixed inset-0 z-50 bg-black/50 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...l,ref:t})});x.displayName=r.hJ.displayName;let h=(0,i.F)("fixed z-50 gap-4 bg-white p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-300",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),u=l.forwardRef((e,t)=>{let{side:s="right",className:l,children:i,...d}=e;return(0,a.jsxs)(m,{children:[(0,a.jsx)(x,{}),(0,a.jsxs)(r.UC,{ref:t,className:(0,c.cn)(h({side:s}),l),...d,children:[i,(0,a.jsxs)(r.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-white transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-astralis-blue focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-slate-100",children:[(0,a.jsx)(n.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});u.displayName=r.UC.displayName;let p=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...s})};p.displayName="SheetHeader";let f=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.hE,{ref:t,className:(0,c.cn)("text-lg font-semibold text-astralis-navy",s),...l})});f.displayName=r.hE.displayName;let g=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)(r.VY,{ref:t,className:(0,c.cn)("text-sm text-slate-600",s),...l})});g.displayName=r.VY.displayName},31120:(e,t,s)=>{"use strict";s.d(t,{T:()=>i});var a=s(95155),l=s(12115),r=s(64269);let i=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-500","dark:bg-slate-800 dark:border-slate-700 dark:text-white dark:placeholder:text-slate-400","transition-all duration-150 ease-out","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-astralis-blue focus-visible:ring-offset-0","disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...l})});i.displayName="Textarea"},37586:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},42529:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},61362:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},64269:(e,t,s)=>{"use strict";s.d(t,{cn:()=>r});var a=s(2821),l=s(75889);function r(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,l.QP)((0,a.$)(t))}},65142:(e,t,s)=>{"use strict";s.d(t,{p:()=>i});var a=s(95155),l=s(12115),r=s(64269);let i=l.forwardRef((e,t)=>{let{className:s,type:l,...i}=e;return(0,a.jsx)("input",{type:l,className:(0,r.cn)("flex h-10 w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-500","dark:bg-slate-800 dark:border-slate-700 dark:text-white dark:placeholder:text-slate-400","transition-all duration-150 ease-out","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-astralis-blue focus-visible:ring-offset-0","disabled:cursor-not-allowed disabled:opacity-50","file:border-0 file:bg-transparent file:text-sm file:font-medium",s),ref:t,...i})});i.displayName="Input"},72751:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>ee});var a=s(95155),l=s(12115),r=s(37586),i=s(71847);let n=(0,i.A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var c=s(86651),d=s(63581),o=s(36489),m=s(22454),x=s(99776),h=s(80549);let u={all:["documents"],lists:()=>[...u.all,"list"],list:(e,t)=>[...u.lists(),e,{filters:t}],details:()=>[...u.all,"detail"],detail:e=>[...u.details(),e],stats:e=>[...u.all,e,"stats"]};var p=s(89715);let f=(0,i.A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var g=s(42529),j=s(6132),v=s(65229),y=s(3998),N=s(86948),b=s(18332),w=s(64269);let k=["image/jpeg","image/jpg","image/png","image/webp","application/pdf"];function C(e){let{maxSize:t=0xa00000,acceptedTypes:s=k,maxFiles:r=5,onComplete:i,className:c}=e,[d,m]=(0,l.useState)(!1),[C,E]=(0,l.useState)([]),[A,D]=(0,l.useState)(null),{mutateAsync:S}=function(){var e;let t=(0,x.jE)(),{data:s}=(0,o.useSession)(),a=null==s||null==(e=s.user)?void 0:e.orgId;return(0,h.n)({mutationFn:async e=>{let{file:t,onProgress:s}=e;if(!a)throw Error("No organization ID");let l=new FormData;return l.append("file",t),l.append("orgId",a),new Promise((e,t)=>{let a=new XMLHttpRequest;a.upload.addEventListener("progress",e=>{e.lengthComputable&&s&&s(Math.round(e.loaded/e.total*100))}),a.addEventListener("load",()=>{if(a.status>=200&&a.status<300)try{let t=JSON.parse(a.responseText);e(t)}catch(e){t(Error("Invalid response format"))}else try{let e=JSON.parse(a.responseText);t(Error(e.error||"Upload failed"))}catch(e){t(Error("Upload failed"))}}),a.addEventListener("error",()=>{t(Error("Network error during upload"))}),a.open("POST","/api/documents/upload"),a.send(l)})},onSuccess:()=>{a&&(t.invalidateQueries({queryKey:u.lists()}),t.invalidateQueries({queryKey:u.stats(a)}))}})}(),F=(0,l.useCallback)(e=>s.includes(e.type)?e.size>t?"File size exceeds ".concat(Math.round(t/1024/1024),"MB limit."):null:"File type ".concat(e.type," not supported. Please upload images or PDFs."),[s,t]),P=(0,l.useCallback)(async e=>{if(D(null),e.length>r)return void D("Maximum ".concat(r," files allowed at once."));for(let t of e){let e=F(t);if(e)return void D(e)}E(e.map(e=>({file:e,progress:0,status:"pending"})));for(let t=0;t<e.length;t++){let s=e[t];try{E(e=>e.map((e,s)=>s===t?{...e,status:"uploading"}:e));let e=await S({file:s,onProgress:e=>{E(s=>s.map((s,a)=>a===t?{...s,progress:e}:s))}});E(s=>s.map((s,a)=>a===t?{...s,status:"processing",progress:100,document:e.document}:s)),setTimeout(()=>{E(e=>e.map((e,s)=>s===t?{...e,status:"completed"}:e))},1e3)}catch(e){E(s=>s.map((s,a)=>a===t?{...s,status:"error",error:e instanceof Error?e.message:"Upload failed"}:s))}}i&&setTimeout(()=>{i()},2e3)},[r,F,S,i]),M=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),m(!0)},[]),I=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),m(!1)},[]),T=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation()},[]),z=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),m(!1);let t=Array.from(e.dataTransfer.files);t.length>0&&P(t)},[P]),O=(0,l.useCallback)(e=>{let t=Array.from(e.target.files||[]);t.length>0&&P(t),e.target.value=""},[P]),R=(0,l.useCallback)(e=>{E(t=>t.filter((t,s)=>s!==e))},[]),L=(0,l.useCallback)(()=>{E([]),D(null)},[]);return(0,a.jsxs)("div",{className:(0,w.cn)("space-y-4",c),children:[(0,a.jsx)(N.Zp,{className:(0,w.cn)("relative transition-all duration-200",d&&"border-astralis-blue border-2 bg-blue-50"),children:(0,a.jsx)(N.Wu,{className:"p-8",children:(0,a.jsxs)("div",{onDragEnter:M,onDragOver:T,onDragLeave:I,onDrop:z,className:"flex flex-col items-center justify-center space-y-4",children:[(0,a.jsx)("div",{className:(0,w.cn)("flex h-20 w-20 items-center justify-center rounded-full transition-colors",d?"bg-astralis-blue":"bg-slate-100"),children:(0,a.jsx)(n,{className:(0,w.cn)("h-10 w-10 transition-colors",d?"text-white":"text-slate-600")})}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-lg font-semibold text-astralis-navy",children:d?"Drop files here":"Drag & drop files here"}),(0,a.jsxs)("p",{className:"text-sm text-slate-500 mt-1",children:["or click to browse (max ",r," files, ",Math.round(t/1024/1024),"MB each)"]})]}),(0,a.jsx)("input",{type:"file",id:"file-upload",className:"hidden",multiple:!0,accept:s.join(","),onChange:O}),(0,a.jsx)("label",{htmlFor:"file-upload",children:(0,a.jsx)(y.$,{variant:"primary",size:"lg",asChild:!0,children:(0,a.jsx)("span",{children:"Select Files"})})}),(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"Supported: JPG, PNG, WebP, PDF"})]})})}),A&&(0,a.jsx)(b.Fc,{variant:"error",showIcon:!0,children:(0,a.jsx)(b.TN,{children:A})}),C.length>0&&(0,a.jsx)(N.Zp,{children:(0,a.jsxs)(N.Wu,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-astralis-navy",children:["Uploading ",C.length," ",1===C.length?"file":"files"]}),(0,a.jsx)(y.$,{variant:"ghost",size:"sm",onClick:L,children:"Clear All"})]}),(0,a.jsx)("div",{className:"space-y-3",children:C.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(p.A,{className:"h-8 w-8 text-astralis-blue"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-astralis-navy truncate",children:e.file.name}),(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:[(e.file.size/1024/1024).toFixed(2)," MB"]}),("uploading"===e.status||"processing"===e.status)&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("div",{className:"h-1.5 bg-slate-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-astralis-blue transition-all duration-300",style:{width:"".concat(e.progress,"%")}})}),(0,a.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"uploading"===e.status?"Uploading... ".concat(e.progress,"%"):"Processing..."})]}),"error"===e.status&&e.error&&(0,a.jsx)("p",{className:"text-xs text-error mt-1",children:e.error})]}),(0,a.jsxs)("div",{className:"flex-shrink-0",children:["uploading"===e.status&&(0,a.jsx)(f,{className:"h-5 w-5 text-astralis-blue animate-spin"}),"processing"===e.status&&(0,a.jsx)(f,{className:"h-5 w-5 text-orange-500 animate-spin"}),"completed"===e.status&&(0,a.jsx)(g.A,{className:"h-5 w-5 text-success"}),"error"===e.status&&(0,a.jsx)(j.A,{className:"h-5 w-5 text-error"})]}),("completed"===e.status||"error"===e.status)&&(0,a.jsx)("button",{onClick:()=>R(t),className:"flex-shrink-0 p-1 hover:bg-slate-200 rounded transition-colors","aria-label":"Remove file",children:(0,a.jsx)(v.A,{className:"h-4 w-4 text-slate-500"})})]},"".concat(e.file.name,"-").concat(t)))})]})})]})}var E=s(64662);let A=(0,i.A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),D=(0,i.A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);var S=s(89559),F=s(71360),P=s(11647);let M={PENDING:{variant:"default",label:"Pending",icon:f,iconClassName:"animate-spin"},PROCESSING:{variant:"warning",label:"Processing",icon:f,iconClassName:"animate-spin"},COMPLETED:{variant:"success",label:"Completed",icon:g.A,iconClassName:""},FAILED:{variant:"error",label:"Failed",icon:j.A,iconClassName:""}};function I(e){var t,s;let{document:l,onView:i,onChat:n,showActions:c=!0,className:d}=e,{mutate:m,isPending:f}=function(){var e;let t=(0,x.jE)(),{data:s}=(0,o.useSession)(),a=null==s||null==(e=s.user)?void 0:e.orgId;return(0,h.n)({mutationFn:async e=>{let t=await fetch("/api/documents/".concat(e,"?orgId=").concat(a),{method:"DELETE"});if(!t.ok)throw Error("Failed to delete document");return t.json()},onSuccess:(e,s)=>{t.removeQueries({queryKey:u.detail(s)}),a&&(t.invalidateQueries({queryKey:u.lists()}),t.invalidateQueries({queryKey:u.stats(a)}))}})}(),{mutate:g,isPending:v}=function(){var e;let t=(0,x.jE)(),{data:s}=(0,o.useSession)(),a=null==s||null==(e=s.user)?void 0:e.orgId;return(0,h.n)({mutationFn:async e=>{let t=await fetch("/api/documents/".concat(e,"/retry"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orgId:a})});if(!t.ok)throw Error("Failed to retry document processing");return t.json()},onSuccess:(e,s)=>{t.invalidateQueries({queryKey:u.detail(s)}),a&&t.invalidateQueries({queryKey:u.lists()})}})}(),b=M[l.status],k=b.icon;return(0,a.jsxs)(N.Zp,{className:(0,w.cn)("overflow-hidden hover",d),hover:!0,children:[(0,a.jsx)(N.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:l.thumbnailUrl?(0,a.jsx)("img",{src:l.thumbnailUrl,alt:l.originalName,className:"h-20 w-20 rounded-lg object-cover border border-slate-200"}):(0,a.jsx)("div",{className:(0,w.cn)("h-20 w-20 rounded-lg bg-slate-100 flex items-center justify-center",(t=l.mimeType).startsWith("image/")?"text-purple-500":"application/pdf"===t?"text-red-500":"text-slate-500"),children:(0,a.jsx)(p.A,{className:"h-10 w-10"})})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-astralis-navy truncate",title:l.originalName,children:l.originalName}),(0,a.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:[(s=l.fileSize)<1024?"".concat(s," B"):s<1048576?"".concat((s/1024).toFixed(1)," KB"):"".concat((s/1024/1024).toFixed(2)," MB")," •"," ",(0,E.GP)(new Date(l.createdAt),"MMM d, yyyy")]})]}),(0,a.jsxs)(P.E,{variant:b.variant,className:"flex items-center gap-1",children:[(0,a.jsx)(k,{className:(0,w.cn)("h-3 w-3",b.iconClassName)}),b.label]})]}),"COMPLETED"===l.status&&null!==l.ocrConfidence&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:["OCR Confidence: ",Math.round(100*l.ocrConfidence),"%"]}),(0,a.jsx)("div",{className:"h-1 bg-slate-200 rounded-full overflow-hidden mt-1",children:(0,a.jsx)("div",{className:(0,w.cn)("h-full transition-all",l.ocrConfidence>=.8?"bg-success":l.ocrConfidence>=.6?"bg-warning":"bg-error"),style:{width:"".concat(100*l.ocrConfidence,"%")}})})]}),"FAILED"===l.status&&l.processingError&&(0,a.jsxs)("div",{className:"mt-2 flex items-start gap-2",children:[(0,a.jsx)(j.A,{className:"h-4 w-4 text-error flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-error",children:"Processing Error:"}),(0,a.jsx)("p",{className:"text-xs text-error",children:l.processingError})]})]}),l.metadata&&"object"==typeof l.metadata&&"embeddingError"in l.metadata&&(0,a.jsxs)("div",{className:"mt-2 flex items-start gap-2",children:[(0,a.jsx)(j.A,{className:"h-4 w-4 text-warning flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-warning",children:"Embedding Error:"}),(0,a.jsx)("p",{className:"text-xs text-warning",children:String(l.metadata.embeddingError)})]})]}),l.extractedData&&Object.keys(l.extractedData).length>0&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-slate-600",children:"Extracted Data:"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1 mt-1",children:[Object.keys(l.extractedData).slice(0,3).map(e=>(0,a.jsx)(P.E,{variant:"secondary",className:"text-xs",children:e},e)),Object.keys(l.extractedData).length>3&&(0,a.jsxs)(P.E,{variant:"secondary",className:"text-xs",children:["+",Object.keys(l.extractedData).length-3," more"]})]})]})]})]})}),c&&(0,a.jsx)(N.wL,{className:"p-4 pt-0",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 w-full",children:[(0,a.jsxs)(y.$,{variant:"outline",size:"sm",onClick:()=>null==i?void 0:i(l),className:"flex-1",disabled:!l.cdnUrl,children:[(0,a.jsx)(A,{className:"h-4 w-4 mr-1"}),"View"]}),"COMPLETED"===l.status&&n&&(0,a.jsx)(y.$,{variant:"outline",size:"sm",onClick:()=>n(l.id),title:"Chat with this document",children:(0,a.jsx)(r.A,{className:"h-5 w-5"})}),(0,a.jsx)(y.$,{variant:"outline",size:"sm",onClick:()=>{l.cdnUrl&&window.open(l.cdnUrl,"_blank")},disabled:!l.cdnUrl,children:(0,a.jsx)(D,{className:"h-5 w-5"})}),("PENDING"===l.status||"FAILED"===l.status||"COMPLETED"===l.status&&(null===l.ocrConfidence||0===l.ocrConfidence))&&(0,a.jsx)(y.$,{variant:"outline",size:"sm",onClick:()=>{g(l.id)},disabled:v,title:"PENDING"===l.status?"Start processing":"FAILED"===l.status?"Retry processing":"Re-process document",children:(0,a.jsx)(S.A,{className:(0,w.cn)("h-5 w-5",v&&"animate-spin")})}),(0,a.jsx)(y.$,{variant:"destructive",size:"sm",onClick:()=>{confirm('Are you sure you want to delete "'.concat(l.originalName,'"? This action cannot be undone.'))&&m(l.id)},disabled:f,children:(0,a.jsx)(F.A,{className:"h-5 w-5"})})]})})]})}let T=(0,i.A)("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),z=(0,i.A)("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),O=(0,i.A)("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]),R=(0,i.A)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var L=s(27063);let q=e=>e<1024?"".concat(e," B"):e<1048576?"".concat((e/1024).toFixed(1)," KB"):"".concat((e/1024/1024).toFixed(2)," MB");function $(e){let{document:t,isOpen:s,onClose:r}=e,[i,n]=(0,l.useState)(100),[c,d]=(0,l.useState)(0),[o,m]=(0,l.useState)(!1),[x,h]=(0,l.useState)(null),[u,f]=(0,l.useState)(!1);if((0,l.useEffect)(()=>{(null==t?void 0:t.id)&&s?(f(!0),fetch("/api/documents/".concat(t.id,"/url")).then(e=>e.json()).then(e=>{h(e.url),f(!1)}).catch(e=>{console.error("Failed to fetch signed URL:",e),f(!1)})):h(null)},[null==t?void 0:t.id,s]),!t)return null;let g=t.mimeType.startsWith("image/"),j="application/pdf"===t.mimeType,v=async()=>{try{let e=await fetch("/api/documents/".concat(t.id,"/url")),s=await e.json(),a=window.document.createElement("a");a.href=s.url,a.download=t.originalName,a.click()}catch(e){console.error("Failed to download document:",e)}};return(0,a.jsx)(L.cj,{open:s,onOpenChange:r,children:(0,a.jsxs)(L.h,{side:"right",className:"w-full sm:max-w-2xl lg:max-w-4xl overflow-y-auto",children:[(0,a.jsx)(L.Fm,{children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex-1 min-w-0 pr-8",children:[(0,a.jsx)(L.qp,{className:"truncate",children:t.originalName}),(0,a.jsxs)(L.Qs,{className:"flex items-center gap-2 mt-1",children:[(0,a.jsx)("span",{children:q(t.fileSize)}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:(0,E.GP)(new Date(t.createdAt),"PPP")})]})]})})}),(0,a.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y.$,{variant:"outline",size:"sm",onClick:()=>n(e=>Math.max(e-25,50)),children:(0,a.jsx)(T,{className:"h-4 w-4"})}),(0,a.jsxs)("span",{className:"text-sm text-slate-600 min-w-[60px] text-center",children:[i,"%"]}),(0,a.jsx)(y.$,{variant:"outline",size:"sm",onClick:()=>n(e=>Math.min(e+25,200)),children:(0,a.jsx)(z,{className:"h-4 w-4"})}),g&&(0,a.jsx)(y.$,{variant:"outline",size:"sm",onClick:()=>d(e=>(e+90)%360),children:(0,a.jsx)(O,{className:"h-4 w-4"})}),(0,a.jsx)(y.$,{variant:"ghost",size:"sm",onClick:()=>{n(100),d(0)},children:"Reset"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[t.ocrText&&g&&(0,a.jsx)(y.$,{variant:o?"primary":"outline",size:"sm",onClick:()=>m(e=>!e),children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(R,{className:"h-4 w-4 mr-1"}),"Hide OCR"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(A,{className:"h-4 w-4 mr-1"}),"Show OCR"]})}),(0,a.jsxs)(y.$,{variant:"outline",size:"sm",onClick:v,children:[(0,a.jsx)(D,{className:"h-4 w-4 mr-1"}),"Download"]})]})]}),(0,a.jsx)("div",{className:"relative bg-slate-100 rounded-lg overflow-hidden min-h-[500px] flex items-center justify-center p-4",children:x?(0,a.jsxs)(a.Fragment,{children:[g&&(0,a.jsx)("img",{src:x,alt:t.originalName,className:"max-w-full h-auto transition-transform",style:{transform:"scale(".concat(i/100,") rotate(").concat(c,"deg)")}}),j&&(0,a.jsx)("iframe",{src:x,className:"w-full h-[600px] border-0",title:t.originalName}),!g&&!j&&(0,a.jsxs)("div",{className:"text-center text-slate-500",children:[(0,a.jsx)(p.A,{className:"h-16 w-16 mx-auto mb-4"}),(0,a.jsx)("p",{children:"Preview not available for this file type"}),(0,a.jsx)(y.$,{variant:"primary",size:"lg",className:"mt-4",onClick:v,children:"Download to View"})]})]}):(0,a.jsxs)("div",{className:"text-center text-slate-500",children:[(0,a.jsx)(p.A,{className:"h-16 w-16 mx-auto mb-4"}),(0,a.jsx)("p",{children:"Document not available"})]})}),o&&t.ocrText&&(0,a.jsxs)("div",{className:"p-4 bg-white border border-slate-200 rounded-lg",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-astralis-navy mb-2 flex items-center gap-2",children:[(0,a.jsx)(p.A,{className:"h-4 w-4"}),"Extracted Text (OCR)",t.ocrConfidence&&(0,a.jsxs)(P.E,{variant:"secondary",className:"ml-auto",children:[Math.round(100*t.ocrConfidence),"% confidence"]})]}),(0,a.jsx)("div",{className:"text-sm text-slate-600 whitespace-pre-wrap max-h-60 overflow-y-auto",children:t.ocrText})]}),t.extractedData&&Object.keys(t.extractedData).length>0&&(0,a.jsxs)("div",{className:"p-4 bg-white border border-slate-200 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-astralis-navy mb-3",children:"Extracted Structured Data"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(t.extractedData).map(e=>{let[t,s]=e;return(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:t.replace(/([A-Z])/g," $1").trim()}),(0,a.jsx)("p",{className:"text-sm text-astralis-navy font-medium",children:"object"==typeof s?JSON.stringify(s):String(s)})]},t)})})]}),(0,a.jsxs)("div",{className:"p-4 bg-slate-50 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-astralis-navy mb-3",children:"Document Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-500",children:"File Name"}),(0,a.jsx)("p",{className:"text-astralis-navy font-medium break-all",children:t.fileName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-500",children:"File Size"}),(0,a.jsx)("p",{className:"text-astralis-navy font-medium",children:q(t.fileSize)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-500",children:"MIME Type"}),(0,a.jsx)("p",{className:"text-astralis-navy font-medium",children:t.mimeType})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-500",children:"Status"}),(0,a.jsx)(P.E,{variant:"COMPLETED"===t.status?"success":"FAILED"===t.status?"error":"warning",children:t.status})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-500",children:"Uploaded"}),(0,a.jsx)("p",{className:"text-astralis-navy font-medium",children:(0,E.GP)(new Date(t.createdAt),"PPpp")})]}),t.processedAt&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-500",children:"Processed"}),(0,a.jsx)("p",{className:"text-astralis-navy font-medium",children:(0,E.GP)(new Date(t.processedAt),"PPpp")})]})]}),t.processingError&&(0,a.jsxs)("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-error mb-1",children:"Processing Error"}),(0,a.jsx)("p",{className:"text-sm text-red-700",children:t.processingError})]})]})]})]})})}let U=(0,i.A)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var Z=s(31120);class G extends Error{constructor(e,t,s){super(e),this.status=t,this.details=s,this.name="ChatAPIError"}}async function B(e){let t=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)}),s=await t.json();if(!t.ok)throw new G(s.message||"Failed to send message",t.status,s.details);return s.data}async function W(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2?arguments[2]:void 0,a=new URLSearchParams({limit:e.toString(),offset:t.toString()});s&&a.set("documentId",s);let l=await fetch("/api/chat?".concat(a),{method:"GET",credentials:"include"}),r=await l.json();if(!l.ok)throw new G(r.message||"Failed to list chats",l.status,r.details);return r.data}async function _(e){let t=await fetch("/api/chat/".concat(e),{method:"GET",credentials:"include"}),s=await t.json();if(!t.ok)throw new G(s.message||"Failed to get chat",t.status,s.details);return s.data}async function H(e){let t=await fetch("/api/chat/".concat(e),{method:"DELETE",credentials:"include"}),s=await t.json();if(!t.ok)throw new G(s.message||"Failed to delete chat",t.status,s.details)}function K(e){let{documentId:t,orgId:s,userId:r,chatId:i,className:n}=e,[c,d]=(0,l.useState)([]),[o,m]=(0,l.useState)(""),[x,h]=(0,l.useState)(i),[u,g]=(0,l.useState)(null),j=(0,l.useRef)(null),v=(0,l.useRef)(null),{sendMessage:k,fetchChat:C,loading:E,error:A}=function(){let[e,t]=l.useState(!1),[s,a]=l.useState(null);return{sendMessage:async e=>{t(!0),a(null);try{return await B(e)}catch(t){let e=t instanceof G?t:new G("Unknown error",500);throw a(e),e}finally{t(!1)}},fetchChats:async(e,s,l)=>{t(!0),a(null);try{return await W(e,s,l)}catch(t){let e=t instanceof G?t:new G("Unknown error",500);throw a(e),e}finally{t(!1)}},fetchChat:async e=>{t(!0),a(null);try{return await _(e)}catch(t){let e=t instanceof G?t:new G("Unknown error",500);throw a(e),e}finally{t(!1)}},removeChat:async e=>{t(!0),a(null);try{await H(e)}catch(t){let e=t instanceof G?t:new G("Unknown error",500);throw a(e),e}finally{t(!1)}},loading:e,error:s}}();(0,l.useEffect)(()=>{i&&(async()=>{try{let e=await C(i);d(e.messages.map((e,t)=>({...e,id:"".concat(i,"-").concat(t)})))}catch(e){g(e instanceof G?e.message:"Failed to load chat history")}})()},[i,C]),(0,l.useEffect)(()=>{var e;null==(e=j.current)||e.scrollIntoView({behavior:"smooth"})},[c]);let D=async e=>{if(e.preventDefault(),!o.trim()||E)return;let s={id:"user-".concat(Date.now()),role:"user",content:o.trim(),timestamp:new Date().toISOString()};d(e=>[...e,s]),m(""),v.current&&(v.current.style.height="auto");try{let e=await k({chatId:x,documentId:t,message:s.content});!x&&e.chatId&&h(e.chatId);let a={id:"assistant-".concat(Date.now()),role:"assistant",content:e.message,timestamp:new Date().toISOString(),sources:e.sources};d(e=>[...e,a])}catch(e){console.error("Failed to send message:",e)}};return(0,a.jsxs)("div",{className:(0,w.cn)("flex flex-col h-full bg-white rounded-lg border border-slate-300",n),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-300 bg-slate-50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(p.A,{className:"h-5 w-5 text-astralis-blue"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-astralis-navy",children:t?"Document Chat":"All Documents Chat"})]}),x&&(0,a.jsx)(P.E,{variant:"primary",className:"text-xs",children:"Active Chat"})]}),u&&(0,a.jsx)("div",{className:"px-6 pt-4",children:(0,a.jsx)(b.Fc,{variant:"error",showIcon:!0,children:(0,a.jsx)(b.TN,{children:u})})}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto px-6 py-4 space-y-4",children:[0===c.length&&!E&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center py-12",children:[(0,a.jsx)(p.A,{className:"h-16 w-16 text-slate-300 mb-4"}),(0,a.jsx)("h4",{className:"text-lg font-semibold text-slate-700 mb-2",children:"Start a Conversation"}),(0,a.jsxs)("p",{className:"text-sm text-slate-500 max-w-md",children:["Ask questions about ",t?"this document":"your documents"," and get AI-powered answers with source citations."]})]}),c.map(e=>(0,a.jsx)("div",{className:(0,w.cn)("flex gap-3","user"===e.role?"justify-end":"justify-start"),children:(0,a.jsxs)("div",{className:(0,w.cn)("flex flex-col max-w-[80%] gap-2","user"===e.role?"items-end":"items-start"),children:[(0,a.jsx)(N.Zp,{variant:"default",className:(0,w.cn)("px-4 py-3","user"===e.role?"bg-astralis-blue text-white border-astralis-blue":"bg-white border-slate-300"),children:(0,a.jsx)("p",{className:(0,w.cn)("text-sm leading-relaxed whitespace-pre-wrap","user"===e.role?"text-white":"text-slate-900"),children:e.content})}),(0,a.jsx)("span",{className:"text-xs text-slate-500",children:new Date(e.timestamp).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}),"assistant"===e.role&&e.sources&&e.sources.length>0&&(0,a.jsxs)("div",{className:"w-full space-y-2",children:[(0,a.jsxs)("p",{className:"text-xs font-semibold text-slate-700",children:["Sources (",e.sources.length,"):"]}),(0,a.jsx)("div",{className:"space-y-2",children:e.sources.map((e,t)=>(0,a.jsxs)(N.Zp,{variant:"bordered",className:"p-3 bg-slate-50",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(p.A,{className:"h-3.5 w-3.5 text-astralis-blue flex-shrink-0"}),(0,a.jsx)("p",{className:"text-xs font-medium text-slate-900",children:e.documentName})]}),(0,a.jsxs)(P.E,{variant:"default",className:"text-xs",children:[Math.round(100*e.similarity),"% match"]})]}),(0,a.jsx)("p",{className:"text-xs text-slate-600 line-clamp-2",children:e.content})]},"".concat(e.documentId,"-").concat(e.chunkIndex)))})]})]})},e.id)),E&&(0,a.jsx)("div",{className:"flex justify-start",children:(0,a.jsx)(N.Zp,{variant:"default",className:"px-4 py-3 bg-slate-50 border-slate-300",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(f,{className:"h-4 w-4 text-astralis-blue animate-spin"}),(0,a.jsx)("p",{className:"text-sm text-slate-600",children:"Thinking..."})]})})}),A&&(0,a.jsx)(b.Fc,{variant:"error",showIcon:!0,children:(0,a.jsxs)(b.TN,{children:[(0,a.jsx)("strong",{children:"Error:"})," ",A.message,A.details&&(0,a.jsx)("p",{className:"mt-1 text-xs",children:JSON.stringify(A.details)})]})}),(0,a.jsx)("div",{ref:j})]}),(0,a.jsxs)("div",{className:"px-6 py-4 border-t border-slate-300 bg-slate-50",children:[(0,a.jsxs)("form",{onSubmit:D,className:"flex gap-2",children:[(0,a.jsx)(Z.T,{ref:v,value:o,onChange:e=>{m(e.target.value);let t=e.target;t.style.height="auto",t.style.height="".concat(Math.min(t.scrollHeight,200),"px")},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),D(e))},placeholder:"Ask a question about the document...",disabled:E,className:"resize-none min-h-[44px] max-h-[200px]",rows:1}),(0,a.jsx)(y.$,{type:"submit",variant:"primary",size:"icon",disabled:!o.trim()||E,className:"flex-shrink-0",children:E?(0,a.jsx)(f,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(U,{className:"h-4 w-4"})})]}),(0,a.jsx)("p",{className:"text-xs text-slate-500 mt-2",children:"Press Enter to send, Shift+Enter for new line"})]})]})}let V={default:"max-w-7xl",full:"max-w-full",narrow:"max-w-5xl"};function Q(e){let{children:t,className:s,maxWidth:l="default"}=e;return(0,a.jsx)("div",{className:(0,w.cn)("mx-auto w-full px-4 py-6 sm:px-6 lg:px-8",V[l],s),children:t})}function J(e){let{title:t,description:s,actions:l,className:r}=e;return(0,a.jsxs)("div",{className:(0,w.cn)("flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",r),children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold tracking-tight text-astralis-navy sm:text-3xl",children:t}),s&&(0,a.jsx)("p",{className:"text-sm text-slate-600 sm:text-base",children:s})]}),l&&(0,a.jsx)("div",{className:"flex items-center gap-2 shrink-0",children:l})]})}function X(e){let{icon:t,title:s,description:l,primaryAction:r,secondaryAction:i,className:n}=e;return(0,a.jsxs)("div",{className:(0,w.cn)("flex flex-col items-center justify-center text-center py-12 px-4",n),children:[t&&(0,a.jsx)("div",{className:"mb-4 inline-flex items-center justify-center w-16 h-16 rounded-full bg-slate-100",children:(0,a.jsx)(t,{className:"w-8 h-8 text-slate-400",strokeWidth:1.5})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-astralis-navy mb-2",children:s}),l&&(0,a.jsx)("p",{className:"text-sm text-slate-600 max-w-md mb-6",children:l}),(r||i)&&(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[r&&(0,a.jsx)(y.$,{variant:"primary",size:"default",onClick:r.onClick,asChild:!!r.href,children:r.href?(0,a.jsx)("a",{href:r.href,children:r.label}):r.label}),i&&(0,a.jsx)(y.$,{variant:"outline",size:"default",onClick:i.onClick,asChild:!!i.href,children:i.href?(0,a.jsx)("a",{href:i.href,children:i.label}):i.label})]})]})}var Y=s(65142);function ee(){let{data:e}=(0,o.useSession)(),[t,s]=(0,l.useState)(null),[i,x]=(0,l.useState)(!1),[h,p]=(0,l.useState)(!1),[f,g]=(0,l.useState)(!0),[j,v]=(0,l.useState)(),[b,w]=(0,l.useState)(""),[k,E]=(0,l.useState)(),[A,D]=(0,l.useState)(),[S,F]=(0,l.useState)(1),{data:M,isLoading:T,error:z}=function(e){var t;let{data:s}=(0,o.useSession)(),a=null==s||null==(t=s.user)?void 0:t.orgId,l=new URLSearchParams({orgId:a||"",...(null==e?void 0:e.status)&&{status:e.status},...(null==e?void 0:e.mimeType)&&{mimeType:e.mimeType},...(null==e?void 0:e.uploadedBy)&&{uploadedBy:e.uploadedBy},...(null==e?void 0:e.startDate)&&{startDate:e.startDate},...(null==e?void 0:e.endDate)&&{endDate:e.endDate},...(null==e?void 0:e.search)&&{search:e.search},...(null==e?void 0:e.limit)&&{limit:e.limit.toString()},...(null==e?void 0:e.offset)&&{offset:e.offset.toString()}});return(0,m.I)({queryKey:a?u.list(a,e):["documents"],queryFn:async()=>{if(!a)throw Error("No organization ID");let e=await fetch("/api/documents?".concat(l));if(!e.ok)throw Error("Failed to fetch documents");let t=await e.json();return{documents:t.documents,total:t.pagination.total,hasMore:t.pagination.hasMore}},enabled:!!a,staleTime:3e4,refetchInterval:e=>{let t=e.state.data;return!!((null==t?void 0:t.documents)&&t.documents.some(e=>"PENDING"===e.status||"PROCESSING"===e.status))&&5e3}})}({status:k,mimeType:A,search:b||void 0,limit:12,offset:(S-1)*12}),{data:O}=function(){var e;let{data:t}=(0,o.useSession)(),s=null==t||null==(e=t.user)?void 0:e.orgId;return(0,m.I)({queryKey:s?u.stats(s):["document-stats"],queryFn:async()=>{if(!s)throw Error("No organization ID");let e=await fetch("/api/documents/stats?orgId=".concat(s));if(!e.ok)throw Error("Failed to fetch document stats");return(await e.json()).stats},enabled:!!s,staleTime:6e4,refetchInterval:e=>{let t=e.state.data;return!!t&&(t.pending>0||t.processing>0)&&5e3}})}(),R=(null==M?void 0:M.documents)||[],q=(null==M?void 0:M.total)||0,U=(null==M?void 0:M.hasMore)||!1,Z=e=>{s(e)},G=e=>{v(e),g(!0)},B=()=>{E(void 0),D(void 0),w(""),F(1)},W=k||A||b;return(0,a.jsxs)(Q,{children:[(0,a.jsx)(J,{title:"Documents",description:"Manage and view all uploaded documents with OCR processing",actions:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(y.$,{variant:"outline",onClick:()=>{v(void 0),g(!0)},children:[(0,a.jsx)(r.A,{className:"h-4 w-4 mr-2"}),"Chat with Documents"]}),(0,a.jsxs)(y.$,{variant:"primary",onClick:()=>x(!0),children:[(0,a.jsx)(n,{className:"h-4 w-4 mr-2"}),"Upload Documents"]})]})}),O&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:[(0,a.jsx)(N.Zp,{children:(0,a.jsxs)(N.Wu,{className:"p-4",children:[(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Total Documents"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-astralis-navy",children:O.total})]})}),(0,a.jsx)(N.Zp,{children:(0,a.jsxs)(N.Wu,{className:"p-4",children:[(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Pending"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-slate-600",children:O.pending})]})}),(0,a.jsx)(N.Zp,{children:(0,a.jsxs)(N.Wu,{className:"p-4",children:[(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Processing"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-warning",children:O.processing})]})}),(0,a.jsx)(N.Zp,{children:(0,a.jsxs)(N.Wu,{className:"p-4",children:[(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Completed"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-success",children:O.completed})]})}),(0,a.jsx)(N.Zp,{children:(0,a.jsxs)(N.Wu,{className:"p-4",children:[(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Failed"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-error",children:O.failed})]})})]}),(0,a.jsx)(N.Zp,{className:"mb-6",children:(0,a.jsx)(N.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)(c.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,a.jsx)(Y.p,{type:"search",placeholder:"Search documents...",value:b,onChange:e=>w(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(y.$,{variant:"outline",onClick:()=>p(!0),className:"flex items-center gap-2",children:[(0,a.jsx)(d.A,{className:"h-4 w-4"}),"Filters",W&&(0,a.jsx)(P.E,{variant:"primary",className:"ml-1",children:[k,A,b].filter(Boolean).length})]}),W&&(0,a.jsx)(y.$,{variant:"ghost",onClick:B,children:"Clear"})]})})}),T&&(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-slate-500",children:"Loading documents..."})}),z&&(0,a.jsx)(N.Zp,{variant:"bordered",className:"p-6",children:(0,a.jsx)("p",{className:"text-error text-center",children:"Failed to load documents. Please try again."})}),!T&&!z&&0===R.length&&(0,a.jsx)(X,{icon:n,title:"No documents found",description:W?"Try adjusting your filters or search query":"Upload your first document to get started",primaryAction:W?void 0:{label:"Upload Documents",onClick:()=>x(!0)}}),!T&&!z&&R.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:R.map(e=>(0,a.jsx)(I,{document:e,onView:Z,onChat:G},e.id))}),q>12&&(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("p",{className:"text-sm text-slate-600",children:["Showing ",(S-1)*12+1," to"," ",Math.min(12*S,q)," of ",q," ","documents"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(y.$,{variant:"outline",onClick:()=>F(e=>Math.max(e-1,1)),disabled:1===S,children:"Previous"}),(0,a.jsx)(y.$,{variant:"outline",onClick:()=>F(e=>e+1),disabled:!U,children:"Next"})]})]})]}),(0,a.jsx)(L.cj,{open:i,onOpenChange:x,children:(0,a.jsxs)(L.h,{side:"right",className:"w-full sm:max-w-xl overflow-y-auto",children:[(0,a.jsx)(L.Fm,{children:(0,a.jsx)(L.qp,{children:"Upload Documents"})}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsx)(C,{onComplete:()=>{x(!1)}})})]})}),(0,a.jsx)(L.cj,{open:h,onOpenChange:p,children:(0,a.jsxs)(L.h,{side:"right",className:"w-full sm:max-w-md",children:[(0,a.jsx)(L.Fm,{children:(0,a.jsx)(L.qp,{children:"Filter Documents"})}),(0,a.jsxs)("div",{className:"mt-6 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-astralis-navy mb-2 block",children:"Status"}),(0,a.jsxs)("div",{className:"space-y-2",children:[["PENDING","PROCESSING","COMPLETED","FAILED"].map(e=>(0,a.jsxs)("label",{className:"flex items-center gap-2 p-2 hover:bg-slate-50 rounded cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"status",checked:k===e,onChange:()=>E(e),className:"text-astralis-blue focus:ring-astralis-blue"}),(0,a.jsx)("span",{className:"text-sm text-slate-700",children:e})]},e)),(0,a.jsxs)("label",{className:"flex items-center gap-2 p-2 hover:bg-slate-50 rounded cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"status",checked:!k,onChange:()=>E(void 0),className:"text-astralis-blue focus:ring-astralis-blue"}),(0,a.jsx)("span",{className:"text-sm text-slate-700",children:"All"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-astralis-navy mb-2 block",children:"File Type"}),(0,a.jsxs)("div",{className:"space-y-2",children:[[{label:"Images",value:"image/"},{label:"PDFs",value:"application/pdf"}].map(e=>(0,a.jsxs)("label",{className:"flex items-center gap-2 p-2 hover:bg-slate-50 rounded cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"mimeType",checked:A===e.value,onChange:()=>D(e.value),className:"text-astralis-blue focus:ring-astralis-blue"}),(0,a.jsx)("span",{className:"text-sm text-slate-700",children:e.label})]},e.value)),(0,a.jsxs)("label",{className:"flex items-center gap-2 p-2 hover:bg-slate-50 rounded cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"mimeType",checked:!A,onChange:()=>D(void 0),className:"text-astralis-blue focus:ring-astralis-blue"}),(0,a.jsx)("span",{className:"text-sm text-slate-700",children:"All"})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(y.$,{variant:"primary",className:"flex-1",onClick:()=>p(!1),children:"Apply Filters"}),(0,a.jsx)(y.$,{variant:"outline",onClick:B,children:"Clear"})]})]})]})}),(0,a.jsx)($,{document:t,isOpen:!!t,onClose:()=>{s(null)}}),(null==e?void 0:e.user)&&(0,a.jsx)(L.cj,{open:f,onOpenChange:g,children:(0,a.jsxs)(L.h,{side:"right",className:"w-full sm:max-w-2xl overflow-hidden flex flex-col",children:[(0,a.jsx)(L.Fm,{children:(0,a.jsx)(L.qp,{children:j?"Chat with Document":"Chat with Documents"})}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden mt-6",children:(0,a.jsx)(K,{documentId:j,orgId:e.user.orgId,userId:e.user.id,className:"h-full"})})]})})]})}},78874:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},86651:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},86948:(e,t,s)=>{"use strict";s.d(t,{Wu:()=>d,ZB:()=>c,Zp:()=>i,aR:()=>n,wL:()=>o});var a=s(95155),l=s(12115),r=s(64269);let i=l.forwardRef((e,t)=>{let{className:s,variant:l="default",hover:i=!1,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg bg-white transition-shadow duration-200 dark:bg-slate-800 dark:border-slate-700",{default:"border border-slate-300 shadow-[0_2px_8px_rgba(0,0,0,0.06)]",bordered:"border-2 border-slate-300",elevated:"shadow-lg"}[l],i&&"hover:shadow-[0_4px_16px_rgba(0,0,0,0.1)]",s),...n})});i.displayName="Card";let n=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",s),...l})});n.displayName="CardHeader";let c=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("h3",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight text-slate-900 dark:text-white",s),...l})});c.displayName="CardTitle",l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("p",{ref:t,className:(0,r.cn)("text-sm text-slate-500 dark:text-slate-400",s),...l})}).displayName="CardDescription";let d=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",s),...l})});d.displayName="CardContent";let o=l.forwardRef((e,t)=>{let{className:s,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",s),...l})});o.displayName="CardFooter"},89559:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},89715:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])}},e=>{e.O(0,[9779,6489,2259,3297,1738,1634,6770,8441,1255,7358],()=>e(e.s=11793)),_N_E=e.O()}]);