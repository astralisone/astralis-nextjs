{"version":3,"file":"src/middleware.js","mappings":"qFAAA,wDCAA,iMCGA,MAAeA,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CACrB,SAASC,CAAc,EACrB,GAAM,UAAEC,CAAQ,CAAE,CAAGC,EAAIC,OAAO,CAC1BC,EAAQF,EAAIG,QAAQ,CAACD,KAAK,QAGhC,EACWE,UAAU,CAAC,UACpBL,EAASK,UAAU,CAAC,YACpBL,gBACA,GACOM,EAAAA,YAAYA,CAACC,IAAI,GAIP,CAAC,eAAgB,eAAe,CACpBC,IAAI,CAACC,GAAST,EAASK,UAAU,CAACI,KAG9CN,EACVG,EAAAA,GADiB,SACLA,CAACI,QAAQ,CAAC,IAAIC,IAAI,aAAcV,EAAIW,GAAG,GAGrDN,EAAAA,YAAYA,CAACC,IAAI,EAC1B,EACA,CACEM,UAAW,CACTC,WAAY,CAAC,OAAEX,CAAK,KAAEF,CAAG,CAAE,IACzB,GAAM,UAAED,CAAQ,CAAE,CAAGC,EAAIC,OAAO,OAGhC,GACEF,EAASK,UAAU,CAAC,UACpBL,EAASK,UAAU,CAAC,aACP,gBACb,CADAL,IAMsB,CACtB,aACA,aACA,UACA,aACA,cACA,eACA,YACD,CAEwCQ,IAAI,CAACC,GAAST,EAASK,UAAU,CAACI,KAIlE,CAAC,CAACN,CAKb,CACF,EACAY,MAAO,CACLC,OAAQ,cACV,CACF,GAGWC,CAFX,CAEoB,CAEpBC,QAAS,CACP,QACD,EACD,QCrEF,OACA,GAAO,CAAI,EAEX,0BACA,oBACA,wBACA,qDAA6D,EAAK,gFAClE,aACA,cACA,eACA,CAAK,EAkCU,cACf,MAAW,OAAO,EAClB,KACA,OACA,QAjCA,cACA,IACA,oBACA,CAAU,SASV,WACA,iBACA,qBAWA,OAVA,MAAkB,QAAiC,IACnD,OACA,gBACA,+CACA,CAAa,EACb,0BACA,wBACA,uBACA,uBACA,CAAa,EACb,CACA,CACA,CAOA,CAAK,CACL","sources":["webpack://_N_E/external commonjs \"node:buffer\"","webpack://_N_E/external commonjs \"node:async_hooks\"","webpack://_N_E/./src/middleware.ts","webpack://_N_E/"],"sourcesContent":["module.exports = require(\"node:buffer\");","module.exports = require(\"node:async_hooks\");","import { withAuth } from \"next-auth/middleware\";\nimport { NextResponse } from \"next/server\";\n\nexport default withAuth(\n  function middleware(req) {\n    const { pathname } = req.nextUrl;\n    const token = req.nextauth.token;\n\n    // Skip middleware for API routes, Next.js internal routes, and static files\n    if (\n      pathname.startsWith('/api/') ||\n      pathname.startsWith('/_next/') ||\n      pathname === '/favicon.ico'\n    ) {\n      return NextResponse.next();\n    }\n\n    // Routes that should redirect to dashboard if authenticated\n    const authRoutes = ['/auth/signin', '/auth/signup'];\n    const isAuthRoute = authRoutes.some(route => pathname.startsWith(route));\n\n    // Redirect to dashboard if accessing auth routes while authenticated\n    if (isAuthRoute && token) {\n      return NextResponse.redirect(new URL('/dashboard', req.url));\n    }\n\n    return NextResponse.next();\n  },\n  {\n    callbacks: {\n      authorized: ({ token, req }) => {\n        const { pathname } = req.nextUrl;\n\n        // Always allow API routes, Next.js internals, and static files\n        if (\n          pathname.startsWith('/api/') ||\n          pathname.startsWith('/_next/') ||\n          pathname === '/favicon.ico'\n        ) {\n          return true;\n        }\n\n        // Routes that require authentication (using (app) route group paths)\n        const protectedRoutes = [\n          '/dashboard',\n          '/pipelines',\n          '/intake',\n          '/documents',\n          '/scheduling',\n          '/automations',\n          '/settings',\n        ];\n\n        const isProtectedRoute = protectedRoutes.some(route => pathname.startsWith(route));\n\n        // Allow access to protected routes only if token exists\n        if (isProtectedRoute) {\n          return !!token;\n        }\n\n        // Allow access to all other routes\n        return true;\n      },\n    },\n    pages: {\n      signIn: '/auth/signin',\n    },\n  }\n);\n\nexport const config = {\n  // Match all routes - exclusions are handled in middleware function above\n  matcher: [\n    '/(.*)',\n  ],\n};\n","import \"next/dist/server/web/globals\";\nimport { adapter } from \"next/dist/server/web/adapter\";\n// Import the userland code.\nimport * as _mod from \"private-next-root-dir/src/middleware.ts\";\nimport { edgeInstrumentationOnRequestError } from \"next/dist/server/web/globals\";\nimport { isNextRouterError } from \"next/dist/client/components/is-next-router-error\";\nconst mod = {\n    ..._mod\n};\nconst handler = mod.middleware || mod.default;\nconst page = \"/src/middleware\";\nif (typeof handler !== 'function') {\n    throw Object.defineProperty(new Error(`The Middleware \"${page}\" must export a \\`middleware\\` or a \\`default\\` function`), \"__NEXT_ERROR_CODE\", {\n        value: \"E120\",\n        enumerable: false,\n        configurable: true\n    });\n}\n// Middleware will only sent out the FetchEvent to next server,\n// so load instrumentation module here and track the error inside middleware module.\nfunction errorHandledHandler(fn) {\n    return async (...args)=>{\n        try {\n            return await fn(...args);\n        } catch (err) {\n            // In development, error the navigation API usage in runtime,\n            // since it's not allowed to be used in middleware as it's outside of react component tree.\n            if (process.env.NODE_ENV !== 'production') {\n                if (isNextRouterError(err)) {\n                    err.message = `Next.js navigation API is not allowed to be used in Middleware.`;\n                    throw err;\n                }\n            }\n            const req = args[0];\n            const url = new URL(req.url);\n            const resource = url.pathname + url.search;\n            await edgeInstrumentationOnRequestError(err, {\n                path: resource,\n                method: req.method,\n                headers: Object.fromEntries(req.headers.entries())\n            }, {\n                routerKind: 'Pages Router',\n                routePath: '/middleware',\n                routeType: 'middleware',\n                revalidateReason: undefined\n            });\n            throw err;\n        }\n    };\n}\nexport default function nHandler(opts) {\n    return adapter({\n        ...opts,\n        page,\n        handler: errorHandledHandler(handler)\n    });\n}\n\n//# sourceMappingURL=middleware.js.map\n"],"names":["withAuth","middleware","pathname","req","nextUrl","token","nextauth","startsWith","NextResponse","next","some","route","redirect","URL","url","callbacks","authorized","pages","signIn","config","matcher"],"sourceRoot":"","ignoreList":[]}