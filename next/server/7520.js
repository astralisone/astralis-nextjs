exports.id=7520,exports.ids=[7520],exports.modules={6829:(a,b,c)=>{"use strict";c.d(b,{Sd:()=>e,X5:()=>f});var d=c(75625);let e=d.Ik({email:d.Yj().email("Invalid email address"),password:d.Yj().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Password must contain uppercase letter").regex(/[a-z]/,"Password must contain lowercase letter").regex(/[0-9]/,"Password must contain number"),name:d.Yj().min(2,"Name must be at least 2 characters").max(100),orgName:d.Yj().min(2,"Organization name required").max(100)}),f=d.Ik({email:d.Yj().email("Invalid email address"),password:d.Yj().min(1,"Password is required")});d.Ik({email:d.Yj().email("Invalid email address")}),d.Ik({token:d.Yj().min(1,"Token is required"),password:d.Yj().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Password must contain uppercase letter").regex(/[a-z]/,"Password must contain lowercase letter").regex(/[0-9]/,"Password must contain number")})},20229:(a,b,c)=>{"use strict";c.d(b,{N:()=>k,j:()=>l});var d=c(89966),e=c(26413),f=c(4696),g=c(13028),h=c(99750),i=c(65585),j=c(6829);let k={adapter:(0,g.y)(h.z),providers:[(0,e.A)({id:"credentials",name:"Email & Password",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(a){let b=j.X5.safeParse(a);if(!b.success)return null;let{email:c,password:d}=b.data,e=await h.z.users.findUnique({where:{email:c},include:{organization:!0}});return e&&e.password&&await (0,i.BE)(d,e.password)?{id:e.id,email:e.email,name:e.name,role:e.role,orgId:e.orgId||"",image:e.avatar}:null}}),(0,f.A)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET,authorization:{params:{prompt:"consent",access_type:"offline",response_type:"code"}}})],session:{strategy:"jwt",maxAge:2592e3},callbacks:{async jwt({token:a,user:b,account:c,trigger:d,session:e}){if(b&&(a.id=b.id,a.role=b.role,a.orgId=b.orgId,a.picture=b.image),"update"===d&&e&&(void 0!==e.image&&(a.picture=e.image),void 0!==e.name&&(a.name=e.name)),c?.provider==="google"&&b){let c=await h.z.users.findUnique({where:{id:b.id},include:{organization:!0}});c&&(a.orgId=c.orgId||"",a.role=c.role,a.picture=c.avatar)}return a},session:async({session:a,token:b})=>(b&&a.user&&(a.user.id=b.id,a.user.role=b.role,a.user.orgId=b.orgId,a.user.image=b.picture),a),async signIn({user:a,account:b,profile:c}){if(b?.provider==="email")return!0;if(b?.provider==="google"){let b=await h.z.users.findUnique({where:{email:a.email},include:{organization:!0}});if(!b?.organization){let c=await h.z.organization.create({data:{name:`${a.name}'s Organization`,users:{connect:{id:b.id}}}});await h.z.users.update({where:{id:b.id},data:{orgId:c.id,role:"ADMIN"}})}}return!0}},pages:{signIn:"/auth/signin",signOut:"/auth/signout",error:"/auth/error",verifyRequest:"/auth/verify-email"},events:{async signIn({user:a}){}}},l=()=>(0,d.getServerSession)(k)},37421:(a,b,c)=>{"use strict";c.d(b,{Cx:()=>e,cx:()=>g,nM:()=>f,oV:()=>i,xN:()=>h});var d=c(75625);let e=d.Ik({name:d.Yj().min(1,"Name is required").max(100,"Name too long").optional(),avatar:d.Yj().url("Invalid avatar URL").optional().nullable(),bio:d.Yj().max(500,"Bio must be 500 characters or less").optional().nullable(),company:d.Yj().max(100,"Company name too long").optional().nullable(),teamSize:d.Yj().max(50,"Team size too long").optional().nullable(),budget:d.Yj().max(100,"Budget too long").optional().nullable(),timeline:d.Yj().max(100,"Timeline too long").optional().nullable(),businessGoals:d.Yj().max(1e3,"Business goals too long").optional().nullable(),interestArea:d.Yj().max(200,"Interest area too long").optional().nullable(),additionalInfo:d.Yj().max(2e3,"Additional info too long").optional().nullable()}),f=d.Ik({currentPassword:d.Yj().min(1,"Current password is required"),newPassword:d.Yj().min(8,"Password must be at least 8 characters").max(100,"Password too long").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,"Password must contain at least one uppercase letter, one lowercase letter, and one number"),confirmPassword:d.Yj().min(1,"Please confirm your new password")}).refine(a=>a.newPassword===a.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]}).refine(a=>a.currentPassword!==a.newPassword,{message:"New password must be different from current password",path:["newPassword"]});d.Ik({password:d.Yj().min(1,"Password is required to delete account"),confirmation:d.eu("DELETE",{errorMap:()=>({message:"Please type DELETE to confirm"})})});let g=d.Ik({emailNotifications:d.zM().default(!0),marketingEmails:d.zM().default(!1),securityAlerts:d.zM().default(!0),weeklyDigest:d.zM().default(!1),productUpdates:d.zM().default(!0),bookingReminders:d.zM().default(!0),taskNotifications:d.zM().default(!0)}),h=d.Ik({theme:d.k5(["light","dark","system"]).default("system"),language:d.Yj().max(10).default("en"),timezone:d.Yj().max(50).default("UTC"),dateFormat:d.k5(["MM/DD/YYYY","DD/MM/YYYY","YYYY-MM-DD"]).default("MM/DD/YYYY"),timeFormat:d.k5(["12h","24h"]).default("12h")}),i=d.Ik({notifications:g.optional(),preferences:h.optional()});d.Ik({id:d.Yj(),email:d.Yj().email(),emailVerified:d.p6().nullable(),name:d.Yj().nullable(),avatar:d.Yj().nullable(),bio:d.Yj().nullable(),role:d.Yj(),isActive:d.zM(),lastLoginAt:d.p6().nullable(),createdAt:d.p6(),updatedAt:d.p6(),company:d.Yj().nullable(),teamSize:d.Yj().nullable(),budget:d.Yj().nullable(),timeline:d.Yj().nullable(),businessGoals:d.Yj().nullable(),interestArea:d.Yj().nullable(),additionalInfo:d.Yj().nullable(),onboardingCompleted:d.zM(),orgId:d.Yj().nullable()})},56931:()=>{},65585:(a,b,c)=>{"use strict";c.d(b,{BE:()=>i,Er:()=>h,HU:()=>j,Yc:()=>m,w:()=>l});var d=c(84437),e=c(55511),f=c.n(e);let g="aes-256-gcm";async function h(a){if(!a||"string"!=typeof a)throw TypeError("hashPassword: password must be a non-empty string");return d.tW(a,12)}async function i(a,b){return d.UD(a,b)}function j(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}function k(){let a=process.env.N8N_ENCRYPTION_KEY||process.env.NEXTAUTH_SECRET;if(!a)throw Error("Encryption key not found in environment variables");return f().pbkdf2Sync(a,"astralis-salt",1e5,32,"sha256")}function l(a){try{let b=f().randomBytes(16),c=f().randomBytes(64),d=k(),e=f().createCipheriv(g,d,b),h=e.update(a,"utf8","hex");h+=e.final("hex");let i=e.getAuthTag();return c.toString("hex")+":"+b.toString("hex")+":"+i.toString("hex")+":"+h}catch(a){throw console.error("Encryption error:",a),Error("Failed to encrypt data")}}function m(a){try{let b=a.split(":");if(4!==b.length)throw Error("Invalid encrypted data format");Buffer.from(b[0],"hex");let c=Buffer.from(b[1],"hex"),d=Buffer.from(b[2],"hex"),e=b[3],h=k(),i=f().createDecipheriv(g,h,c);i.setAuthTag(d);let j=i.update(e,"hex","utf8");return j+=i.final("utf8")}catch(a){throw console.error("Decryption error:",a),Error("Failed to decrypt data")}}},71003:()=>{},93448:(a,b,c)=>{"use strict";c.d(b,{Q:()=>h});var d=c(99750),e=c(65585);function f(a,b){let c=Error(a);return c.code=b,c}class g{async getUserProfile(a){let b=await d.z.users.findUnique({where:{id:a},select:{id:!0,email:!0,emailVerified:!0,name:!0,avatar:!0,bio:!0,role:!0,isActive:!0,lastLoginAt:!0,createdAt:!0,updatedAt:!0,company:!0,teamSize:!0,budget:!0,timeline:!0,businessGoals:!0,interestArea:!0,additionalInfo:!0,onboardingCompleted:!0,orgId:!0}});if(!b)throw f("User not found","NOT_FOUND");return b}async updateUserProfile(a,b){if(!await d.z.users.findUnique({where:{id:a},select:{id:!0}}))throw f("User not found","NOT_FOUND");let c={};return void 0!==b.name&&(c.name=b.name),void 0!==b.avatar&&(c.avatar=b.avatar),void 0!==b.bio&&(c.bio=b.bio),void 0!==b.company&&(c.company=b.company),void 0!==b.teamSize&&(c.teamSize=b.teamSize),void 0!==b.budget&&(c.budget=b.budget),void 0!==b.timeline&&(c.timeline=b.timeline),void 0!==b.businessGoals&&(c.businessGoals=b.businessGoals),void 0!==b.interestArea&&(c.interestArea=b.interestArea),void 0!==b.additionalInfo&&(c.additionalInfo=b.additionalInfo),await d.z.users.update({where:{id:a},data:c,select:{id:!0,email:!0,emailVerified:!0,name:!0,avatar:!0,bio:!0,role:!0,isActive:!0,lastLoginAt:!0,createdAt:!0,updatedAt:!0,company:!0,teamSize:!0,budget:!0,timeline:!0,businessGoals:!0,interestArea:!0,additionalInfo:!0,onboardingCompleted:!0,orgId:!0}})}async changePassword(a,b,c){let g=await d.z.users.findUnique({where:{id:a},select:{id:!0,password:!0}});if(!g)throw f("User not found","NOT_FOUND");if(!await (0,e.BE)(b,g.password))throw f("Current password is incorrect","INVALID_PASSWORD");let h=await (0,e.Er)(c);return await d.z.users.update({where:{id:a},data:{password:h}}),{success:!0,message:"Password changed successfully"}}async deleteAccount(a,b){let c=await d.z.users.findUnique({where:{id:a},select:{id:!0,password:!0,email:!0}});if(!c)throw f("User not found","NOT_FOUND");if(!await (0,e.BE)(b,c.password))throw f("Password is incorrect","INVALID_PASSWORD");let g=`deleted_${Date.now()}_${c.id}@deleted.local`;return await d.z.users.update({where:{id:a},data:{isActive:!1,email:g,name:"Deleted User",avatar:null,bio:null,company:null,teamSize:null,budget:null,timeline:null,businessGoals:null,interestArea:null,additionalInfo:null}}),await d.z.session.deleteMany({where:{userId:a}}),{success:!0,message:"Account has been deactivated successfully"}}async completeOnboarding(a){if(!await d.z.users.findUnique({where:{id:a},select:{id:!0}}))throw f("User not found","NOT_FOUND");return await d.z.users.update({where:{id:a},data:{onboardingCompleted:!0}}),{success:!0}}async updateLastLogin(a){await d.z.users.update({where:{id:a},data:{lastLoginAt:new Date}})}async verifyEmail(a){if(!await d.z.users.findUnique({where:{id:a},select:{id:!0}}))throw f("User not found","NOT_FOUND");return await d.z.users.update({where:{id:a},data:{emailVerified:new Date}}),{success:!0}}}let h=new g},99750:(a,b,c)=>{"use strict";c.d(b,{z:()=>e});var d=c(96330);let e=globalThis.prisma??new d.PrismaClient({log:["error","warn"]})}};