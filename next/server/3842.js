"use strict";exports.id=3842,exports.ids=[3842],exports.modules={6829:(a,b,c)=>{c.d(b,{Sd:()=>e,X5:()=>f});var d=c(75625);let e=d.Ik({email:d.Yj().email("Invalid email address"),password:d.Yj().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Password must contain uppercase letter").regex(/[a-z]/,"Password must contain lowercase letter").regex(/[0-9]/,"Password must contain number"),name:d.Yj().min(2,"Name must be at least 2 characters").max(100),orgName:d.Yj().min(2,"Organization name required").max(100)}),f=d.Ik({email:d.Yj().email("Invalid email address"),password:d.Yj().min(1,"Password is required")});d.Ik({email:d.Yj().email("Invalid email address")}),d.Ik({token:d.Yj().min(1,"Token is required"),password:d.Yj().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Password must contain uppercase letter").regex(/[a-z]/,"Password must contain lowercase letter").regex(/[0-9]/,"Password must contain number")})},20229:(a,b,c)=>{c.d(b,{N:()=>k,j:()=>l});var d=c(89966),e=c(26413),f=c(4696),g=c(13028),h=c(99750),i=c(65585),j=c(6829);let k={adapter:(0,g.y)(h.z),providers:[(0,e.A)({id:"credentials",name:"Email & Password",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(a){let b=j.X5.safeParse(a);if(!b.success)return null;let{email:c,password:d}=b.data,e=await h.z.users.findUnique({where:{email:c},include:{organization:!0}});return e&&e.password&&await (0,i.BE)(d,e.password)?{id:e.id,email:e.email,name:e.name,role:e.role,orgId:e.orgId||"",image:e.avatar}:null}}),(0,f.A)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET,authorization:{params:{prompt:"consent",access_type:"offline",response_type:"code"}}})],session:{strategy:"jwt",maxAge:2592e3},callbacks:{async jwt({token:a,user:b,account:c,trigger:d,session:e}){if(b&&(a.id=b.id,a.role=b.role,a.orgId=b.orgId,a.picture=b.image),"update"===d&&e&&(void 0!==e.image&&(a.picture=e.image),void 0!==e.name&&(a.name=e.name)),c?.provider==="google"&&b){let c=await h.z.users.findUnique({where:{id:b.id},include:{organization:!0}});c&&(a.orgId=c.orgId||"",a.role=c.role,a.picture=c.avatar)}return a},session:async({session:a,token:b})=>(b&&a.user&&(a.user.id=b.id,a.user.role=b.role,a.user.orgId=b.orgId,a.user.image=b.picture),a),async signIn({user:a,account:b,profile:c}){if(b?.provider==="email")return!0;if(b?.provider==="google"){let b=await h.z.users.findUnique({where:{email:a.email},include:{organization:!0}});if(!b?.organization){let c=await h.z.organization.create({data:{name:`${a.name}'s Organization`,users:{connect:{id:b.id}}}});await h.z.users.update({where:{id:b.id},data:{orgId:c.id,role:"ADMIN"}})}}return!0}},pages:{signIn:"/auth/signin",signOut:"/auth/signout",error:"/auth/error",verifyRequest:"/auth/verify-email"},events:{async signIn({user:a}){}}},l=()=>(0,d.getServerSession)(k)},38182:(a,b,c)=>{c.d(b,{$w:()=>q,eU:()=>o,pS:()=>m,wv:()=>n});var d=c(75625),e=c(96330);let f=d.fc(e.AutomationTrigger,{errorMap:()=>({message:"Invalid automation trigger type"})}),g=d.fc(e.ExecutionStatus,{errorMap:()=>({message:"Invalid execution status"})}),h=d.fc(e.TriggerType,{errorMap:()=>({message:"Invalid trigger type"})}),i=d.fc(e.TemplateCategory,{errorMap:()=>({message:"Invalid template category"})}),j=d.fc(e.IntegrationProvider,{errorMap:()=>({message:"Invalid integration provider"})}),k=d.Ik({id:d.Yj().min(1,"Node ID is required"),name:d.Yj().min(1,"Node name is required").max(100,"Node name too long"),type:d.Yj().min(1,"Node type is required"),typeVersion:d.ai().int().positive("Node type version must be positive"),position:d.PV([d.ai(),d.ai()]).describe("Node position [x, y]"),parameters:d.g1(d.L5()).default({}),credentials:d.g1(d.Yj()).optional()}),l=d.Ik({nodes:d.YO(k).min(1,"Workflow must have at least one node").max(100,"Workflow cannot exceed 100 nodes"),connections:d.g1(d.L5()).default({}),settings:d.Ik({executionOrder:d.k5(["v0","v1"]).optional(),saveManualExecutions:d.zM().optional(),saveExecutionProgress:d.zM().optional(),saveDataErrorExecution:d.Yj().optional(),saveDataSuccessExecution:d.Yj().optional(),executionTimeout:d.ai().int().positive().max(3600).optional(),timezone:d.Yj().optional()}).optional()}),m=d.Ik({name:d.Yj().min(3,"Automation name must be at least 3 characters").max(100,"Automation name must not exceed 100 characters").trim(),description:d.Yj().max(500,"Description must not exceed 500 characters").trim().optional(),triggerType:f,triggerConfig:d.g1(d.L5()).refine(a=>Object.keys(a).length>0,{message:"Trigger configuration cannot be empty"}),workflowJson:l,tags:d.YO(d.Yj().trim().min(1,"Tag cannot be empty")).max(10,"Maximum 10 tags allowed").optional().default([])}),n=d.Ik({name:d.Yj().min(3,"Automation name must be at least 3 characters").max(100,"Automation name must not exceed 100 characters").trim().optional(),description:d.Yj().max(500,"Description must not exceed 500 characters").trim().nullable().optional(),isActive:d.zM().optional(),tags:d.YO(d.Yj().trim().min(1,"Tag cannot be empty")).max(10,"Maximum 10 tags allowed").optional(),metadata:d.g1(d.L5()).nullable().optional()}).refine(a=>Object.keys(a).length>0,{message:"At least one field must be provided for update"}),o=d.Ik({triggerData:d.g1(d.L5()).refine(a=>Object.keys(a).length>0,{message:"Trigger data cannot be empty"})}),p=/^(\*|([0-9]|[1-5][0-9])|\*\/([0-9]|[1-5][0-9])) (\*|([0-9]|1[0-9]|2[0-3])|\*\/([0-9]|1[0-9]|2[0-3])) (\*|([1-9]|[12][0-9]|3[01])|\*\/([1-9]|[12][0-9]|3[01])) (\*|([1-9]|1[0-2])|\*\/([1-9]|1[0-2])) (\*|([0-6])|\*\/([0-6]))$/;d.Ik({automationId:d.Yj().cuid("Invalid automation ID format"),triggerType:h,triggerEvent:d.Yj().min(3,"Trigger event must be at least 3 characters").max(100,"Trigger event must not exceed 100 characters").trim(),webhookUrl:d.Yj().url("Invalid webhook URL format").optional(),cronSchedule:d.Yj().regex(p,'Invalid cron schedule format (e.g., "0 9 * * *" for daily at 9 AM)').optional(),eventFilters:d.g1(d.L5()).optional()}).refine(a=>("WEBHOOK"!==a.triggerType||!!a.webhookUrl)&&("SCHEDULE"!==a.triggerType||!!a.cronSchedule),{message:"Webhook triggers require webhookUrl, schedule triggers require cronSchedule"}),d.Ik({triggerEvent:d.Yj().min(3,"Trigger event must be at least 3 characters").max(100,"Trigger event must not exceed 100 characters").trim().optional(),webhookUrl:d.Yj().url("Invalid webhook URL format").nullable().optional(),cronSchedule:d.Yj().regex(p,"Invalid cron schedule format").nullable().optional(),eventFilters:d.g1(d.L5()).nullable().optional(),isActive:d.zM().optional()}).refine(a=>Object.keys(a).length>0,{message:"At least one field must be provided for update"}),d.Ik({accessToken:d.Yj().min(1,"Access token is required"),refreshToken:d.Yj().optional(),expiresAt:d.Yj().datetime().optional(),scope:d.Yj().optional(),tokenType:d.Yj().optional()}),d.Ik({apiKey:d.Yj().min(1,"API key is required"),apiSecret:d.Yj().optional(),apiUrl:d.Yj().url("Invalid API URL").optional()});let q=d.Ik({provider:j,credentialName:d.Yj().min(3,"Credential name must be at least 3 characters").max(100,"Credential name must not exceed 100 characters").trim(),credentialData:d.g1(d.L5()).refine(a=>Object.keys(a).length>0,{message:"Credential data cannot be empty"}),scope:d.Yj().optional(),expiresAt:d.Yj().datetime("Invalid datetime format").optional().transform(a=>a?new Date(a):void 0)});d.Ik({credentialName:d.Yj().min(3,"Credential name must be at least 3 characters").max(100,"Credential name must not exceed 100 characters").trim().optional(),credentialData:d.g1(d.L5()).refine(a=>Object.keys(a).length>0,{message:"Credential data cannot be empty"}).optional(),scope:d.Yj().nullable().optional(),expiresAt:d.Yj().datetime("Invalid datetime format").nullable().optional().transform(a=>a?new Date(a):null),isActive:d.zM().optional()}).refine(a=>Object.keys(a).length>0,{message:"At least one field must be provided for update"}),d.Ik({templateId:d.Yj().cuid("Invalid template ID format"),name:d.Yj().min(3,"Automation name must be at least 3 characters").max(100,"Automation name must not exceed 100 characters").trim().optional(),customConfig:d.g1(d.L5()).optional()}),d.Ik({name:d.Yj().min(3,"Template name must be at least 3 characters").max(100,"Template name must not exceed 100 characters").trim(),description:d.Yj().min(10,"Description must be at least 10 characters").max(2e3,"Description must not exceed 2000 characters").trim(),category:i,difficulty:d.k5(["beginner","intermediate","advanced"],{errorMap:()=>({message:"Invalid difficulty level"})}),n8nWorkflowJson:d.Yj().min(1,"Workflow JSON is required").refine(a=>{try{let b=JSON.parse(a);return b.nodes&&Array.isArray(b.nodes)&&b.nodes.length>0}catch{return!1}},"Invalid n8n workflow JSON format"),thumbnailUrl:d.Yj().url("Invalid thumbnail URL").nullable().optional(),demoVideoUrl:d.Yj().url("Invalid demo video URL").nullable().optional(),requiredIntegrations:d.YO(d.Yj()).max(20,"Maximum 20 required integrations allowed").default([]),tags:d.YO(d.Yj().trim().min(1,"Tag cannot be empty")).max(20,"Maximum 20 tags allowed").default([]),isOfficial:d.zM().default(!1)}),d.Ik({isActive:d.zM().optional(),triggerType:f.optional(),tags:d.YO(d.Yj()).optional(),search:d.Yj().trim().optional(),page:d.au.number().int().positive().default(1),pageSize:d.au.number().int().positive().max(100).default(20)}),d.Ik({automationId:d.Yj().cuid().optional(),status:g.optional(),startDate:d.Yj().datetime().optional().transform(a=>a?new Date(a):void 0),endDate:d.Yj().datetime().optional().transform(a=>a?new Date(a):void 0),page:d.au.number().int().positive().default(1),pageSize:d.au.number().int().positive().max(100).default(20)}),d.Ik({category:i.optional(),difficulty:d.k5(["beginner","intermediate","advanced"]).optional(),isOfficial:d.zM().optional(),search:d.Yj().trim().optional(),page:d.au.number().int().positive().default(1),pageSize:d.au.number().int().positive().max(100).default(20)}),d.Ik({event:d.Yj().min(1,"Event name is required"),timestamp:d.Yj().datetime("Invalid timestamp format"),data:d.g1(d.L5()),metadata:d.g1(d.L5()).optional()}),d.Ik({eventType:h,eventName:d.Yj().min(1,"Event name is required"),entityType:d.Yj().min(1,"Entity type is required"),entityId:d.Yj().cuid("Invalid entity ID format"),data:d.g1(d.L5()),orgId:d.Yj().cuid("Invalid organization ID format"),userId:d.Yj().cuid("Invalid user ID format").optional(),timestamp:d.p6().default(()=>new Date)})},65585:(a,b,c)=>{c.d(b,{BE:()=>i,Er:()=>h,HU:()=>j,Yc:()=>m,w:()=>l});var d=c(84437),e=c(55511),f=c.n(e);let g="aes-256-gcm";async function h(a){if(!a||"string"!=typeof a)throw TypeError("hashPassword: password must be a non-empty string");return d.tW(a,12)}async function i(a,b){return d.UD(a,b)}function j(){return Math.random().toString(36).substring(2)+Date.now().toString(36)}function k(){let a=process.env.N8N_ENCRYPTION_KEY||process.env.NEXTAUTH_SECRET;if(!a)throw Error("Encryption key not found in environment variables");return f().pbkdf2Sync(a,"astralis-salt",1e5,32,"sha256")}function l(a){try{let b=f().randomBytes(16),c=f().randomBytes(64),d=k(),e=f().createCipheriv(g,d,b),h=e.update(a,"utf8","hex");h+=e.final("hex");let i=e.getAuthTag();return c.toString("hex")+":"+b.toString("hex")+":"+i.toString("hex")+":"+h}catch(a){throw console.error("Encryption error:",a),Error("Failed to encrypt data")}}function m(a){try{let b=a.split(":");if(4!==b.length)throw Error("Invalid encrypted data format");Buffer.from(b[0],"hex");let c=Buffer.from(b[1],"hex"),d=Buffer.from(b[2],"hex"),e=b[3],h=k(),i=f().createDecipheriv(g,h,c);i.setAuthTag(d);let j=i.update(e,"hex","utf8");return j+=i.final("utf8")}catch(a){throw console.error("Decryption error:",a),Error("Failed to decrypt data")}}}};