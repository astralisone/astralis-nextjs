"use strict";(()=>{var a={};a.id=3560,a.ids=[3560],a.modules={261:a=>{a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:a=>{a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11723:a=>{a.exports=require("querystring")},12412:a=>{a.exports=require("assert")},16936:(a,b,c)=>{c.d(b,{L:()=>g});var d=c(21124);c(38301);var e=c(44943);let f={default:"max-w-7xl",full:"max-w-full",narrow:"max-w-5xl"};function g({children:a,className:b,maxWidth:c="default"}){return(0,d.jsx)("div",{className:(0,e.cn)("mx-auto w-full px-4 py-6 sm:px-6 lg:px-8",f[c],b),children:a})}},19121:a=>{a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},26713:a=>{a.exports=require("next/dist/shared/lib/router/utils/is-bot")},28354:a=>{a.exports=require("util")},29294:a=>{a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:a=>{a.exports=require("path")},34993:(a,b,c)=>{c.r(b),c.d(b,{default:()=>aj});var d=c(21124),e=c(38301),f=c.n(e),g=c(71256),h=c(82042),i=c(85351),j=c(44688),k=c(43700),l=c(37224),m=c(82548),n=c(88285),o=c(89023),p=c(3368),q=c(49269),r=c(40284),s=c(57461),t=c(21393),u=c(96610),v=c(72124);let w={all:["documents"],lists:()=>[...w.all,"list"],list:(a,b)=>[...w.lists(),a,{filters:b}],details:()=>[...w.all,"detail"],detail:a=>[...w.details(),a],stats:a=>[...w.all,a,"stats"]};var x=c(3663),y=c(14263),z=c(75219),A=c(18310),B=c(47089),C=c(35284),D=c(62186),E=c(64772),F=c(44943);let G=["image/jpeg","image/jpg","image/png","image/webp","application/pdf"];function H({maxSize:a=0xa00000,acceptedTypes:b=G,maxFiles:c=5,onComplete:f,className:g}){let[h,i]=(0,e.useState)(!1),[j,l]=(0,e.useState)([]),[m,n]=(0,e.useState)(null),{mutateAsync:o}=function(){let a=(0,u.jE)(),{data:b}=(0,s.useSession)(),c=b?.user?.orgId;return(0,v.n)({mutationFn:async({file:a,onProgress:b})=>{if(!c)throw Error("No organization ID");let d=new FormData;return d.append("file",a),d.append("orgId",c),new Promise((a,c)=>{let e=new XMLHttpRequest;e.upload.addEventListener("progress",a=>{a.lengthComputable&&b&&b(Math.round(a.loaded/a.total*100))}),e.addEventListener("load",()=>{if(e.status>=200&&e.status<300)try{let b=JSON.parse(e.responseText);a(b)}catch(a){c(Error("Invalid response format"))}else try{let a=JSON.parse(e.responseText);c(Error(a.error||"Upload failed"))}catch{c(Error("Upload failed"))}}),e.addEventListener("error",()=>{c(Error("Network error during upload"))}),e.open("POST","/api/documents/upload"),e.send(d)})},onSuccess:()=>{c&&(a.invalidateQueries({queryKey:w.lists()}),a.invalidateQueries({queryKey:w.stats(c)}))}})}(),p=(0,e.useCallback)(c=>b.includes(c.type)?c.size>a?`File size exceeds ${Math.round(a/1024/1024)}MB limit.`:null:`File type ${c.type} not supported. Please upload images or PDFs.`,[b,a]),q=(0,e.useCallback)(async a=>{if(n(null),a.length>c)return void n(`Maximum ${c} files allowed at once.`);for(let b of a){let a=p(b);if(a)return void n(a)}l(a.map(a=>({file:a,progress:0,status:"pending"})));for(let b=0;b<a.length;b++){let c=a[b];try{l(a=>a.map((a,c)=>c===b?{...a,status:"uploading"}:a));let a=await o({file:c,onProgress:a=>{l(c=>c.map((c,d)=>d===b?{...c,progress:a}:c))}});l(c=>c.map((c,d)=>d===b?{...c,status:"processing",progress:100,document:a.document}:c)),setTimeout(()=>{l(a=>a.map((a,c)=>c===b?{...a,status:"completed"}:a))},1e3)}catch(a){l(c=>c.map((c,d)=>d===b?{...c,status:"error",error:a instanceof Error?a.message:"Upload failed"}:c))}}f&&setTimeout(()=>{f()},2e3)},[c,p,o,f]),r=(0,e.useCallback)(a=>{a.preventDefault(),a.stopPropagation(),i(!0)},[]),t=(0,e.useCallback)(a=>{a.preventDefault(),a.stopPropagation(),i(!1)},[]),H=(0,e.useCallback)(a=>{a.preventDefault(),a.stopPropagation()},[]),I=(0,e.useCallback)(a=>{a.preventDefault(),a.stopPropagation(),i(!1);let b=Array.from(a.dataTransfer.files);b.length>0&&q(b)},[q]),J=(0,e.useCallback)(a=>{let b=Array.from(a.target.files||[]);b.length>0&&q(b),a.target.value=""},[q]),K=(0,e.useCallback)(a=>{l(b=>b.filter((b,c)=>c!==a))},[]),L=(0,e.useCallback)(()=>{l([]),n(null)},[]);return(0,d.jsxs)("div",{className:(0,F.cn)("space-y-4",g),children:[(0,d.jsx)(D.Zp,{className:(0,F.cn)("relative transition-all duration-200",h&&"border-astralis-blue border-2 bg-blue-50"),children:(0,d.jsx)(D.Wu,{className:"p-8",children:(0,d.jsxs)("div",{onDragEnter:r,onDragOver:H,onDragLeave:t,onDrop:I,className:"flex flex-col items-center justify-center space-y-4",children:[(0,d.jsx)("div",{className:(0,F.cn)("flex h-20 w-20 items-center justify-center rounded-full transition-colors",h?"bg-astralis-blue":"bg-slate-100"),children:(0,d.jsx)(k.A,{className:(0,F.cn)("h-10 w-10 transition-colors",h?"text-white":"text-slate-600")})}),(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("p",{className:"text-lg font-semibold text-astralis-navy",children:h?"Drop files here":"Drag & drop files here"}),(0,d.jsxs)("p",{className:"text-sm text-slate-500 mt-1",children:["or click to browse (max ",c," files, ",Math.round(a/1024/1024),"MB each)"]})]}),(0,d.jsx)("input",{type:"file",id:"file-upload",className:"hidden",multiple:!0,accept:b.join(","),onChange:J}),(0,d.jsx)("label",{htmlFor:"file-upload",children:(0,d.jsx)(C.$,{variant:"primary",size:"lg",asChild:!0,children:(0,d.jsx)("span",{children:"Select Files"})})}),(0,d.jsx)("p",{className:"text-xs text-slate-400",children:"Supported: JPG, PNG, WebP, PDF"})]})})}),m&&(0,d.jsx)(E.Fc,{variant:"error",showIcon:!0,children:(0,d.jsx)(E.TN,{children:m})}),j.length>0&&(0,d.jsx)(D.Zp,{children:(0,d.jsxs)(D.Wu,{className:"p-6",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,d.jsxs)("h3",{className:"text-lg font-semibold text-astralis-navy",children:["Uploading ",j.length," ",1===j.length?"file":"files"]}),(0,d.jsx)(C.$,{variant:"ghost",size:"sm",onClick:L,children:"Clear All"})]}),(0,d.jsx)("div",{className:"space-y-3",children:j.map((a,b)=>(0,d.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg",children:[(0,d.jsx)("div",{className:"flex-shrink-0",children:(0,d.jsx)(x.A,{className:"h-8 w-8 text-astralis-blue"})}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("p",{className:"text-sm font-medium text-astralis-navy truncate",children:a.file.name}),(0,d.jsxs)("p",{className:"text-xs text-slate-500",children:[(a.file.size/1024/1024).toFixed(2)," MB"]}),("uploading"===a.status||"processing"===a.status)&&(0,d.jsxs)("div",{className:"mt-2",children:[(0,d.jsx)("div",{className:"h-1.5 bg-slate-200 rounded-full overflow-hidden",children:(0,d.jsx)("div",{className:"h-full bg-astralis-blue transition-all duration-300",style:{width:`${a.progress}%`}})}),(0,d.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"uploading"===a.status?`Uploading... ${a.progress}%`:"Processing..."})]}),"error"===a.status&&a.error&&(0,d.jsx)("p",{className:"text-xs text-error mt-1",children:a.error})]}),(0,d.jsxs)("div",{className:"flex-shrink-0",children:["uploading"===a.status&&(0,d.jsx)(y.A,{className:"h-5 w-5 text-astralis-blue animate-spin"}),"processing"===a.status&&(0,d.jsx)(y.A,{className:"h-5 w-5 text-orange-500 animate-spin"}),"completed"===a.status&&(0,d.jsx)(z.A,{className:"h-5 w-5 text-success"}),"error"===a.status&&(0,d.jsx)(A.A,{className:"h-5 w-5 text-error"})]}),("completed"===a.status||"error"===a.status)&&(0,d.jsx)("button",{onClick:()=>K(b),className:"flex-shrink-0 p-1 hover:bg-slate-200 rounded transition-colors","aria-label":"Remove file",children:(0,d.jsx)(B.A,{className:"h-4 w-4 text-slate-500"})})]},`${a.file.name}-${b}`))})]})})]})}var I=c(25345),J=c(99187);let K={PENDING:{variant:"default",label:"Pending",icon:y.A,iconClassName:"animate-spin"},PROCESSING:{variant:"warning",label:"Processing",icon:y.A,iconClassName:"animate-spin"},COMPLETED:{variant:"success",label:"Completed",icon:z.A,iconClassName:""},FAILED:{variant:"error",label:"Failed",icon:A.A,iconClassName:""}};function L({document:a,onView:b,onChat:c,showActions:e=!0,className:f}){var h,i;let{mutate:k,isPending:l}=function(){let a=(0,u.jE)(),{data:b}=(0,s.useSession)(),c=b?.user?.orgId;return(0,v.n)({mutationFn:async a=>{let b=await fetch(`/api/documents/${a}?orgId=${c}`,{method:"DELETE"});if(!b.ok)throw Error("Failed to delete document");return b.json()},onSuccess:(b,d)=>{a.removeQueries({queryKey:w.detail(d)}),c&&(a.invalidateQueries({queryKey:w.lists()}),a.invalidateQueries({queryKey:w.stats(c)}))}})}(),{mutate:m,isPending:n}=function(){let a=(0,u.jE)(),{data:b}=(0,s.useSession)(),c=b?.user?.orgId;return(0,v.n)({mutationFn:async a=>{let b=await fetch(`/api/documents/${a}/retry`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orgId:c})});if(!b.ok)throw Error("Failed to retry document processing");return b.json()},onSuccess:(b,d)=>{a.invalidateQueries({queryKey:w.detail(d)}),c&&a.invalidateQueries({queryKey:w.lists()})}})}(),o=K[a.status],t=o.icon;return(0,d.jsxs)(D.Zp,{className:(0,F.cn)("overflow-hidden hover",f),hover:!0,children:[(0,d.jsx)(D.Wu,{className:"p-4",children:(0,d.jsxs)("div",{className:"flex gap-4",children:[(0,d.jsx)("div",{className:"flex-shrink-0",children:a.thumbnailUrl?(0,d.jsx)("img",{src:a.thumbnailUrl,alt:a.originalName,className:"h-20 w-20 rounded-lg object-cover border border-slate-200"}):(0,d.jsx)("div",{className:(0,F.cn)("h-20 w-20 rounded-lg bg-slate-100 flex items-center justify-center",(h=a.mimeType).startsWith("image/")?"text-purple-500":"application/pdf"===h?"text-red-500":"text-slate-500"),children:(0,d.jsx)(x.A,{className:"h-10 w-10"})})}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsx)("h3",{className:"text-sm font-semibold text-astralis-navy truncate",title:a.originalName,children:a.originalName}),(0,d.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:[(i=a.fileSize)<1024?`${i} B`:i<1048576?`${(i/1024).toFixed(1)} KB`:`${(i/1024/1024).toFixed(2)} MB`," •"," ",(0,g.GP)(new Date(a.createdAt),"MMM d, yyyy")]})]}),(0,d.jsxs)(J.E,{variant:o.variant,className:"flex items-center gap-1",children:[(0,d.jsx)(t,{className:(0,F.cn)("h-3 w-3",o.iconClassName)}),o.label]})]}),"COMPLETED"===a.status&&null!==a.ocrConfidence&&(0,d.jsxs)("div",{className:"mt-2",children:[(0,d.jsxs)("p",{className:"text-xs text-slate-500",children:["OCR Confidence: ",Math.round(100*a.ocrConfidence),"%"]}),(0,d.jsx)("div",{className:"h-1 bg-slate-200 rounded-full overflow-hidden mt-1",children:(0,d.jsx)("div",{className:(0,F.cn)("h-full transition-all",a.ocrConfidence>=.8?"bg-success":a.ocrConfidence>=.6?"bg-warning":"bg-error"),style:{width:`${100*a.ocrConfidence}%`}})})]}),"FAILED"===a.status&&a.processingError&&(0,d.jsxs)("div",{className:"mt-2 flex items-start gap-2",children:[(0,d.jsx)(A.A,{className:"h-4 w-4 text-error flex-shrink-0 mt-0.5"}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("p",{className:"text-xs font-medium text-error",children:"Processing Error:"}),(0,d.jsx)("p",{className:"text-xs text-error",children:a.processingError})]})]}),a.metadata&&"object"==typeof a.metadata&&"embeddingError"in a.metadata&&(0,d.jsxs)("div",{className:"mt-2 flex items-start gap-2",children:[(0,d.jsx)(A.A,{className:"h-4 w-4 text-warning flex-shrink-0 mt-0.5"}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("p",{className:"text-xs font-medium text-warning",children:"Embedding Error:"}),(0,d.jsx)("p",{className:"text-xs text-warning",children:String(a.metadata.embeddingError)})]})]}),a.extractedData&&Object.keys(a.extractedData).length>0&&(0,d.jsxs)("div",{className:"mt-2",children:[(0,d.jsx)("p",{className:"text-xs font-medium text-slate-600",children:"Extracted Data:"}),(0,d.jsxs)("div",{className:"flex flex-wrap gap-1 mt-1",children:[Object.keys(a.extractedData).slice(0,3).map(a=>(0,d.jsx)(J.E,{variant:"secondary",className:"text-xs",children:a},a)),Object.keys(a.extractedData).length>3&&(0,d.jsxs)(J.E,{variant:"secondary",className:"text-xs",children:["+",Object.keys(a.extractedData).length-3," more"]})]})]})]})]})}),e&&(0,d.jsx)(D.wL,{className:"p-4 pt-0",children:(0,d.jsxs)("div",{className:"flex items-center gap-2 w-full",children:[(0,d.jsxs)(C.$,{variant:"outline",size:"sm",onClick:()=>b?.(a),className:"flex-1",disabled:!a.cdnUrl,children:[(0,d.jsx)(p.A,{className:"h-4 w-4 mr-1"}),"View"]}),"COMPLETED"===a.status&&c&&(0,d.jsx)(C.$,{variant:"outline",size:"sm",onClick:()=>c(a.id),title:"Chat with this document",children:(0,d.jsx)(j.A,{className:"h-5 w-5"})}),(0,d.jsx)(C.$,{variant:"outline",size:"sm",onClick:()=>{a.cdnUrl&&window.open(a.cdnUrl,"_blank")},disabled:!a.cdnUrl,children:(0,d.jsx)(q.A,{className:"h-5 w-5"})}),("PENDING"===a.status||"FAILED"===a.status||"COMPLETED"===a.status&&(null===a.ocrConfidence||0===a.ocrConfidence))&&(0,d.jsx)(C.$,{variant:"outline",size:"sm",onClick:()=>{m(a.id)},disabled:n,title:"PENDING"===a.status?"Start processing":"FAILED"===a.status?"Retry processing":"Re-process document",children:(0,d.jsx)(I.A,{className:(0,F.cn)("h-5 w-5",n&&"animate-spin")})}),(0,d.jsx)(C.$,{variant:"destructive",size:"sm",onClick:()=>{confirm(`Are you sure you want to delete "${a.originalName}"? This action cannot be undone.`)&&k(a.id)},disabled:l,children:(0,d.jsx)(r.A,{className:"h-5 w-5"})})]})})]})}var M=c(31851),N=c(33872),O=c(15161),P=c(72380),Q=c(86851);let R=a=>a<1024?`${a} B`:a<1048576?`${(a/1024).toFixed(1)} KB`:`${(a/1024/1024).toFixed(2)} MB`;function S({document:a,isOpen:b,onClose:c}){let[f,h]=(0,e.useState)(100),[i,j]=(0,e.useState)(0),[k,l]=(0,e.useState)(!1),[m,n]=(0,e.useState)(null),[o,r]=(0,e.useState)(!1);if(!a)return null;let s=a.mimeType.startsWith("image/"),t="application/pdf"===a.mimeType,u=async()=>{};return(0,d.jsx)(Q.cj,{open:b,onOpenChange:c,children:(0,d.jsxs)(Q.h,{side:"right",className:"w-full sm:max-w-2xl lg:max-w-4xl overflow-y-auto",children:[(0,d.jsx)(Q.Fm,{children:(0,d.jsx)("div",{className:"flex items-start justify-between",children:(0,d.jsxs)("div",{className:"flex-1 min-w-0 pr-8",children:[(0,d.jsx)(Q.qp,{className:"truncate",children:a.originalName}),(0,d.jsxs)(Q.Qs,{className:"flex items-center gap-2 mt-1",children:[(0,d.jsx)("span",{children:R(a.fileSize)}),(0,d.jsx)("span",{children:"•"}),(0,d.jsx)("span",{children:(0,g.GP)(new Date(a.createdAt),"PPP")})]})]})})}),(0,d.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(C.$,{variant:"outline",size:"sm",onClick:()=>h(a=>Math.max(a-25,50)),children:(0,d.jsx)(M.A,{className:"h-4 w-4"})}),(0,d.jsxs)("span",{className:"text-sm text-slate-600 min-w-[60px] text-center",children:[f,"%"]}),(0,d.jsx)(C.$,{variant:"outline",size:"sm",onClick:()=>h(a=>Math.min(a+25,200)),children:(0,d.jsx)(N.A,{className:"h-4 w-4"})}),s&&(0,d.jsx)(C.$,{variant:"outline",size:"sm",onClick:()=>j(a=>(a+90)%360),children:(0,d.jsx)(O.A,{className:"h-4 w-4"})}),(0,d.jsx)(C.$,{variant:"ghost",size:"sm",onClick:()=>{h(100),j(0)},children:"Reset"})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[a.ocrText&&s&&(0,d.jsx)(C.$,{variant:k?"primary":"outline",size:"sm",onClick:()=>l(a=>!a),children:k?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(P.A,{className:"h-4 w-4 mr-1"}),"Hide OCR"]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(p.A,{className:"h-4 w-4 mr-1"}),"Show OCR"]})}),(0,d.jsxs)(C.$,{variant:"outline",size:"sm",onClick:u,children:[(0,d.jsx)(q.A,{className:"h-4 w-4 mr-1"}),"Download"]})]})]}),(0,d.jsx)("div",{className:"relative bg-slate-100 rounded-lg overflow-hidden min-h-[500px] flex items-center justify-center p-4",children:m?(0,d.jsxs)(d.Fragment,{children:[s&&(0,d.jsx)("img",{src:m,alt:a.originalName,className:"max-w-full h-auto transition-transform",style:{transform:`scale(${f/100}) rotate(${i}deg)`}}),t&&(0,d.jsx)("iframe",{src:m,className:"w-full h-[600px] border-0",title:a.originalName}),!s&&!t&&(0,d.jsxs)("div",{className:"text-center text-slate-500",children:[(0,d.jsx)(x.A,{className:"h-16 w-16 mx-auto mb-4"}),(0,d.jsx)("p",{children:"Preview not available for this file type"}),(0,d.jsx)(C.$,{variant:"primary",size:"lg",className:"mt-4",onClick:u,children:"Download to View"})]})]}):(0,d.jsxs)("div",{className:"text-center text-slate-500",children:[(0,d.jsx)(x.A,{className:"h-16 w-16 mx-auto mb-4"}),(0,d.jsx)("p",{children:"Document not available"})]})}),k&&a.ocrText&&(0,d.jsxs)("div",{className:"p-4 bg-white border border-slate-200 rounded-lg",children:[(0,d.jsxs)("h4",{className:"text-sm font-semibold text-astralis-navy mb-2 flex items-center gap-2",children:[(0,d.jsx)(x.A,{className:"h-4 w-4"}),"Extracted Text (OCR)",a.ocrConfidence&&(0,d.jsxs)(J.E,{variant:"secondary",className:"ml-auto",children:[Math.round(100*a.ocrConfidence),"% confidence"]})]}),(0,d.jsx)("div",{className:"text-sm text-slate-600 whitespace-pre-wrap max-h-60 overflow-y-auto",children:a.ocrText})]}),a.extractedData&&Object.keys(a.extractedData).length>0&&(0,d.jsxs)("div",{className:"p-4 bg-white border border-slate-200 rounded-lg",children:[(0,d.jsx)("h4",{className:"text-sm font-semibold text-astralis-navy mb-3",children:"Extracted Structured Data"}),(0,d.jsx)("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(a.extractedData).map(([a,b])=>(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:a.replace(/([A-Z])/g," $1").trim()}),(0,d.jsx)("p",{className:"text-sm text-astralis-navy font-medium",children:"object"==typeof b?JSON.stringify(b):String(b)})]},a))})]}),(0,d.jsxs)("div",{className:"p-4 bg-slate-50 rounded-lg",children:[(0,d.jsx)("h4",{className:"text-sm font-semibold text-astralis-navy mb-3",children:"Document Information"}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-slate-500",children:"File Name"}),(0,d.jsx)("p",{className:"text-astralis-navy font-medium break-all",children:a.fileName})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-slate-500",children:"File Size"}),(0,d.jsx)("p",{className:"text-astralis-navy font-medium",children:R(a.fileSize)})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-slate-500",children:"MIME Type"}),(0,d.jsx)("p",{className:"text-astralis-navy font-medium",children:a.mimeType})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-slate-500",children:"Status"}),(0,d.jsx)(J.E,{variant:"COMPLETED"===a.status?"success":"FAILED"===a.status?"error":"warning",children:a.status})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-slate-500",children:"Uploaded"}),(0,d.jsx)("p",{className:"text-astralis-navy font-medium",children:(0,g.GP)(new Date(a.createdAt),"PPpp")})]}),a.processedAt&&(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-slate-500",children:"Processed"}),(0,d.jsx)("p",{className:"text-astralis-navy font-medium",children:(0,g.GP)(new Date(a.processedAt),"PPpp")})]})]}),a.processingError&&(0,d.jsxs)("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,d.jsx)("p",{className:"text-xs font-semibold text-error mb-1",children:"Processing Error"}),(0,d.jsx)("p",{className:"text-sm text-red-700",children:a.processingError})]})]})]})]})})}var T=c(71563),U=c(68254),V=c(18690);let W=V.bL,X=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(V.q7,{ref:c,className:(0,F.cn)("border-b border-slate-300",a),...b}));X.displayName="AccordionItem";let Y=e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsx)(V.Y9,{className:"flex",children:(0,d.jsxs)(V.l9,{ref:e,className:(0,F.cn)("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline text-slate-900 dark:text-white [&[data-state=open]>svg]:rotate-180",a),...c,children:[b,(0,d.jsx)(i.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200 text-slate-500"})]})}));Y.displayName=V.l9.displayName;let Z=e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsx)(V.UC,{ref:e,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...c,children:(0,d.jsx)("div",{className:(0,F.cn)("pb-4 pt-0",a),children:b})}));Z.displayName=V.UC.displayName;class $ extends Error{constructor(a,b,c){super(a),this.status=b,this.details=c,this.name="ChatAPIError"}}async function _(a){let b=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(a)}),c=await b.json();if(!b.ok)throw new $(c.message||"Failed to send message",b.status,c.details);return c.data}async function aa(a=50,b=0,c){let d=new URLSearchParams({limit:a.toString(),offset:b.toString()});c&&d.set("documentId",c);let e=await fetch(`/api/chat?${d}`,{method:"GET",credentials:"include"}),f=await e.json();if(!e.ok)throw new $(f.message||"Failed to list chats",e.status,f.details);return f.data}async function ab(a){let b=await fetch(`/api/chat/${a}`,{method:"GET",credentials:"include"}),c=await b.json();if(!b.ok)throw new $(c.message||"Failed to get chat",b.status,c.details);return c.data}async function ac(a){let b=await fetch(`/api/chat/${a}`,{method:"DELETE",credentials:"include"}),c=await b.json();if(!b.ok)throw new $(c.message||"Failed to delete chat",b.status,c.details)}function ad({documentId:a,orgId:b,userId:c,chatId:g,className:h}){let[i,j]=(0,e.useState)([]),[k,l]=(0,e.useState)(""),[m,n]=(0,e.useState)(g),[o,p]=(0,e.useState)(null),q=(0,e.useRef)(null),r=(0,e.useRef)(null),{sendMessage:s,fetchChat:t,loading:u,error:v}=function(){let[a,b]=f().useState(!1),[c,d]=f().useState(null);return{sendMessage:async a=>{b(!0),d(null);try{return await _(a)}catch(b){let a=b instanceof $?b:new $("Unknown error",500);throw d(a),a}finally{b(!1)}},fetchChats:async(a,c,e)=>{b(!0),d(null);try{return await aa(a,c,e)}catch(b){let a=b instanceof $?b:new $("Unknown error",500);throw d(a),a}finally{b(!1)}},fetchChat:async a=>{b(!0),d(null);try{return await ab(a)}catch(b){let a=b instanceof $?b:new $("Unknown error",500);throw d(a),a}finally{b(!1)}},removeChat:async a=>{b(!0),d(null);try{await ac(a)}catch(b){let a=b instanceof $?b:new $("Unknown error",500);throw d(a),a}finally{b(!1)}},loading:a,error:c}}(),w=async b=>{if(b.preventDefault(),!k.trim()||u)return;let c={id:`user-${Date.now()}`,role:"user",content:k.trim(),timestamp:new Date().toISOString()};j(a=>[...a,c]),l(""),r.current&&(r.current.style.height="auto");try{let b=await s({chatId:m,documentId:a,message:c.content});!m&&b.chatId&&n(b.chatId);let d={id:`assistant-${Date.now()}`,role:"assistant",content:b.message,timestamp:new Date().toISOString(),sources:b.sources};j(a=>[...a,d])}catch(a){console.error("Failed to send message:",a)}};return(0,d.jsxs)("div",{className:(0,F.cn)("flex flex-col h-full bg-white rounded-lg border border-slate-300",h),children:[(0,d.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-300 bg-slate-50",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(x.A,{className:"h-5 w-5 text-astralis-blue"}),(0,d.jsx)("h3",{className:"text-lg font-semibold text-astralis-navy",children:a?"Document Chat":"All Documents Chat"})]}),m&&(0,d.jsx)(J.E,{variant:"primary",className:"text-xs",children:"Active Chat"})]}),o&&(0,d.jsx)("div",{className:"px-6 pt-4",children:(0,d.jsx)(E.Fc,{variant:"error",showIcon:!0,children:(0,d.jsx)(E.TN,{children:o})})}),(0,d.jsxs)("div",{className:"flex-1 overflow-y-auto px-6 py-4 space-y-4",children:[0===i.length&&!u&&(0,d.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center py-12",children:[(0,d.jsx)(x.A,{className:"h-16 w-16 text-slate-300 mb-4"}),(0,d.jsx)("h4",{className:"text-lg font-semibold text-slate-700 mb-2",children:"Start a Conversation"}),(0,d.jsxs)("p",{className:"text-sm text-slate-500 max-w-md",children:["Ask questions about ",a?"this document":"your documents"," and get AI-powered answers with source citations."]})]}),i.map(a=>(0,d.jsx)("div",{className:(0,F.cn)("flex gap-3","user"===a.role?"justify-end":"justify-start"),children:(0,d.jsxs)("div",{className:(0,F.cn)("flex flex-col max-w-[80%] gap-2","user"===a.role?"items-end":"items-start"),children:[(0,d.jsx)(D.Zp,{variant:"default",className:(0,F.cn)("px-4 py-3","user"===a.role?"bg-astralis-blue text-white border-astralis-blue":"bg-white border-slate-300"),children:(0,d.jsx)("p",{className:(0,F.cn)("text-sm leading-relaxed whitespace-pre-wrap","user"===a.role?"text-white":"text-slate-900"),children:a.content})}),(0,d.jsx)("span",{className:"text-xs text-slate-500",children:new Date(a.timestamp).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}),"assistant"===a.role&&a.sources&&a.sources.length>0&&(0,d.jsx)("div",{className:"w-full",children:(0,d.jsx)(W,{type:"single",collapsible:!0,className:"w-full",children:(0,d.jsxs)(X,{value:"sources",className:"border-0",children:[(0,d.jsx)(Y,{className:"py-2 hover:no-underline",children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(x.A,{className:"h-3.5 w-3.5 text-astralis-blue"}),(0,d.jsxs)("span",{className:"text-xs font-semibold text-slate-700",children:["Sources (",a.sources.length,")"]})]})}),(0,d.jsx)(Z,{className:"pt-2",children:(0,d.jsx)("div",{className:"space-y-2",children:a.sources.map((a,b)=>(0,d.jsxs)(D.Zp,{variant:"bordered",className:"p-3 bg-slate-50",children:[(0,d.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-2",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(x.A,{className:"h-3.5 w-3.5 text-astralis-blue flex-shrink-0"}),(0,d.jsx)("p",{className:"text-xs font-medium text-slate-900",children:a.documentName})]}),(0,d.jsxs)(J.E,{variant:"default",className:"text-xs",children:[Math.round(100*a.similarity),"% match"]})]}),(0,d.jsx)("p",{className:"text-xs text-slate-600 line-clamp-2",children:a.content})]},`${a.documentId}-${a.chunkIndex}`))})})]})})})]})},a.id)),u&&(0,d.jsx)("div",{className:"flex justify-start",children:(0,d.jsx)(D.Zp,{variant:"default",className:"px-4 py-3 bg-slate-50 border-slate-300",children:(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)(y.A,{size:"25",className:"text-astralis-blue animate-spin "}),(0,d.jsx)("p",{className:"text-sm text-slate-600 font-medium",children:"Thinking..."})]})})}),v&&(0,d.jsx)(E.Fc,{variant:"error",showIcon:!0,children:(0,d.jsxs)(E.TN,{children:[(0,d.jsx)("strong",{children:"Error:"})," ",v.message,v.details&&(0,d.jsx)("p",{className:"mt-1 text-xs",children:JSON.stringify(v.details)})]})}),(0,d.jsx)("div",{ref:q})]}),(0,d.jsxs)("div",{className:"px-6 py-4 border-t border-slate-300 bg-slate-50",children:[(0,d.jsxs)("form",{onSubmit:w,className:"flex gap-2",children:[(0,d.jsx)(U.T,{ref:r,value:k,onChange:a=>{l(a.target.value);let b=a.target;b.style.height="auto",b.style.height=`${Math.min(b.scrollHeight,200)}px`},onKeyDown:a=>{"Enter"!==a.key||a.shiftKey||(a.preventDefault(),w(a))},placeholder:"Ask a question about the document...",disabled:u,className:"resize-none min-h-[44px] max-h-[200px]",rows:1}),(0,d.jsx)(C.$,{type:"submit",variant:"primary",size:"icon",disabled:!k.trim()||u,className:"flex-shrink-0",children:u?(0,d.jsx)(y.A,{className:"h-4 w-4 animate-spin"}):(0,d.jsx)(T.A,{className:"h-4 w-4"})})]}),(0,d.jsx)("p",{className:"text-xs text-slate-500 mt-2",children:"Press Enter to send, Shift+Enter for new line"})]})]})}var ae=c(16936),af=c(45050),ag=c(96942),ah=c(93758);let ai={PENDING:"default",PROCESSING:"warning",COMPLETED:"success",FAILED:"error"};function aj(){let{data:a}=(0,s.useSession)(),[b,c]=(0,e.useState)(null),[f,u]=(0,e.useState)(!1),[v,x]=(0,e.useState)(!1),[y,z]=(0,e.useState)(!1),[A,B]=(0,e.useState)(),[E,F]=(0,e.useState)(""),[G,I]=(0,e.useState)(),[K,M]=(0,e.useState)(),[N,O]=(0,e.useState)(1),[P,R]=(0,e.useState)("table"),[T,U]=(0,e.useState)("createdAt"),[V,W]=(0,e.useState)("desc"),{data:X,isLoading:Y,error:Z}=function(a){let{data:b}=(0,s.useSession)(),c=b?.user?.orgId,d=new URLSearchParams({orgId:c||"",...a?.status&&{status:a.status},...a?.mimeType&&{mimeType:a.mimeType},...a?.uploadedBy&&{uploadedBy:a.uploadedBy},...a?.startDate&&{startDate:a.startDate},...a?.endDate&&{endDate:a.endDate},...a?.search&&{search:a.search},...a?.limit&&{limit:a.limit.toString()},...a?.offset&&{offset:a.offset.toString()}});return(0,t.I)({queryKey:c?w.list(c,a):["documents"],queryFn:async()=>{if(!c)throw Error("No organization ID");let a=await fetch(`/api/documents?${d}`);if(!a.ok)throw Error("Failed to fetch documents");let b=await a.json();return{documents:b.documents,total:b.pagination.total,hasMore:b.pagination.hasMore}},enabled:!!c,staleTime:3e4,refetchInterval:a=>{let b=a.state.data;return!!(b?.documents&&b.documents.some(a=>"PENDING"===a.status||"PROCESSING"===a.status))&&5e3}})}({status:G,mimeType:K,search:E||void 0,limit:12,offset:(N-1)*12}),{data:$}=function(){let{data:a}=(0,s.useSession)(),b=a?.user?.orgId;return(0,t.I)({queryKey:b?w.stats(b):["document-stats"],queryFn:async()=>{if(!b)throw Error("No organization ID");let a=await fetch(`/api/documents/stats?orgId=${b}`);if(!a.ok)throw Error("Failed to fetch document stats");return(await a.json()).stats},enabled:!!b,staleTime:6e4,refetchInterval:a=>{let b=a.state.data;return!!b&&(b.pending>0||b.processing>0)&&5e3}})}(),_=X?.documents||[],aa=X?.total||0,ab=X?.hasMore||!1,ac=(0,e.useMemo)(()=>[..._].sort((a,b)=>{let c=0;switch(T){case"name":c=a.originalName.localeCompare(b.originalName);break;case"type":c=a.mimeType.localeCompare(b.mimeType);break;case"size":c=a.fileSize-b.fileSize;break;case"status":c=a.status.localeCompare(b.status);break;case"createdAt":c=new Date(a.createdAt).getTime()-new Date(b.createdAt).getTime();break;default:c=0}return"asc"===V?c:-c}),[_,T,V]),aj=a=>{T===a?W("asc"===V?"desc":"asc"):(U(a),W("asc"))},ak=a=>T!==a?(0,d.jsx)(h.A,{className:"h-4 w-4 text-slate-300"}):"asc"===V?(0,d.jsx)(h.A,{className:"h-4 w-4 text-astralis-blue"}):(0,d.jsx)(i.A,{className:"h-4 w-4 text-astralis-blue"}),al=a=>{c(a)},am=a=>{B(a),z(!0)},an=()=>{I(void 0),M(void 0),F(""),O(1)},ao=G||K||E;return(0,d.jsxs)(ae.L,{children:[(0,d.jsx)(af.z,{title:"Documents",description:"Manage and view all uploaded documents with OCR processing",actions:(0,d.jsxs)("div",{className:"flex gap-3",children:[(0,d.jsxs)(C.$,{variant:"outline",className:"gap-2",onClick:()=>{B(void 0),z(!0)},children:[(0,d.jsx)(j.A,{className:"h-5 w-5"}),"Chat with Documents"]}),(0,d.jsxs)(C.$,{variant:"primary",className:"gap-2",onClick:()=>u(!0),children:[(0,d.jsx)(k.A,{className:"h-5 w-5"}),"Upload Documents"]})]})}),$&&(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:[(0,d.jsx)(D.Zp,{children:(0,d.jsxs)(D.Wu,{className:"p-4",children:[(0,d.jsx)("p",{className:"text-sm text-slate-500",children:"Total Documents"}),(0,d.jsx)("p",{className:"text-2xl font-bold text-astralis-navy",children:$.total})]})}),(0,d.jsx)(D.Zp,{children:(0,d.jsxs)(D.Wu,{className:"p-4",children:[(0,d.jsx)("p",{className:"text-sm text-slate-500",children:"Pending"}),(0,d.jsx)("p",{className:"text-2xl font-bold text-slate-600",children:$.pending})]})}),(0,d.jsx)(D.Zp,{children:(0,d.jsxs)(D.Wu,{className:"p-4",children:[(0,d.jsx)("p",{className:"text-sm text-slate-500",children:"Processing"}),(0,d.jsx)("p",{className:"text-2xl font-bold text-warning",children:$.processing})]})}),(0,d.jsx)(D.Zp,{children:(0,d.jsxs)(D.Wu,{className:"p-4",children:[(0,d.jsx)("p",{className:"text-sm text-slate-500",children:"Completed"}),(0,d.jsx)("p",{className:"text-2xl font-bold text-success",children:$.completed})]})}),(0,d.jsx)(D.Zp,{children:(0,d.jsxs)(D.Wu,{className:"p-4",children:[(0,d.jsx)("p",{className:"text-sm text-slate-500",children:"Failed"}),(0,d.jsx)("p",{className:"text-2xl font-bold text-error",children:$.failed})]})})]}),(0,d.jsxs)("div",{className:"flex items-center gap-1 mb-4 border-b border-slate-200",children:[(0,d.jsxs)("button",{onClick:()=>R("table"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors border-b-2 -mb-px ${"table"===P?"border-astralis-blue text-astralis-blue":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}`,children:[(0,d.jsx)(l.A,{className:"h-5 w-5"}),"Table View"]}),(0,d.jsxs)("button",{onClick:()=>R("grid"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors border-b-2 -mb-px ${"grid"===P?"border-astralis-blue text-astralis-blue":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"}`,children:[(0,d.jsx)(m.A,{className:"h-5 w-5"}),"Grid View"]})]}),(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 mb-6",children:[(0,d.jsxs)("div",{className:"flex-1 relative",children:[(0,d.jsx)(n.A,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-slate-400"}),(0,d.jsx)(ah.p,{type:"search",placeholder:"Search documents...",value:E,onChange:a=>F(a.target.value),className:"pl-12"})]}),(0,d.jsxs)(C.$,{variant:"outline",onClick:()=>x(!0),className:"flex items-center gap-2",children:[(0,d.jsx)(o.A,{className:"h-5 w-5"}),"Filters",ao&&(0,d.jsx)(J.E,{variant:"primary",className:"ml-1",children:[G,K,E].filter(Boolean).length})]}),ao&&(0,d.jsx)(C.$,{variant:"ghost",onClick:an,children:"Clear"})]}),Y&&(0,d.jsx)("div",{className:"text-center py-12",children:(0,d.jsx)("p",{className:"text-slate-500",children:"Loading documents..."})}),Z&&(0,d.jsx)(D.Zp,{variant:"bordered",className:"p-6",children:(0,d.jsx)("p",{className:"text-error text-center",children:"Failed to load documents. Please try again."})}),!Y&&!Z&&0===_.length&&(0,d.jsx)(ag.p,{icon:k.A,title:"No documents found",description:ao?"Try adjusting your filters or search query":"Upload your first document to get started",primaryAction:ao?void 0:{label:"Upload Documents",onClick:()=>u(!0)}}),!Y&&!Z&&_.length>0&&(0,d.jsxs)(d.Fragment,{children:["table"===P&&(0,d.jsx)(D.Zp,{variant:"default",className:"mb-6",children:(0,d.jsx)("div",{className:"overflow-x-auto",children:(0,d.jsxs)("table",{className:"w-full",children:[(0,d.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200",children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-100 transition-colors",onClick:()=>aj("name"),children:(0,d.jsxs)("div",{className:"flex items-center gap-1",children:["Name",ak("name")]})}),(0,d.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-100 transition-colors",onClick:()=>aj("type"),children:(0,d.jsxs)("div",{className:"flex items-center gap-1",children:["Type",ak("type")]})}),(0,d.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-100 transition-colors",onClick:()=>aj("size"),children:(0,d.jsxs)("div",{className:"flex items-center gap-1",children:["Size",ak("size")]})}),(0,d.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-100 transition-colors",onClick:()=>aj("status"),children:(0,d.jsxs)("div",{className:"flex items-center gap-1",children:["Status",ak("status")]})}),(0,d.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-100 transition-colors",onClick:()=>aj("createdAt"),children:(0,d.jsxs)("div",{className:"flex items-center gap-1",children:["Uploaded",ak("createdAt")]})}),(0,d.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),(0,d.jsx)("tbody",{className:"bg-white divide-y divide-slate-200",children:ac.map((a,b)=>{var c;return(0,d.jsxs)("tr",{className:`hover:bg-slate-100 transition-colors ${b%2==1?"bg-slate-50":""}`,children:[(0,d.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,d.jsx)("div",{className:"text-sm font-medium text-astralis-navy truncate max-w-[250px]",title:a.originalName,children:a.originalName})}),(0,d.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,d.jsx)(J.E,{variant:"default",children:(c=a.mimeType).startsWith("image/")?c.replace("image/","").toUpperCase():"application/pdf"===c?"PDF":c.includes("word")?"DOC":c.includes("spreadsheet")||c.includes("excel")?"XLS":c.split("/").pop()?.toUpperCase()||"FILE"})}),(0,d.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-500",children:function(a){if(0===a)return"0 Bytes";let b=Math.floor(Math.log(a)/Math.log(1024));return parseFloat((a/Math.pow(1024,b)).toFixed(2))+" "+["Bytes","KB","MB","GB"][b]}(a.fileSize)}),(0,d.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,d.jsx)(J.E,{variant:ai[a.status],children:a.status})}),(0,d.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-500",children:(0,g.GP)(new Date(a.createdAt),"MMM d, yyyy")}),(0,d.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("button",{onClick:()=>al(a),className:"p-2 text-slate-600 hover:text-astralis-blue hover:bg-slate-100 rounded-md transition-colors",title:"View document",children:(0,d.jsx)(p.A,{className:"h-5 w-5"})}),(0,d.jsx)("button",{onClick:()=>{a.cdnUrl&&window.open(a.cdnUrl,"_blank")},className:"p-2 text-slate-600 hover:text-astralis-blue hover:bg-slate-100 rounded-md transition-colors",title:"Download document",disabled:!a.cdnUrl,children:(0,d.jsx)(q.A,{className:"h-5 w-5"})}),(0,d.jsx)("button",{onClick:()=>{console.log("Delete requested for document:",a.id)},className:"p-2 text-slate-600 hover:text-error hover:bg-red-50 rounded-md transition-colors",title:"Delete document",children:(0,d.jsx)(r.A,{className:"h-5 w-5"})})]})})]},a.id)})})]})})}),"grid"===P&&(0,d.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:_.map(a=>(0,d.jsx)(L,{document:a,onView:al,onChat:am},a.id))}),aa>12&&(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("p",{className:"text-sm text-slate-600",children:["Showing ",(N-1)*12+1," to"," ",Math.min(12*N,aa)," of ",aa," ","documents"]}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)(C.$,{variant:"outline",onClick:()=>O(a=>Math.max(a-1,1)),disabled:1===N,children:"Previous"}),(0,d.jsx)(C.$,{variant:"outline",onClick:()=>O(a=>a+1),disabled:!ab,children:"Next"})]})]})]}),(0,d.jsx)(Q.cj,{open:f,onOpenChange:u,children:(0,d.jsxs)(Q.h,{side:"right",className:"w-full sm:max-w-xl overflow-y-auto",children:[(0,d.jsx)(Q.Fm,{children:(0,d.jsx)(Q.qp,{children:"Upload Documents"})}),(0,d.jsx)("div",{className:"mt-6",children:(0,d.jsx)(H,{onComplete:()=>{u(!1)}})})]})}),(0,d.jsx)(Q.cj,{open:v,onOpenChange:x,children:(0,d.jsxs)(Q.h,{side:"right",className:"w-full sm:max-w-md",children:[(0,d.jsx)(Q.Fm,{children:(0,d.jsx)(Q.qp,{children:"Filter Documents"})}),(0,d.jsxs)("div",{className:"mt-6 space-y-6",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-astralis-navy mb-2 block",children:"Status"}),(0,d.jsxs)("div",{className:"space-y-2",children:[["PENDING","PROCESSING","COMPLETED","FAILED"].map(a=>(0,d.jsxs)("label",{className:"flex items-center gap-2 p-2 hover:bg-slate-50 rounded cursor-pointer",children:[(0,d.jsx)("input",{type:"radio",name:"status",checked:G===a,onChange:()=>I(a),className:"text-astralis-blue focus:ring-astralis-blue"}),(0,d.jsx)("span",{className:"text-sm text-slate-700",children:a})]},a)),(0,d.jsxs)("label",{className:"flex items-center gap-2 p-2 hover:bg-slate-50 rounded cursor-pointer",children:[(0,d.jsx)("input",{type:"radio",name:"status",checked:!G,onChange:()=>I(void 0),className:"text-astralis-blue focus:ring-astralis-blue"}),(0,d.jsx)("span",{className:"text-sm text-slate-700",children:"All"})]})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium text-astralis-navy mb-2 block",children:"File Type"}),(0,d.jsxs)("div",{className:"space-y-2",children:[[{label:"Images",value:"image/"},{label:"PDFs",value:"application/pdf"}].map(a=>(0,d.jsxs)("label",{className:"flex items-center gap-2 p-2 hover:bg-slate-50 rounded cursor-pointer",children:[(0,d.jsx)("input",{type:"radio",name:"mimeType",checked:K===a.value,onChange:()=>M(a.value),className:"text-astralis-blue focus:ring-astralis-blue"}),(0,d.jsx)("span",{className:"text-sm text-slate-700",children:a.label})]},a.value)),(0,d.jsxs)("label",{className:"flex items-center gap-2 p-2 hover:bg-slate-50 rounded cursor-pointer",children:[(0,d.jsx)("input",{type:"radio",name:"mimeType",checked:!K,onChange:()=>M(void 0),className:"text-astralis-blue focus:ring-astralis-blue"}),(0,d.jsx)("span",{className:"text-sm text-slate-700",children:"All"})]})]})]}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)(C.$,{variant:"primary",className:"flex-1",onClick:()=>x(!1),children:"Apply Filters"}),(0,d.jsx)(C.$,{variant:"outline",onClick:an,children:"Clear"})]})]})]})}),(0,d.jsx)(S,{document:b,isOpen:!!b,onClose:()=>{c(null)}}),a?.user&&(0,d.jsx)(Q.cj,{open:y,onOpenChange:z,children:(0,d.jsxs)(Q.h,{side:"right",className:"w-full sm:max-w-2xl overflow-hidden flex flex-col",children:[(0,d.jsx)(Q.Fm,{children:(0,d.jsx)(Q.qp,{children:A?"Chat with Document":"Chat with Documents"})}),(0,d.jsx)("div",{className:"flex-1 overflow-hidden mt-6",children:(0,d.jsx)(ad,{documentId:A,orgId:a.user.orgId,userId:a.user.id,className:"h-full"})})]})})]})}},41025:a=>{a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},45050:(a,b,c)=>{c.d(b,{z:()=>f});var d=c(21124);c(38301);var e=c(44943);function f({title:a,description:b,actions:c,className:f}){return(0,d.jsxs)("div",{className:(0,e.cn)("flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",f),children:[(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsx)("h1",{className:"text-2xl font-bold tracking-tight text-astralis-navy sm:text-3xl",children:a}),b&&(0,d.jsx)("p",{className:"text-sm text-slate-600 sm:text-base",children:b})]}),c&&(0,d.jsx)("div",{className:"flex items-center gap-2 shrink-0",children:c})]})}},55511:a=>{a.exports=require("crypto")},55591:a=>{a.exports=require("https")},56704:(a,b,c)=>{c.r(b),c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/gadmin/Projects/astralis-nextjs/src/app/(app)/documents/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/gadmin/Projects/astralis-nextjs/src/app/(app)/documents/page.tsx","default")},62186:(a,b,c)=>{c.d(b,{BT:()=>j,Wu:()=>k,ZB:()=>i,Zp:()=>g,aR:()=>h,wL:()=>l});var d=c(21124),e=c(38301),f=c(44943);let g=e.forwardRef(({className:a,variant:b="default",hover:c=!1,...e},g)=>(0,d.jsx)("div",{ref:g,className:(0,f.cn)("rounded-lg bg-white transition-all duration-200 dark:bg-slate-800 dark:border-slate-700",{default:"border border-slate-200 shadow-[0_2px_8px_rgba(0,0,0,0.06)]",bordered:"border-2 border-slate-300",elevated:"shadow-[0_8px_24px_rgba(0,0,0,0.12)]"}[b],c&&"hover:shadow-[0_8px_24px_rgba(0,0,0,0.12)] hover:border-slate-300",a),...e}));g.displayName="Card";let h=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex flex-col space-y-1.5 p-6",a),...b}));h.displayName="CardHeader";let i=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("h3",{ref:c,className:(0,f.cn)("text-2xl font-semibold leading-none tracking-tight text-slate-900 dark:text-white",a),...b}));i.displayName="CardTitle";let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("p",{ref:c,className:(0,f.cn)("text-sm text-slate-500 dark:text-slate-400",a),...b}));j.displayName="CardDescription";let k=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("p-6 pt-0",a),...b}));k.displayName="CardContent";let l=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,f.cn)("flex items-center p-6 pt-0",a),...b}));l.displayName="CardFooter"},63033:a=>{a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64772:(a,b,c)=>{c.d(b,{Fc:()=>n,TN:()=>p,XL:()=>o});var d=c(21124),e=c(38301),f=c(26691),g=c(71117),h=c(59268),i=c(91292),j=c(18310),k=c(44943);let l=(0,f.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-white border-slate-300 text-slate-900",success:"border-green-500/50 bg-green-50 text-green-900 [&>svg]:text-green-600",error:"border-red-500/50 bg-red-50 text-red-900 [&>svg]:text-red-600",warning:"border-yellow-500/50 bg-yellow-50 text-yellow-900 [&>svg]:text-yellow-600",info:"border-blue-500/50 bg-blue-50 text-blue-900 [&>svg]:text-astralis-blue"}},defaultVariants:{variant:"default"}}),m={default:g.A,success:h.A,error:i.A,warning:j.A,info:g.A},n=e.forwardRef(({className:a,variant:b="default",showIcon:c=!1,children:e,...f},g)=>{let h=m[b||"default"];return(0,d.jsxs)("div",{ref:g,role:"alert",className:(0,k.cn)(l({variant:b}),a),...f,children:[c&&(0,d.jsx)(h,{className:"h-4 w-4"}),e]})});n.displayName="Alert";let o=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("h5",{ref:c,className:(0,k.cn)("mb-1 font-semibold leading-none tracking-tight",a),...b}));o.displayName="AlertTitle";let p=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,k.cn)("text-sm [&_p]:leading-relaxed",a),...b}));p.displayName="AlertDescription"},68254:(a,b,c)=>{c.d(b,{T:()=>g});var d=c(21124),e=c(38301),f=c(44943);let g=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("textarea",{className:(0,f.cn)("flex min-h-[80px] w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-500","dark:bg-slate-800 dark:border-slate-700 dark:text-white dark:placeholder:text-slate-400","transition-all duration-150 ease-out","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-astralis-blue focus-visible:ring-offset-0","disabled:cursor-not-allowed disabled:opacity-50",a),ref:c,...b}));g.displayName="Textarea"},74075:a=>{a.exports=require("zlib")},79428:a=>{a.exports=require("buffer")},79551:a=>{a.exports=require("url")},81630:a=>{a.exports=require("http")},86439:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external")},86851:(a,b,c)=>{c.d(b,{CG:()=>k,Fm:()=>p,Qs:()=>r,cj:()=>j,h:()=>o,qp:()=>q});var d=c(21124),e=c(38301),f=c(6843),g=c(26691),h=c(47089),i=c(44943);let j=f.bL,k=f.l9;f.bm;let l=f.ZL,m=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.hJ,{className:(0,i.cn)("fixed inset-0 z-50 bg-black/50 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...b,ref:c}));m.displayName=f.hJ.displayName;let n=(0,g.F)("fixed z-50 gap-4 bg-white p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-300",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),o=e.forwardRef(({side:a="right",className:b,children:c,...e},g)=>(0,d.jsxs)(l,{children:[(0,d.jsx)(m,{}),(0,d.jsxs)(f.UC,{ref:g,className:(0,i.cn)(n({side:a}),b),...e,children:[c,(0,d.jsxs)(f.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-white transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-astralis-blue focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-slate-100",children:[(0,d.jsx)(h.A,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));o.displayName=f.UC.displayName;let p=({className:a,...b})=>(0,d.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...b});p.displayName="SheetHeader";let q=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.hE,{ref:c,className:(0,i.cn)("text-lg font-semibold text-astralis-navy",a),...b}));q.displayName=f.hE.displayName;let r=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.VY,{ref:c,className:(0,i.cn)("text-sm text-slate-600",a),...b}));r.displayName=f.VY.displayName},93758:(a,b,c)=>{c.d(b,{p:()=>g});var d=c(21124),e=c(38301),f=c(44943);let g=e.forwardRef(({className:a,type:b,...c},e)=>(0,d.jsx)("input",{type:b,className:(0,f.cn)("flex h-10 w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-500","dark:bg-slate-800 dark:border-slate-700 dark:text-white dark:placeholder:text-slate-400","transition-all duration-150 ease-out","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-astralis-blue focus-visible:ring-offset-0","disabled:cursor-not-allowed disabled:opacity-50","file:border-0 file:bg-transparent file:text-sm file:font-medium",a),ref:e,...c}));g.displayName="Input"},94735:a=>{a.exports=require("events")},96330:a=>{a.exports=require("@prisma/client")},96942:(a,b,c)=>{c.d(b,{p:()=>g});var d=c(21124);c(38301);var e=c(44943),f=c(35284);function g({icon:a,title:b,description:c,primaryAction:g,secondaryAction:h,className:i}){return(0,d.jsxs)("div",{className:(0,e.cn)("flex flex-col items-center justify-center text-center py-12 px-4",i),children:[a&&(0,d.jsx)("div",{className:"mb-4 inline-flex items-center justify-center w-16 h-16 rounded-full bg-slate-100",children:(0,d.jsx)(a,{className:"w-8 h-8 text-slate-400",strokeWidth:1.5})}),(0,d.jsx)("h3",{className:"text-lg font-semibold text-astralis-navy mb-2",children:b}),c&&(0,d.jsx)("p",{className:"text-sm text-slate-600 max-w-md mb-6",children:c}),(g||h)&&(0,d.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[g&&(0,d.jsx)(f.$,{variant:"primary",size:"default",onClick:g.onClick,asChild:!!g.href,children:g.href?(0,d.jsx)("a",{href:g.href,children:g.label}):g.label}),h&&(0,d.jsx)(f.$,{variant:"outline",size:"default",onClick:h.onClick,asChild:!!h.href,children:h.href?(0,d.jsx)("a",{href:h.href,children:h.label}):h.label})]})]})}}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[40,8208,7519,5711,7028,8741,5237,3088,6802,1774,5504,6546,2567,891,2025,3987,71,2375,2594,4271,9114,4866,1314,9291,5517,5166,1162,9850,5069,5122,6285,9752,6857,2924,3893,902,6065,877],()=>b(b.s=45011));module.exports=c})();