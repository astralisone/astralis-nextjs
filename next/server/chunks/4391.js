"use strict";exports.id=4391,exports.ids=[4391],exports.modules={54391:(a,b,c)=>{c.d(b,{verifyWebhookSignature:()=>f});var d=c(55511),e=c.n(d);function f(a){let{secret:b,signature:c,payload:d,algorithm:f="sha256",allowUnprefixed:g=!0}=a;if(!b)return{isValid:!1,error:"Webhook secret is required"};if(!c)return{isValid:!1,error:"Webhook signature is required"};if(!d)return{isValid:!1,error:"Webhook payload is required"};try{let{version:a,hexSignature:h}=function(a,b,c){let d=a.trim(),e=d.match(/^(sha256|sha512)=([a-fA-F0-9]+)$/);return e?{version:e[1],hexSignature:e[2].toLowerCase()}:c&&/^[a-fA-F0-9]+$/.test(d)?{version:b,hexSignature:d.toLowerCase()}:{version:b,hexSignature:null}}(c,f,g);if(!h)return{isValid:!1,error:`Invalid signature format. Expected "${f}=<hex>" or raw hex string`};let i="string"==typeof d?d:d.toString("utf-8"),j=e().createHmac(a,b).update(i,"utf-8").digest("hex"),k=function(a,b){let c=Buffer.from(a,"hex"),d=Buffer.from(b,"hex");if(c.length!==d.length){let a=Buffer.alloc(c.length);try{e().timingSafeEqual(c,a)}catch{}return!1}try{return e().timingSafeEqual(c,d)}catch{return!1}}(j,h);return{isValid:k,algorithm:a,error:k?void 0:"Signature verification failed"}}catch(b){let a=b instanceof Error?b.message:String(b);return{isValid:!1,error:`Signature verification error: ${a}`}}}}};