(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4610],{6:(e,s,t)=>{Promise.resolve().then(t.bind(t,11965))},3998:(e,s,t)=>{"use strict";t.d(s,{$:()=>o});var a=t(95155),l=t(12115),r=t(32467),i=t(83101),n=t(64269);let c=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-semibold transition-all duration-150 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-astralis-blue focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{primary:"bg-astralis-blue text-white shadow-md hover:bg-[#245a92] hover:shadow-lg hover:scale-105 dark:bg-astralis-blue dark:hover:bg-[#245a92]",secondary:"border-2 border-astralis-blue text-astralis-blue hover:bg-astralis-blue hover:text-white shadow-sm hover:shadow-md dark:border-astralis-blue dark:text-astralis-blue dark:hover:bg-astralis-blue dark:hover:text-white",destructive:"bg-error text-white shadow-sm hover:bg-error/90 hover:shadow-md dark:bg-error dark:hover:bg-error/90",outline:"border-2 border-slate-300 bg-white text-slate-700 hover:bg-slate-100 hover:border-slate-400 dark:border-slate-600 dark:bg-slate-800 dark:text-slate-200 dark:hover:bg-slate-700 dark:hover:border-slate-500",ghost:"text-slate-700 hover:bg-slate-100 dark:text-slate-200 dark:hover:bg-slate-800",link:"text-astralis-blue underline-offset-4 hover:underline dark:text-astralis-blue"},size:{default:"px-6 py-3 text-base",sm:"px-4 py-2 text-sm",lg:"px-8 py-4 text-lg",icon:"p-3"}},defaultVariants:{variant:"primary",size:"default"}}),o=l.forwardRef((e,s)=>{let{className:t,variant:l,size:i,asChild:o=!1,...d}=e,m=o?r.DX:"button";return(0,a.jsx)(m,{className:(0,n.cn)(c({variant:l,size:i,className:t})),ref:s,...d})});o.displayName="Button"},11647:(e,s,t)=>{"use strict";t.d(s,{E:()=>i});var a=t(95155),l=t(64269);let r={default:"bg-slate-100 text-slate-700",primary:"bg-astralis-blue/10 text-astralis-blue",secondary:"bg-slate-200 text-slate-800",success:"bg-green-100 text-green-700",warning:"bg-orange-100 text-orange-700",error:"bg-red-100 text-red-700"};function i(e){let{children:s,className:t,variant:i="default",title:n}=e;return(0,a.jsx)("span",{className:(0,l.cn)("inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",r[i],t),title:n,children:s})}},11965:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>ec});var a=t(95155),l=t(12115),r=t(73683),i=t(12108),n=t(24033),c=t(37586),o=t(21786),d=t(30940),m=t(91456),x=t(86651),u=t(63581),h=t(57828),p=t(39867),f=t(71360),g=t(36489),j=t(22454),N=t(99776),b=t(80549);let v={all:["documents"],lists:()=>[...v.all,"list"],list:(e,s)=>[...v.lists(),e,{filters:s}],details:()=>[...v.all,"detail"],detail:e=>[...v.details(),e],stats:e=>[...v.all,e,"stats"]};var w=t(89715),y=t(35299),k=t(42529),C=t(6132),E=t(65229),A=t(3998),D=t(86948),S=t(18332),F=t(64269);let P=["image/jpeg","image/jpg","image/png","image/webp","application/pdf"];function T(e){let{maxSize:s=0xa00000,acceptedTypes:t=P,maxFiles:r=5,onComplete:i,className:n}=e,[c,d]=(0,l.useState)(!1),[m,x]=(0,l.useState)([]),[u,h]=(0,l.useState)(null),{mutateAsync:p}=function(){var e;let s=(0,N.jE)(),{data:t}=(0,g.useSession)(),a=null==t||null==(e=t.user)?void 0:e.orgId;return(0,b.n)({mutationFn:async e=>{let{file:s,onProgress:t}=e;if(!a)throw Error("No organization ID");let l=new FormData;return l.append("file",s),l.append("orgId",a),new Promise((e,s)=>{let a=new XMLHttpRequest;a.upload.addEventListener("progress",e=>{e.lengthComputable&&t&&t(Math.round(e.loaded/e.total*100))}),a.addEventListener("load",()=>{if(a.status>=200&&a.status<300)try{let s=JSON.parse(a.responseText);e(s)}catch(e){s(Error("Invalid response format"))}else try{let e=JSON.parse(a.responseText);s(Error(e.error||"Upload failed"))}catch(e){s(Error("Upload failed"))}}),a.addEventListener("error",()=>{s(Error("Network error during upload"))}),a.open("POST","/api/documents/upload"),a.send(l)})},onSuccess:()=>{a&&(s.invalidateQueries({queryKey:v.lists()}),s.invalidateQueries({queryKey:v.stats(a)}))}})}(),f=(0,l.useCallback)(e=>t.includes(e.type)?e.size>s?"File size exceeds ".concat(Math.round(s/1024/1024),"MB limit."):null:"File type ".concat(e.type," not supported. Please upload images or PDFs."),[t,s]),j=(0,l.useCallback)(async e=>{if(h(null),e.length>r)return void h("Maximum ".concat(r," files allowed at once."));for(let s of e){let e=f(s);if(e)return void h(e)}x(e.map(e=>({file:e,progress:0,status:"pending"})));for(let s=0;s<e.length;s++){let t=e[s];try{x(e=>e.map((e,t)=>t===s?{...e,status:"uploading"}:e));let e=await p({file:t,onProgress:e=>{x(t=>t.map((t,a)=>a===s?{...t,progress:e}:t))}});x(t=>t.map((t,a)=>a===s?{...t,status:"processing",progress:100,document:e.document}:t)),setTimeout(()=>{x(e=>e.map((e,t)=>t===s?{...e,status:"completed"}:e))},1e3)}catch(e){x(t=>t.map((t,a)=>a===s?{...t,status:"error",error:e instanceof Error?e.message:"Upload failed"}:t))}}i&&setTimeout(()=>{i()},2e3)},[r,f,p,i]),T=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),d(!0)},[]),I=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),d(!1)},[]),M=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation()},[]),z=(0,l.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),d(!1);let s=Array.from(e.dataTransfer.files);s.length>0&&j(s)},[j]),O=(0,l.useCallback)(e=>{let s=Array.from(e.target.files||[]);s.length>0&&j(s),e.target.value=""},[j]),R=(0,l.useCallback)(e=>{x(s=>s.filter((s,t)=>t!==e))},[]),L=(0,l.useCallback)(()=>{x([]),h(null)},[]);return(0,a.jsxs)("div",{className:(0,F.cn)("space-y-4",n),children:[(0,a.jsx)(D.Zp,{className:(0,F.cn)("relative transition-all duration-200",c&&"border-astralis-blue border-2 bg-blue-50"),children:(0,a.jsx)(D.Wu,{className:"p-8",children:(0,a.jsxs)("div",{onDragEnter:T,onDragOver:M,onDragLeave:I,onDrop:z,className:"flex flex-col items-center justify-center space-y-4",children:[(0,a.jsx)("div",{className:(0,F.cn)("flex h-20 w-20 items-center justify-center rounded-full transition-colors",c?"bg-astralis-blue":"bg-slate-100"),children:(0,a.jsx)(o.A,{className:(0,F.cn)("h-10 w-10 transition-colors",c?"text-white":"text-slate-600")})}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-lg font-semibold text-astralis-navy",children:c?"Drop files here":"Drag & drop files here"}),(0,a.jsxs)("p",{className:"text-sm text-slate-500 mt-1",children:["or click to browse (max ",r," files, ",Math.round(s/1024/1024),"MB each)"]})]}),(0,a.jsx)("input",{type:"file",id:"file-upload",className:"hidden",multiple:!0,accept:t.join(","),onChange:O}),(0,a.jsx)("label",{htmlFor:"file-upload",children:(0,a.jsx)(A.$,{variant:"primary",size:"lg",asChild:!0,children:(0,a.jsx)("span",{children:"Select Files"})})}),(0,a.jsx)("p",{className:"text-xs text-slate-400",children:"Supported: JPG, PNG, WebP, PDF"})]})})}),u&&(0,a.jsx)(S.Fc,{variant:"error",showIcon:!0,children:(0,a.jsx)(S.TN,{children:u})}),m.length>0&&(0,a.jsx)(D.Zp,{children:(0,a.jsxs)(D.Wu,{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-astralis-navy",children:["Uploading ",m.length," ",1===m.length?"file":"files"]}),(0,a.jsx)(A.$,{variant:"ghost",size:"sm",onClick:L,children:"Clear All"})]}),(0,a.jsx)("div",{className:"space-y-3",children:m.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-slate-50 rounded-lg",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(w.A,{className:"h-8 w-8 text-astralis-blue"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-astralis-navy truncate",children:e.file.name}),(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:[(e.file.size/1024/1024).toFixed(2)," MB"]}),("uploading"===e.status||"processing"===e.status)&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("div",{className:"h-1.5 bg-slate-200 rounded-full overflow-hidden",children:(0,a.jsx)("div",{className:"h-full bg-astralis-blue transition-all duration-300",style:{width:"".concat(e.progress,"%")}})}),(0,a.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"uploading"===e.status?"Uploading... ".concat(e.progress,"%"):"Processing..."})]}),"error"===e.status&&e.error&&(0,a.jsx)("p",{className:"text-xs text-error mt-1",children:e.error})]}),(0,a.jsxs)("div",{className:"flex-shrink-0",children:["uploading"===e.status&&(0,a.jsx)(y.A,{className:"h-5 w-5 text-astralis-blue animate-spin"}),"processing"===e.status&&(0,a.jsx)(y.A,{className:"h-5 w-5 text-orange-500 animate-spin"}),"completed"===e.status&&(0,a.jsx)(k.A,{className:"h-5 w-5 text-success"}),"error"===e.status&&(0,a.jsx)(C.A,{className:"h-5 w-5 text-error"})]}),("completed"===e.status||"error"===e.status)&&(0,a.jsx)("button",{onClick:()=>R(s),className:"flex-shrink-0 p-1 hover:bg-slate-200 rounded transition-colors","aria-label":"Remove file",children:(0,a.jsx)(E.A,{className:"h-4 w-4 text-slate-500"})})]},"".concat(e.file.name,"-").concat(s)))})]})})]})}var I=t(89559),M=t(11647);let z={PENDING:{variant:"default",label:"Pending",icon:y.A,iconClassName:"animate-spin"},PROCESSING:{variant:"warning",label:"Processing",icon:y.A,iconClassName:"animate-spin"},COMPLETED:{variant:"success",label:"Completed",icon:k.A,iconClassName:""},FAILED:{variant:"error",label:"Failed",icon:C.A,iconClassName:""}};function O(e){var s,t;let{document:l,onView:i,onChat:n,showActions:o=!0,className:d}=e,{mutate:m,isPending:x}=function(){var e;let s=(0,N.jE)(),{data:t}=(0,g.useSession)(),a=null==t||null==(e=t.user)?void 0:e.orgId;return(0,b.n)({mutationFn:async e=>{let s=await fetch("/api/documents/".concat(e,"?orgId=").concat(a),{method:"DELETE"});if(!s.ok)throw Error("Failed to delete document");return s.json()},onSuccess:(e,t)=>{s.removeQueries({queryKey:v.detail(t)}),a&&(s.invalidateQueries({queryKey:v.lists()}),s.invalidateQueries({queryKey:v.stats(a)}))}})}(),{mutate:u,isPending:j}=function(){var e;let s=(0,N.jE)(),{data:t}=(0,g.useSession)(),a=null==t||null==(e=t.user)?void 0:e.orgId;return(0,b.n)({mutationFn:async e=>{let s=await fetch("/api/documents/".concat(e,"/retry"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orgId:a})});if(!s.ok)throw Error("Failed to retry document processing");return s.json()},onSuccess:(e,t)=>{s.invalidateQueries({queryKey:v.detail(t)}),a&&s.invalidateQueries({queryKey:v.lists()})}})}(),y=z[l.status],k=y.icon;return(0,a.jsxs)(D.Zp,{className:(0,F.cn)("overflow-hidden hover",d),hover:!0,children:[(0,a.jsx)(D.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex gap-4",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:l.thumbnailUrl?(0,a.jsx)("img",{src:l.thumbnailUrl,alt:l.originalName,className:"h-20 w-20 rounded-lg object-cover border border-slate-200"}):(0,a.jsx)("div",{className:(0,F.cn)("h-20 w-20 rounded-lg bg-slate-100 flex items-center justify-center",(s=l.mimeType).startsWith("image/")?"text-purple-500":"application/pdf"===s?"text-red-500":"text-slate-500"),children:(0,a.jsx)(w.A,{className:"h-10 w-10"})})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h3",{className:"text-sm font-semibold text-astralis-navy truncate",title:l.originalName,children:l.originalName}),(0,a.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:[(t=l.fileSize)<1024?"".concat(t," B"):t<1048576?"".concat((t/1024).toFixed(1)," KB"):"".concat((t/1024/1024).toFixed(2)," MB")," •"," ",(0,r.GP)(new Date(l.createdAt),"MMM d, yyyy")]})]}),(0,a.jsxs)(M.E,{variant:y.variant,className:"flex items-center gap-1",children:[(0,a.jsx)(k,{className:(0,F.cn)("h-3 w-3",y.iconClassName)}),y.label]})]}),"COMPLETED"===l.status&&null!==l.ocrConfidence&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsxs)("p",{className:"text-xs text-slate-500",children:["OCR Confidence: ",Math.round(100*l.ocrConfidence),"%"]}),(0,a.jsx)("div",{className:"h-1 bg-slate-200 rounded-full overflow-hidden mt-1",children:(0,a.jsx)("div",{className:(0,F.cn)("h-full transition-all",l.ocrConfidence>=.8?"bg-success":l.ocrConfidence>=.6?"bg-warning":"bg-error"),style:{width:"".concat(100*l.ocrConfidence,"%")}})})]}),"FAILED"===l.status&&l.processingError&&(0,a.jsxs)("div",{className:"mt-2 flex items-start gap-2",children:[(0,a.jsx)(C.A,{className:"h-4 w-4 text-error flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-error",children:"Processing Error:"}),(0,a.jsx)("p",{className:"text-xs text-error",children:l.processingError})]})]}),l.metadata&&"object"==typeof l.metadata&&"embeddingError"in l.metadata&&(0,a.jsxs)("div",{className:"mt-2 flex items-start gap-2",children:[(0,a.jsx)(C.A,{className:"h-4 w-4 text-warning flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-warning",children:"Embedding Error:"}),(0,a.jsx)("p",{className:"text-xs text-warning",children:String(l.metadata.embeddingError)})]})]}),l.extractedData&&Object.keys(l.extractedData).length>0&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-slate-600",children:"Extracted Data:"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-1 mt-1",children:[Object.keys(l.extractedData).slice(0,3).map(e=>(0,a.jsx)(M.E,{variant:"secondary",className:"text-xs",children:e},e)),Object.keys(l.extractedData).length>3&&(0,a.jsxs)(M.E,{variant:"secondary",className:"text-xs",children:["+",Object.keys(l.extractedData).length-3," more"]})]})]})]})]})}),o&&(0,a.jsx)(D.wL,{className:"p-4 pt-0",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 w-full",children:[(0,a.jsxs)(A.$,{variant:"outline",size:"sm",onClick:()=>null==i?void 0:i(l),className:"flex-1",disabled:!l.cdnUrl,children:[(0,a.jsx)(h.A,{className:"h-4 w-4 mr-1"}),"View"]}),"COMPLETED"===l.status&&n&&(0,a.jsx)(A.$,{variant:"outline",size:"sm",onClick:()=>n(l.id),title:"Chat with this document",children:(0,a.jsx)(c.A,{className:"h-5 w-5"})}),(0,a.jsx)(A.$,{variant:"outline",size:"sm",onClick:()=>{l.cdnUrl&&window.open(l.cdnUrl,"_blank")},disabled:!l.cdnUrl,children:(0,a.jsx)(p.A,{className:"h-5 w-5"})}),("PENDING"===l.status||"FAILED"===l.status||"COMPLETED"===l.status&&(null===l.ocrConfidence||0===l.ocrConfidence))&&(0,a.jsx)(A.$,{variant:"outline",size:"sm",onClick:()=>{u(l.id)},disabled:j,title:"PENDING"===l.status?"Start processing":"FAILED"===l.status?"Retry processing":"Re-process document",children:(0,a.jsx)(I.A,{className:(0,F.cn)("h-5 w-5",j&&"animate-spin")})}),(0,a.jsx)(A.$,{variant:"destructive",size:"sm",onClick:()=>{confirm('Are you sure you want to delete "'.concat(l.originalName,'"? This action cannot be undone.'))&&m(l.id)},disabled:x,children:(0,a.jsx)(f.A,{className:"h-5 w-5"})})]})})]})}var R=t(71629),L=t(34904),U=t(93141),$=t(70532),q=t(27063);let G=e=>e<1024?"".concat(e," B"):e<1048576?"".concat((e/1024).toFixed(1)," KB"):"".concat((e/1024/1024).toFixed(2)," MB");function B(e){let{document:s,isOpen:t,onClose:i}=e,[n,c]=(0,l.useState)(100),[o,d]=(0,l.useState)(0),[m,x]=(0,l.useState)(!1),[u,f]=(0,l.useState)(null),[g,j]=(0,l.useState)(!1);if((0,l.useEffect)(()=>{(null==s?void 0:s.id)&&t?(j(!0),fetch("/api/documents/".concat(s.id,"/url")).then(e=>e.json()).then(e=>{f(e.url),j(!1)}).catch(e=>{console.error("Failed to fetch signed URL:",e),j(!1)})):f(null)},[null==s?void 0:s.id,t]),!s)return null;let N=s.mimeType.startsWith("image/"),b="application/pdf"===s.mimeType,v=async()=>{try{let e=await fetch("/api/documents/".concat(s.id,"/url")),t=await e.json(),a=window.document.createElement("a");a.href=t.url,a.download=s.originalName,a.click()}catch(e){console.error("Failed to download document:",e)}};return(0,a.jsx)(q.cj,{open:t,onOpenChange:i,children:(0,a.jsxs)(q.h,{side:"right",className:"w-full sm:max-w-2xl lg:max-w-4xl overflow-y-auto",children:[(0,a.jsx)(q.Fm,{children:(0,a.jsx)("div",{className:"flex items-start justify-between",children:(0,a.jsxs)("div",{className:"flex-1 min-w-0 pr-8",children:[(0,a.jsx)(q.qp,{className:"truncate",children:s.originalName}),(0,a.jsxs)(q.Qs,{className:"flex items-center gap-2 mt-1",children:[(0,a.jsx)("span",{children:G(s.fileSize)}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:(0,r.GP)(new Date(s.createdAt),"PPP")})]})]})})}),(0,a.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(A.$,{variant:"outline",size:"sm",onClick:()=>c(e=>Math.max(e-25,50)),children:(0,a.jsx)(R.A,{className:"h-4 w-4"})}),(0,a.jsxs)("span",{className:"text-sm text-slate-600 min-w-[60px] text-center",children:[n,"%"]}),(0,a.jsx)(A.$,{variant:"outline",size:"sm",onClick:()=>c(e=>Math.min(e+25,200)),children:(0,a.jsx)(L.A,{className:"h-4 w-4"})}),N&&(0,a.jsx)(A.$,{variant:"outline",size:"sm",onClick:()=>d(e=>(e+90)%360),children:(0,a.jsx)(U.A,{className:"h-4 w-4"})}),(0,a.jsx)(A.$,{variant:"ghost",size:"sm",onClick:()=>{c(100),d(0)},children:"Reset"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[s.ocrText&&N&&(0,a.jsx)(A.$,{variant:m?"primary":"outline",size:"sm",onClick:()=>x(e=>!e),children:m?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)($.A,{className:"h-4 w-4 mr-1"}),"Hide OCR"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.A,{className:"h-4 w-4 mr-1"}),"Show OCR"]})}),(0,a.jsxs)(A.$,{variant:"outline",size:"sm",onClick:v,children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-1"}),"Download"]})]})]}),(0,a.jsx)("div",{className:"relative bg-slate-100 rounded-lg overflow-hidden min-h-[500px] flex items-center justify-center p-4",children:u?(0,a.jsxs)(a.Fragment,{children:[N&&(0,a.jsx)("img",{src:u,alt:s.originalName,className:"max-w-full h-auto transition-transform",style:{transform:"scale(".concat(n/100,") rotate(").concat(o,"deg)")}}),b&&(0,a.jsx)("iframe",{src:u,className:"w-full h-[600px] border-0",title:s.originalName}),!N&&!b&&(0,a.jsxs)("div",{className:"text-center text-slate-500",children:[(0,a.jsx)(w.A,{className:"h-16 w-16 mx-auto mb-4"}),(0,a.jsx)("p",{children:"Preview not available for this file type"}),(0,a.jsx)(A.$,{variant:"primary",size:"lg",className:"mt-4",onClick:v,children:"Download to View"})]})]}):(0,a.jsxs)("div",{className:"text-center text-slate-500",children:[(0,a.jsx)(w.A,{className:"h-16 w-16 mx-auto mb-4"}),(0,a.jsx)("p",{children:"Document not available"})]})}),m&&s.ocrText&&(0,a.jsxs)("div",{className:"p-4 bg-white border border-slate-200 rounded-lg",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-astralis-navy mb-2 flex items-center gap-2",children:[(0,a.jsx)(w.A,{className:"h-4 w-4"}),"Extracted Text (OCR)",s.ocrConfidence&&(0,a.jsxs)(M.E,{variant:"secondary",className:"ml-auto",children:[Math.round(100*s.ocrConfidence),"% confidence"]})]}),(0,a.jsx)("div",{className:"text-sm text-slate-600 whitespace-pre-wrap max-h-60 overflow-y-auto",children:s.ocrText})]}),s.extractedData&&Object.keys(s.extractedData).length>0&&(0,a.jsxs)("div",{className:"p-4 bg-white border border-slate-200 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-astralis-navy mb-3",children:"Extracted Structured Data"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-3",children:Object.entries(s.extractedData).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"text-xs text-slate-500 uppercase tracking-wide",children:s.replace(/([A-Z])/g," $1").trim()}),(0,a.jsx)("p",{className:"text-sm text-astralis-navy font-medium",children:"object"==typeof t?JSON.stringify(t):String(t)})]},s)})})]}),(0,a.jsxs)("div",{className:"p-4 bg-slate-50 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-astralis-navy mb-3",children:"Document Information"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-500",children:"File Name"}),(0,a.jsx)("p",{className:"text-astralis-navy font-medium break-all",children:s.fileName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-500",children:"File Size"}),(0,a.jsx)("p",{className:"text-astralis-navy font-medium",children:G(s.fileSize)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-500",children:"MIME Type"}),(0,a.jsx)("p",{className:"text-astralis-navy font-medium",children:s.mimeType})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-500",children:"Status"}),(0,a.jsx)(M.E,{variant:"COMPLETED"===s.status?"success":"FAILED"===s.status?"error":"warning",children:s.status})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-500",children:"Uploaded"}),(0,a.jsx)("p",{className:"text-astralis-navy font-medium",children:(0,r.GP)(new Date(s.createdAt),"PPpp")})]}),s.processedAt&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-slate-500",children:"Processed"}),(0,a.jsx)("p",{className:"text-astralis-navy font-medium",children:(0,r.GP)(new Date(s.processedAt),"PPpp")})]})]}),s.processingError&&(0,a.jsxs)("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-error mb-1",children:"Processing Error"}),(0,a.jsx)("p",{className:"text-sm text-red-700",children:s.processingError})]})]})]})]})})}var _=t(18085),Z=t(31120),K=t(16083);let W=K.bL,V=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(K.q7,{ref:s,className:(0,F.cn)("border-b border-slate-300",t),...l})});V.displayName="AccordionItem";let Q=l.forwardRef((e,s)=>{let{className:t,children:l,...r}=e;return(0,a.jsx)(K.Y9,{className:"flex",children:(0,a.jsxs)(K.l9,{ref:s,className:(0,F.cn)("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline text-slate-900 dark:text-white [&[data-state=open]>svg]:rotate-180",t),...r,children:[l,(0,a.jsx)(n.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200 text-slate-500"})]})})});Q.displayName=K.l9.displayName;let J=l.forwardRef((e,s)=>{let{className:t,children:l,...r}=e;return(0,a.jsx)(K.UC,{ref:s,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:(0,a.jsx)("div",{className:(0,F.cn)("pb-4 pt-0",t),children:l})})});J.displayName=K.UC.displayName;class H extends Error{constructor(e,s,t){super(e),this.status=s,this.details=t,this.name="ChatAPIError"}}async function X(e){let s=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)}),t=await s.json();if(!s.ok)throw new H(t.message||"Failed to send message",s.status,t.details);return t.data}async function Y(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2?arguments[2]:void 0,a=new URLSearchParams({limit:e.toString(),offset:s.toString()});t&&a.set("documentId",t);let l=await fetch("/api/chat?".concat(a),{method:"GET",credentials:"include"}),r=await l.json();if(!l.ok)throw new H(r.message||"Failed to list chats",l.status,r.details);return r.data}async function ee(e){let s=await fetch("/api/chat/".concat(e),{method:"GET",credentials:"include"}),t=await s.json();if(!s.ok)throw new H(t.message||"Failed to get chat",s.status,t.details);return t.data}async function es(e){let s=await fetch("/api/chat/".concat(e),{method:"DELETE",credentials:"include"}),t=await s.json();if(!s.ok)throw new H(t.message||"Failed to delete chat",s.status,t.details)}function et(e){let{documentId:s,orgId:t,userId:r,chatId:i,className:n}=e,[c,o]=(0,l.useState)([]),[d,m]=(0,l.useState)(""),[x,u]=(0,l.useState)(i),[h,p]=(0,l.useState)(null),f=(0,l.useRef)(null),g=(0,l.useRef)(null),{sendMessage:j,fetchChat:N,loading:b,error:v}=function(){let[e,s]=l.useState(!1),[t,a]=l.useState(null);return{sendMessage:async e=>{s(!0),a(null);try{return await X(e)}catch(s){let e=s instanceof H?s:new H("Unknown error",500);throw a(e),e}finally{s(!1)}},fetchChats:async(e,t,l)=>{s(!0),a(null);try{return await Y(e,t,l)}catch(s){let e=s instanceof H?s:new H("Unknown error",500);throw a(e),e}finally{s(!1)}},fetchChat:async e=>{s(!0),a(null);try{return await ee(e)}catch(s){let e=s instanceof H?s:new H("Unknown error",500);throw a(e),e}finally{s(!1)}},removeChat:async e=>{s(!0),a(null);try{await es(e)}catch(s){let e=s instanceof H?s:new H("Unknown error",500);throw a(e),e}finally{s(!1)}},loading:e,error:t}}();(0,l.useEffect)(()=>{i&&(async()=>{try{let e=await N(i);o(e.messages.map((e,s)=>({...e,id:"".concat(i,"-").concat(s)})))}catch(e){p(e instanceof H?e.message:"Failed to load chat history")}})()},[i,N]),(0,l.useEffect)(()=>{var e;null==(e=f.current)||e.scrollIntoView({behavior:"smooth"})},[c]);let k=async e=>{if(e.preventDefault(),!d.trim()||b)return;let t={id:"user-".concat(Date.now()),role:"user",content:d.trim(),timestamp:new Date().toISOString()};o(e=>[...e,t]),m(""),g.current&&(g.current.style.height="auto");try{let e=await j({chatId:x,documentId:s,message:t.content});!x&&e.chatId&&u(e.chatId);let a={id:"assistant-".concat(Date.now()),role:"assistant",content:e.message,timestamp:new Date().toISOString(),sources:e.sources};o(e=>[...e,a])}catch(e){console.error("Failed to send message:",e)}};return(0,a.jsxs)("div",{className:(0,F.cn)("flex flex-col h-full bg-white rounded-lg border border-slate-300",n),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-slate-300 bg-slate-50",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(w.A,{className:"h-5 w-5 text-astralis-blue"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-astralis-navy",children:s?"Document Chat":"All Documents Chat"})]}),x&&(0,a.jsx)(M.E,{variant:"primary",className:"text-xs",children:"Active Chat"})]}),h&&(0,a.jsx)("div",{className:"px-6 pt-4",children:(0,a.jsx)(S.Fc,{variant:"error",showIcon:!0,children:(0,a.jsx)(S.TN,{children:h})})}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto px-6 py-4 space-y-4",children:[0===c.length&&!b&&(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center py-12",children:[(0,a.jsx)(w.A,{className:"h-16 w-16 text-slate-300 mb-4"}),(0,a.jsx)("h4",{className:"text-lg font-semibold text-slate-700 mb-2",children:"Start a Conversation"}),(0,a.jsxs)("p",{className:"text-sm text-slate-500 max-w-md",children:["Ask questions about ",s?"this document":"your documents"," and get AI-powered answers with source citations."]})]}),c.map(e=>(0,a.jsx)("div",{className:(0,F.cn)("flex gap-3","user"===e.role?"justify-end":"justify-start"),children:(0,a.jsxs)("div",{className:(0,F.cn)("flex flex-col max-w-[80%] gap-2","user"===e.role?"items-end":"items-start"),children:[(0,a.jsx)(D.Zp,{variant:"default",className:(0,F.cn)("px-4 py-3","user"===e.role?"bg-astralis-blue text-white border-astralis-blue":"bg-white border-slate-300"),children:(0,a.jsx)("p",{className:(0,F.cn)("text-sm leading-relaxed whitespace-pre-wrap","user"===e.role?"text-white":"text-slate-900"),children:e.content})}),(0,a.jsx)("span",{className:"text-xs text-slate-500",children:new Date(e.timestamp).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}),"assistant"===e.role&&e.sources&&e.sources.length>0&&(0,a.jsx)("div",{className:"w-full",children:(0,a.jsx)(W,{type:"single",collapsible:!0,className:"w-full",children:(0,a.jsxs)(V,{value:"sources",className:"border-0",children:[(0,a.jsx)(Q,{className:"py-2 hover:no-underline",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(w.A,{className:"h-3.5 w-3.5 text-astralis-blue"}),(0,a.jsxs)("span",{className:"text-xs font-semibold text-slate-700",children:["Sources (",e.sources.length,")"]})]})}),(0,a.jsx)(J,{className:"pt-2",children:(0,a.jsx)("div",{className:"space-y-2",children:e.sources.map((e,s)=>(0,a.jsxs)(D.Zp,{variant:"bordered",className:"p-3 bg-slate-50",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(w.A,{className:"h-3.5 w-3.5 text-astralis-blue flex-shrink-0"}),(0,a.jsx)("p",{className:"text-xs font-medium text-slate-900",children:e.documentName})]}),(0,a.jsxs)(M.E,{variant:"default",className:"text-xs",children:[Math.round(100*e.similarity),"% match"]})]}),(0,a.jsx)("p",{className:"text-xs text-slate-600 line-clamp-2",children:e.content})]},"".concat(e.documentId,"-").concat(e.chunkIndex)))})})]})})})]})},e.id)),b&&(0,a.jsx)("div",{className:"flex justify-start",children:(0,a.jsx)(D.Zp,{variant:"default",className:"px-4 py-3 bg-slate-50 border-slate-300",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(y.A,{size:"25",className:"text-astralis-blue animate-spin "}),(0,a.jsx)("p",{className:"text-sm text-slate-600 font-medium",children:"Thinking..."})]})})}),v&&(0,a.jsx)(S.Fc,{variant:"error",showIcon:!0,children:(0,a.jsxs)(S.TN,{children:[(0,a.jsx)("strong",{children:"Error:"})," ",v.message,v.details&&(0,a.jsx)("p",{className:"mt-1 text-xs",children:JSON.stringify(v.details)})]})}),(0,a.jsx)("div",{ref:f})]}),(0,a.jsxs)("div",{className:"px-6 py-4 border-t border-slate-300 bg-slate-50",children:[(0,a.jsxs)("form",{onSubmit:k,className:"flex gap-2",children:[(0,a.jsx)(Z.T,{ref:g,value:d,onChange:e=>{m(e.target.value);let s=e.target;s.style.height="auto",s.style.height="".concat(Math.min(s.scrollHeight,200),"px")},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),k(e))},placeholder:"Ask a question about the document...",disabled:b,className:"resize-none min-h-[44px] max-h-[200px]",rows:1}),(0,a.jsx)(A.$,{type:"submit",variant:"primary",size:"icon",disabled:!d.trim()||b,className:"flex-shrink-0",children:b?(0,a.jsx)(y.A,{className:"h-4 w-4 animate-spin"}):(0,a.jsx)(_.A,{className:"h-4 w-4"})})]}),(0,a.jsx)("p",{className:"text-xs text-slate-500 mt-2",children:"Press Enter to send, Shift+Enter for new line"})]})]})}var ea=t(86624),el=t(27500),er=t(62020),ei=t(65142);let en={PENDING:"default",PROCESSING:"warning",COMPLETED:"success",FAILED:"error"};function ec(){let{data:e}=(0,g.useSession)(),[s,t]=(0,l.useState)(null),[N,b]=(0,l.useState)(!1),[w,y]=(0,l.useState)(!1),[k,C]=(0,l.useState)(!1),[E,S]=(0,l.useState)(),[F,P]=(0,l.useState)(""),[I,z]=(0,l.useState)(),[R,L]=(0,l.useState)(),[U,$]=(0,l.useState)(1),[G,_]=(0,l.useState)("table"),[Z,K]=(0,l.useState)("createdAt"),[W,V]=(0,l.useState)("desc"),{data:Q,isLoading:J,error:H}=function(e){var s;let{data:t}=(0,g.useSession)(),a=null==t||null==(s=t.user)?void 0:s.orgId,l=new URLSearchParams({orgId:a||"",...(null==e?void 0:e.status)&&{status:e.status},...(null==e?void 0:e.mimeType)&&{mimeType:e.mimeType},...(null==e?void 0:e.uploadedBy)&&{uploadedBy:e.uploadedBy},...(null==e?void 0:e.startDate)&&{startDate:e.startDate},...(null==e?void 0:e.endDate)&&{endDate:e.endDate},...(null==e?void 0:e.search)&&{search:e.search},...(null==e?void 0:e.limit)&&{limit:e.limit.toString()},...(null==e?void 0:e.offset)&&{offset:e.offset.toString()}});return(0,j.I)({queryKey:a?v.list(a,e):["documents"],queryFn:async()=>{if(!a)throw Error("No organization ID");let e=await fetch("/api/documents?".concat(l));if(!e.ok)throw Error("Failed to fetch documents");let s=await e.json();return{documents:s.documents,total:s.pagination.total,hasMore:s.pagination.hasMore}},enabled:!!a,staleTime:3e4,refetchInterval:e=>{let s=e.state.data;return!!((null==s?void 0:s.documents)&&s.documents.some(e=>"PENDING"===e.status||"PROCESSING"===e.status))&&5e3}})}({status:I,mimeType:R,search:F||void 0,limit:12,offset:(U-1)*12}),{data:X}=function(){var e;let{data:s}=(0,g.useSession)(),t=null==s||null==(e=s.user)?void 0:e.orgId;return(0,j.I)({queryKey:t?v.stats(t):["document-stats"],queryFn:async()=>{if(!t)throw Error("No organization ID");let e=await fetch("/api/documents/stats?orgId=".concat(t));if(!e.ok)throw Error("Failed to fetch document stats");return(await e.json()).stats},enabled:!!t,staleTime:6e4,refetchInterval:e=>{let s=e.state.data;return!!s&&(s.pending>0||s.processing>0)&&5e3}})}(),Y=(null==Q?void 0:Q.documents)||[],ee=(null==Q?void 0:Q.total)||0,es=(null==Q?void 0:Q.hasMore)||!1,ec=(0,l.useMemo)(()=>[...Y].sort((e,s)=>{let t=0;switch(Z){case"name":t=e.originalName.localeCompare(s.originalName);break;case"type":t=e.mimeType.localeCompare(s.mimeType);break;case"size":t=e.fileSize-s.fileSize;break;case"status":t=e.status.localeCompare(s.status);break;case"createdAt":t=new Date(e.createdAt).getTime()-new Date(s.createdAt).getTime();break;default:t=0}return"asc"===W?t:-t}),[Y,Z,W]),eo=e=>{Z===e?V("asc"===W?"desc":"asc"):(K(e),V("asc"))},ed=e=>Z!==e?(0,a.jsx)(i.A,{className:"h-4 w-4 text-slate-300"}):"asc"===W?(0,a.jsx)(i.A,{className:"h-4 w-4 text-astralis-blue"}):(0,a.jsx)(n.A,{className:"h-4 w-4 text-astralis-blue"}),em=e=>{t(e)},ex=e=>{S(e),C(!0)},eu=()=>{z(void 0),L(void 0),P(""),$(1)},eh=I||R||F;return(0,a.jsxs)(ea.L,{children:[(0,a.jsx)(el.z,{title:"Documents",description:"Manage and view all uploaded documents with OCR processing",actions:(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)(A.$,{variant:"outline",className:"gap-2",onClick:()=>{S(void 0),C(!0)},children:[(0,a.jsx)(c.A,{className:"h-5 w-5"}),"Chat with Documents"]}),(0,a.jsxs)(A.$,{variant:"primary",className:"gap-2",onClick:()=>b(!0),children:[(0,a.jsx)(o.A,{className:"h-5 w-5"}),"Upload Documents"]})]})}),X&&(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:[(0,a.jsx)(D.Zp,{children:(0,a.jsxs)(D.Wu,{className:"p-4",children:[(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Total Documents"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-astralis-navy",children:X.total})]})}),(0,a.jsx)(D.Zp,{children:(0,a.jsxs)(D.Wu,{className:"p-4",children:[(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Pending"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-slate-600",children:X.pending})]})}),(0,a.jsx)(D.Zp,{children:(0,a.jsxs)(D.Wu,{className:"p-4",children:[(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Processing"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-warning",children:X.processing})]})}),(0,a.jsx)(D.Zp,{children:(0,a.jsxs)(D.Wu,{className:"p-4",children:[(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Completed"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-success",children:X.completed})]})}),(0,a.jsx)(D.Zp,{children:(0,a.jsxs)(D.Wu,{className:"p-4",children:[(0,a.jsx)("p",{className:"text-sm text-slate-500",children:"Failed"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-error",children:X.failed})]})})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1 mb-4 border-b border-slate-200",children:[(0,a.jsxs)("button",{onClick:()=>_("table"),className:"flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors border-b-2 -mb-px ".concat("table"===G?"border-astralis-blue text-astralis-blue":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"),children:[(0,a.jsx)(d.A,{className:"h-5 w-5"}),"Table View"]}),(0,a.jsxs)("button",{onClick:()=>_("grid"),className:"flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors border-b-2 -mb-px ".concat("grid"===G?"border-astralis-blue text-astralis-blue":"border-transparent text-slate-500 hover:text-slate-700 hover:border-slate-300"),children:[(0,a.jsx)(m.A,{className:"h-5 w-5"}),"Grid View"]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 mb-6",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)(x.A,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-slate-400"}),(0,a.jsx)(ei.p,{type:"search",placeholder:"Search documents...",value:F,onChange:e=>P(e.target.value),className:"pl-12"})]}),(0,a.jsxs)(A.$,{variant:"outline",onClick:()=>y(!0),className:"flex items-center gap-2",children:[(0,a.jsx)(u.A,{className:"h-5 w-5"}),"Filters",eh&&(0,a.jsx)(M.E,{variant:"primary",className:"ml-1",children:[I,R,F].filter(Boolean).length})]}),eh&&(0,a.jsx)(A.$,{variant:"ghost",onClick:eu,children:"Clear"})]}),J&&(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-slate-500",children:"Loading documents..."})}),H&&(0,a.jsx)(D.Zp,{variant:"bordered",className:"p-6",children:(0,a.jsx)("p",{className:"text-error text-center",children:"Failed to load documents. Please try again."})}),!J&&!H&&0===Y.length&&(0,a.jsx)(er.p,{icon:o.A,title:"No documents found",description:eh?"Try adjusting your filters or search query":"Upload your first document to get started",primaryAction:eh?void 0:{label:"Upload Documents",onClick:()=>b(!0)}}),!J&&!H&&Y.length>0&&(0,a.jsxs)(a.Fragment,{children:["table"===G&&(0,a.jsx)(D.Zp,{variant:"default",className:"mb-6",children:(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-100 transition-colors",onClick:()=>eo("name"),children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:["Name",ed("name")]})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-100 transition-colors",onClick:()=>eo("type"),children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:["Type",ed("type")]})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-100 transition-colors",onClick:()=>eo("size"),children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:["Size",ed("size")]})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-100 transition-colors",onClick:()=>eo("status"),children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:["Status",ed("status")]})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-100 transition-colors",onClick:()=>eo("createdAt"),children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:["Uploaded",ed("createdAt")]})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-slate-200",children:ec.map((e,s)=>{var t,l;return(0,a.jsxs)("tr",{className:"hover:bg-slate-100 transition-colors ".concat(s%2==1?"bg-slate-50":""),children:[(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("div",{className:"text-sm font-medium text-astralis-navy truncate max-w-[250px]",title:e.originalName,children:e.originalName})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)(M.E,{variant:"default",children:(t=e.mimeType).startsWith("image/")?t.replace("image/","").toUpperCase():"application/pdf"===t?"PDF":t.includes("word")?"DOC":t.includes("spreadsheet")||t.includes("excel")?"XLS":(null==(l=t.split("/").pop())?void 0:l.toUpperCase())||"FILE"})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-500",children:function(e){if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]}(e.fileSize)}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)(M.E,{variant:en[e.status],children:e.status})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-slate-500",children:(0,r.GP)(new Date(e.createdAt),"MMM d, yyyy")}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>em(e),className:"p-2 text-slate-600 hover:text-astralis-blue hover:bg-slate-100 rounded-md transition-colors",title:"View document",children:(0,a.jsx)(h.A,{className:"h-5 w-5"})}),(0,a.jsx)("button",{onClick:()=>{e.cdnUrl&&window.open(e.cdnUrl,"_blank")},className:"p-2 text-slate-600 hover:text-astralis-blue hover:bg-slate-100 rounded-md transition-colors",title:"Download document",disabled:!e.cdnUrl,children:(0,a.jsx)(p.A,{className:"h-5 w-5"})}),(0,a.jsx)("button",{onClick:()=>{console.log("Delete requested for document:",e.id)},className:"p-2 text-slate-600 hover:text-error hover:bg-red-50 rounded-md transition-colors",title:"Delete document",children:(0,a.jsx)(f.A,{className:"h-5 w-5"})})]})})]},e.id)})})]})})}),"grid"===G&&(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:Y.map(e=>(0,a.jsx)(O,{document:e,onView:em,onChat:ex},e.id))}),ee>12&&(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("p",{className:"text-sm text-slate-600",children:["Showing ",(U-1)*12+1," to"," ",Math.min(12*U,ee)," of ",ee," ","documents"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(A.$,{variant:"outline",onClick:()=>$(e=>Math.max(e-1,1)),disabled:1===U,children:"Previous"}),(0,a.jsx)(A.$,{variant:"outline",onClick:()=>$(e=>e+1),disabled:!es,children:"Next"})]})]})]}),(0,a.jsx)(q.cj,{open:N,onOpenChange:b,children:(0,a.jsxs)(q.h,{side:"right",className:"w-full sm:max-w-xl overflow-y-auto",children:[(0,a.jsx)(q.Fm,{children:(0,a.jsx)(q.qp,{children:"Upload Documents"})}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsx)(T,{onComplete:()=>{b(!1)}})})]})}),(0,a.jsx)(q.cj,{open:w,onOpenChange:y,children:(0,a.jsxs)(q.h,{side:"right",className:"w-full sm:max-w-md",children:[(0,a.jsx)(q.Fm,{children:(0,a.jsx)(q.qp,{children:"Filter Documents"})}),(0,a.jsxs)("div",{className:"mt-6 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-astralis-navy mb-2 block",children:"Status"}),(0,a.jsxs)("div",{className:"space-y-2",children:[["PENDING","PROCESSING","COMPLETED","FAILED"].map(e=>(0,a.jsxs)("label",{className:"flex items-center gap-2 p-2 hover:bg-slate-50 rounded cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"status",checked:I===e,onChange:()=>z(e),className:"text-astralis-blue focus:ring-astralis-blue"}),(0,a.jsx)("span",{className:"text-sm text-slate-700",children:e})]},e)),(0,a.jsxs)("label",{className:"flex items-center gap-2 p-2 hover:bg-slate-50 rounded cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"status",checked:!I,onChange:()=>z(void 0),className:"text-astralis-blue focus:ring-astralis-blue"}),(0,a.jsx)("span",{className:"text-sm text-slate-700",children:"All"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-astralis-navy mb-2 block",children:"File Type"}),(0,a.jsxs)("div",{className:"space-y-2",children:[[{label:"Images",value:"image/"},{label:"PDFs",value:"application/pdf"}].map(e=>(0,a.jsxs)("label",{className:"flex items-center gap-2 p-2 hover:bg-slate-50 rounded cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"mimeType",checked:R===e.value,onChange:()=>L(e.value),className:"text-astralis-blue focus:ring-astralis-blue"}),(0,a.jsx)("span",{className:"text-sm text-slate-700",children:e.label})]},e.value)),(0,a.jsxs)("label",{className:"flex items-center gap-2 p-2 hover:bg-slate-50 rounded cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"mimeType",checked:!R,onChange:()=>L(void 0),className:"text-astralis-blue focus:ring-astralis-blue"}),(0,a.jsx)("span",{className:"text-sm text-slate-700",children:"All"})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(A.$,{variant:"primary",className:"flex-1",onClick:()=>y(!1),children:"Apply Filters"}),(0,a.jsx)(A.$,{variant:"outline",onClick:eu,children:"Clear"})]})]})]})}),(0,a.jsx)(B,{document:s,isOpen:!!s,onClose:()=>{t(null)}}),(null==e?void 0:e.user)&&(0,a.jsx)(q.cj,{open:k,onOpenChange:C,children:(0,a.jsxs)(q.h,{side:"right",className:"w-full sm:max-w-2xl overflow-hidden flex flex-col",children:[(0,a.jsx)(q.Fm,{children:(0,a.jsx)(q.qp,{children:E?"Chat with Document":"Chat with Documents"})}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden mt-6",children:(0,a.jsx)(et,{documentId:E,orgId:e.user.orgId,userId:e.user.id,className:"h-full"})})]})})]})}},18332:(e,s,t)=>{"use strict";t.d(s,{Fc:()=>u,TN:()=>p,XL:()=>h});var a=t(95155),l=t(12115),r=t(83101),i=t(23327),n=t(61362),c=t(78874),o=t(6132),d=t(64269);let m=(0,r.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-white border-slate-300 text-slate-900",success:"border-green-500/50 bg-green-50 text-green-900 [&>svg]:text-green-600",error:"border-red-500/50 bg-red-50 text-red-900 [&>svg]:text-red-600",warning:"border-yellow-500/50 bg-yellow-50 text-yellow-900 [&>svg]:text-yellow-600",info:"border-blue-500/50 bg-blue-50 text-blue-900 [&>svg]:text-astralis-blue"}},defaultVariants:{variant:"default"}}),x={default:i.A,success:n.A,error:c.A,warning:o.A,info:i.A},u=l.forwardRef((e,s)=>{let{className:t,variant:l="default",showIcon:r=!1,children:i,...n}=e,c=x[l||"default"];return(0,a.jsxs)("div",{ref:s,role:"alert",className:(0,d.cn)(m({variant:l}),t),...n,children:[r&&(0,a.jsx)(c,{className:"h-4 w-4"}),i]})});u.displayName="Alert";let h=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("h5",{ref:s,className:(0,d.cn)("mb-1 font-semibold leading-none tracking-tight",t),...l})});h.displayName="AlertTitle";let p=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,d.cn)("text-sm [&_p]:leading-relaxed",t),...l})});p.displayName="AlertDescription"},27063:(e,s,t)=>{"use strict";t.d(s,{CG:()=>d,Fm:()=>p,Qs:()=>g,cj:()=>o,h:()=>h,qp:()=>f});var a=t(95155),l=t(12115),r=t(93409),i=t(83101),n=t(65229),c=t(64269);let o=r.bL,d=r.l9;r.bm;let m=r.ZL,x=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.hJ,{className:(0,c.cn)("fixed inset-0 z-50 bg-black/50 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...l,ref:s})});x.displayName=r.hJ.displayName;let u=(0,i.F)("fixed z-50 gap-4 bg-white p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-300",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),h=l.forwardRef((e,s)=>{let{side:t="right",className:l,children:i,...o}=e;return(0,a.jsxs)(m,{children:[(0,a.jsx)(x,{}),(0,a.jsxs)(r.UC,{ref:s,className:(0,c.cn)(u({side:t}),l),...o,children:[i,(0,a.jsxs)(r.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-white transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-astralis-blue focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-slate-100",children:[(0,a.jsx)(n.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});h.displayName=r.UC.displayName;let p=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...t})};p.displayName="SheetHeader";let f=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.hE,{ref:s,className:(0,c.cn)("text-lg font-semibold text-astralis-navy",t),...l})});f.displayName=r.hE.displayName;let g=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.VY,{ref:s,className:(0,c.cn)("text-sm text-slate-600",t),...l})});g.displayName=r.VY.displayName},27500:(e,s,t)=>{"use strict";t.d(s,{z:()=>r});var a=t(95155);t(12115);var l=t(64269);function r(e){let{title:s,description:t,actions:r,className:i}=e;return(0,a.jsxs)("div",{className:(0,l.cn)("flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",i),children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold tracking-tight text-astralis-navy sm:text-3xl",children:s}),t&&(0,a.jsx)("p",{className:"text-sm text-slate-600 sm:text-base",children:t})]}),r&&(0,a.jsx)("div",{className:"flex items-center gap-2 shrink-0",children:r})]})}},31120:(e,s,t)=>{"use strict";t.d(s,{T:()=>i});var a=t(95155),l=t(12115),r=t(64269);let i=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-500","dark:bg-slate-800 dark:border-slate-700 dark:text-white dark:placeholder:text-slate-400","transition-all duration-150 ease-out","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-astralis-blue focus-visible:ring-offset-0","disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...l})});i.displayName="Textarea"},62020:(e,s,t)=>{"use strict";t.d(s,{p:()=>i});var a=t(95155);t(12115);var l=t(64269),r=t(3998);function i(e){let{icon:s,title:t,description:i,primaryAction:n,secondaryAction:c,className:o}=e;return(0,a.jsxs)("div",{className:(0,l.cn)("flex flex-col items-center justify-center text-center py-12 px-4",o),children:[s&&(0,a.jsx)("div",{className:"mb-4 inline-flex items-center justify-center w-16 h-16 rounded-full bg-slate-100",children:(0,a.jsx)(s,{className:"w-8 h-8 text-slate-400",strokeWidth:1.5})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-astralis-navy mb-2",children:t}),i&&(0,a.jsx)("p",{className:"text-sm text-slate-600 max-w-md mb-6",children:i}),(n||c)&&(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[n&&(0,a.jsx)(r.$,{variant:"primary",size:"default",onClick:n.onClick,asChild:!!n.href,children:n.href?(0,a.jsx)("a",{href:n.href,children:n.label}):n.label}),c&&(0,a.jsx)(r.$,{variant:"outline",size:"default",onClick:c.onClick,asChild:!!c.href,children:c.href?(0,a.jsx)("a",{href:c.href,children:c.label}):c.label})]})]})}},64269:(e,s,t)=>{"use strict";t.d(s,{cn:()=>r});var a=t(2821),l=t(75889);function r(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,l.QP)((0,a.$)(s))}},65142:(e,s,t)=>{"use strict";t.d(s,{p:()=>i});var a=t(95155),l=t(12115),r=t(64269);let i=l.forwardRef((e,s)=>{let{className:t,type:l,...i}=e;return(0,a.jsx)("input",{type:l,className:(0,r.cn)("flex h-10 w-full rounded-md border border-slate-300 bg-white px-3 py-2 text-sm text-slate-900 placeholder:text-slate-500","dark:bg-slate-800 dark:border-slate-700 dark:text-white dark:placeholder:text-slate-400","transition-all duration-150 ease-out","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-astralis-blue focus-visible:ring-offset-0","disabled:cursor-not-allowed disabled:opacity-50","file:border-0 file:bg-transparent file:text-sm file:font-medium",t),ref:s,...i})});i.displayName="Input"},86624:(e,s,t)=>{"use strict";t.d(s,{L:()=>i});var a=t(95155);t(12115);var l=t(64269);let r={default:"max-w-7xl",full:"max-w-full",narrow:"max-w-5xl"};function i(e){let{children:s,className:t,maxWidth:i="default"}=e;return(0,a.jsx)("div",{className:(0,l.cn)("mx-auto w-full px-4 py-6 sm:px-6 lg:px-8",r[i],t),children:s})}},86948:(e,s,t)=>{"use strict";t.d(s,{BT:()=>o,Wu:()=>d,ZB:()=>c,Zp:()=>i,aR:()=>n,wL:()=>m});var a=t(95155),l=t(12115),r=t(64269);let i=l.forwardRef((e,s)=>{let{className:t,variant:l="default",hover:i=!1,...n}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("rounded-lg bg-white transition-all duration-200 dark:bg-slate-800 dark:border-slate-700",{default:"border border-slate-200 shadow-[0_2px_8px_rgba(0,0,0,0.06)]",bordered:"border-2 border-slate-300",elevated:"shadow-[0_8px_24px_rgba(0,0,0,0.12)]"}[l],i&&"hover:shadow-[0_8px_24px_rgba(0,0,0,0.12)] hover:border-slate-300",t),...n})});i.displayName="Card";let n=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",t),...l})});n.displayName="CardHeader";let c=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("h3",{ref:s,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight text-slate-900 dark:text-white",t),...l})});c.displayName="CardTitle";let o=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("p",{ref:s,className:(0,r.cn)("text-sm text-slate-500 dark:text-slate-400",t),...l})});o.displayName="CardDescription";let d=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("p-6 pt-0",t),...l})});d.displayName="CardContent";let m=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)("div",{ref:s,className:(0,r.cn)("flex items-center p-6 pt-0",t),...l})});m.displayName="CardFooter"}},e=>{e.O(0,[4909,756,9566,6489,317,4141,7802,9948,5969,5193,4628,8296,3432,207,1101,9336,4007,6011,9248,9084,7358],()=>e(e.s=6)),_N_E=e.O()}]);