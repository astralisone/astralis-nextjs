(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2475],{18332:(e,s,t)=>{"use strict";t.d(s,{Fc:()=>p,TN:()=>g,XL:()=>x});var a=t(95155),i=t(12115),n=t(83101),r=t(23327),l=t(61362),d=t(78874),c=t(6132),o=t(64269);let m=(0,n.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-white border-slate-300 text-slate-900",success:"border-green-500/50 bg-green-50 text-green-900 [&>svg]:text-green-600",error:"border-red-500/50 bg-red-50 text-red-900 [&>svg]:text-red-600",warning:"border-yellow-500/50 bg-yellow-50 text-yellow-900 [&>svg]:text-yellow-600",info:"border-blue-500/50 bg-blue-50 text-blue-900 [&>svg]:text-astralis-blue"}},defaultVariants:{variant:"default"}}),u={default:r.A,success:l.A,error:d.A,warning:c.A,info:r.A},p=i.forwardRef((e,s)=>{let{className:t,variant:i="default",showIcon:n=!1,children:r,...l}=e,d=u[i||"default"];return(0,a.jsxs)("div",{ref:s,role:"alert",className:(0,o.cn)(m({variant:i}),t),...l,children:[n&&(0,a.jsx)(d,{className:"h-4 w-4"}),r]})});p.displayName="Alert";let x=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,a.jsx)("h5",{ref:s,className:(0,o.cn)("mb-1 font-semibold leading-none tracking-tight",t),...i})});x.displayName="AlertTitle";let g=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,a.jsx)("div",{ref:s,className:(0,o.cn)("text-sm [&_p]:leading-relaxed",t),...i})});g.displayName="AlertDescription"},37085:(e,s,t)=>{Promise.resolve().then(t.bind(t,71874))},71874:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>O});var a=t(95155),i=t(12115),n=t(52619),r=t.n(n),l=t(36489),d=t(86948),c=t(3998),o=t(6191),m=t(39332),u=t(22544),p=t(33602),x=t(54879),g=t(51834),h=t(65142),j=t(76444),f=t(31120),v=t(18332),N=t(99776),b=t(80549),y=t(37507),w=t(99349);let P=x.Ik({name:x.Yj().min(2,"Name must be at least 2 characters"),description:x.Yj().optional()});function R(e){let{open:s,onOpenChange:t,onSuccess:n}=e,{data:r}=(0,l.useSession)(),d=function(){let e=(0,N.jE)();return(0,b.n)({mutationFn:async e=>{let s=await fetch("/api/pipelines",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw{...await s.json().catch(()=>({})),status:s.status};return s.json()},onSuccess:(s,t)=>{e.invalidateQueries({queryKey:y.fQ.list(t.orgId)})},onError:e=>{let s=(0,w._R)(e);(0,w.vV)(s,"useCreatePipeline")}})}(),[o,m]=(0,i.useState)(null),{register:x,handleSubmit:R,formState:{errors:C},reset:O}=(0,u.mN)({resolver:(0,p.u)(P)}),S=async e=>{var s;if(!(null==r||null==(s=r.user)?void 0:s.orgId))return void m("Organization ID not found. Please sign in again.");m(null);try{await d.mutateAsync({name:e.name,description:e.description,orgId:r.user.orgId}),O(),t(!1),null==n||n()}catch(e){m(e instanceof Error?e.message:"Failed to create pipeline")}},A=()=>{d.isPending||(O(),m(null),t(!1))};return(0,a.jsx)(g.lG,{open:s,onOpenChange:A,children:(0,a.jsxs)(g.Cf,{className:"sm:max-w-[500px]",children:[(0,a.jsx)(g.c7,{children:(0,a.jsx)(g.L3,{children:"Create New Pipeline"})}),(0,a.jsxs)("form",{onSubmit:R(S),className:"space-y-4",children:[o&&(0,a.jsx)(v.Fc,{variant:"error",children:(0,a.jsx)(v.TN,{children:o})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(j.J,{htmlFor:"name",children:["Pipeline Name ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)(h.p,{id:"name",placeholder:"e.g., Sales Pipeline",...x("name"),disabled:d.isPending}),C.name&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:C.name.message})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(j.J,{htmlFor:"description",children:"Description (optional)"}),(0,a.jsx)(f.T,{id:"description",placeholder:"Describe the purpose of this pipeline...",rows:4,...x("description"),disabled:d.isPending}),C.description&&(0,a.jsx)("p",{className:"text-sm text-red-600",children:C.description.message})]}),(0,a.jsxs)(g.Es,{children:[(0,a.jsx)(c.$,{type:"button",variant:"outline",onClick:A,disabled:d.isPending,children:"Cancel"}),(0,a.jsx)(c.$,{type:"submit",variant:"primary",disabled:d.isPending,children:d.isPending?"Creating...":"Create Pipeline"})]})]})]})})}var C=t(64903);function O(){let{data:e}=(0,l.useSession)(),[s,t]=(0,i.useState)(!1),{data:n,isLoading:u,error:p,refetch:x}=(0,C.be)();return e?u?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-astralis-blue"})}):p?(0,a.jsx)("div",{className:"text-center py-12 text-red-600",children:"Failed to load pipelines. Please try again."}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-astralis-navy",children:"Pipelines"}),(0,a.jsx)("p",{className:"text-slate-600 mt-1",children:"Manage your workflow pipelines"})]}),(0,a.jsxs)(c.$,{variant:"primary",className:"gap-2",onClick:()=>t(!0),children:[(0,a.jsx)(o.A,{className:"w-5 h-5"}),"New Pipeline"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[n&&n.length>0&&n.map(e=>{var s,t;let i=(null==(s=e.stages)?void 0:s.reduce((e,s)=>{var t;return e+((null==(t=s._count)?void 0:t.items)||0)},0))||0;return(0,a.jsx)(r(),{href:"/pipelines/".concat(e.id),children:(0,a.jsxs)(d.Zp,{variant:"default",hover:!0,children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-astralis-blue/10 rounded-lg",children:(0,a.jsx)(m.A,{className:"w-5 h-5 text-astralis-blue"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d.ZB,{className:"text-lg",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-slate-500 mt-1",children:[(null==(t=e.stages)?void 0:t.length)||0," stages â€¢ ",i," items"]})]})]})}),e.description&&(0,a.jsx)(d.Wu,{children:(0,a.jsx)("p",{className:"text-sm text-slate-600 line-clamp-2",children:e.description})})]})},e.id)}),(!n||0===n.length)&&(0,a.jsx)("div",{className:"col-span-full",children:(0,a.jsx)(d.Zp,{variant:"default",children:(0,a.jsxs)(d.Wu,{className:"p-12 text-center",children:[(0,a.jsx)(m.A,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-slate-700 mb-2",children:"No pipelines yet"}),(0,a.jsx)("p",{className:"text-slate-500 mb-4",children:"Create your first pipeline to get started"}),(0,a.jsxs)(c.$,{variant:"primary",className:"gap-2",onClick:()=>t(!0),children:[(0,a.jsx)(o.A,{className:" ui-icon w-5 h-5"}),"Create Pipeline"]})]})})})]})]}),(0,a.jsx)(R,{open:s,onOpenChange:t,onSuccess:()=>{x()}})]}):(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsx)("p",{className:"text-slate-600",children:"Please sign in to view pipelines."})})}},99349:(e,s,t)=>{"use strict";function a(e){return e instanceof TypeError?{message:"Network error. Please check your connection.",code:"NETWORK_ERROR"}:e instanceof Response?{message:"Request failed with status ".concat(e.status),status:e.status,code:"HTTP_ERROR"}:e&&"object"==typeof e&&"message"in e?{message:String(e.message),status:"status"in e?Number(e.status):void 0,code:"code"in e?String(e.code):void 0,details:"details"in e?e.details:void 0}:e instanceof Error?{message:e.message,code:"UNKNOWN_ERROR"}:{message:"An unexpected error occurred",code:"UNKNOWN_ERROR"}}function i(e,s){new Date().toISOString(),e.message,e.status,e.code,e.details}t.d(s,{_R:()=>a,vV:()=>i})}},e=>{e.O(0,[4909,2619,9566,6489,317,4741,3602,4141,7802,8312,1955,4628,8296,3432,207,1101,9336,4007,6011,9248,9084,7358],()=>e(e.s=37085)),_N_E=e.O()}]);