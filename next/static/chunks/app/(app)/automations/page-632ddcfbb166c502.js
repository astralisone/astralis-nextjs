(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[584],{33888:(e,s,a)=>{Promise.resolve().then(a.bind(a,45206))},45206:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>O});var t=a(95155),l=a(12115),i=a(20063),c=a(52619),n=a.n(c),r=a(3998),o=a(86948),d=a(65142),x=a(11186),m=a(18332),h=a(20243),u=a(11647),j=a(64269),v=a(59240),g=a(16485),p=a(56154),N=a(79158),f=a(9602),w=a(53511),y=a(85921),A=a(1524),E=a(61362),b=a(26983),C=a(15870),S=a(71360);let T={WEBHOOK:v.A,SCHEDULE:g.A,EVENT:p.A,MANUAL:N.A,API:f.A};function k(e){let{automation:s,onToggle:a,onDelete:i,onExecute:c}=e,[d,x]=(0,l.useState)(!1),m=s.executionCount>0?Math.round(s.successCount/s.executionCount*100):0,h=T[s.triggerType];return(0,t.jsx)(n(),{href:"/automations/".concat(s.id),children:(0,t.jsxs)(o.Zp,{variant:"default",hover:!0,className:(0,j.cn)("cursor-pointer transition-all duration-200",d&&"border-astralis-blue"),onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),children:[(0,t.jsx)(o.aR,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:(0,j.cn)("flex h-10 w-10 items-center justify-center rounded-lg",s.isActive?"bg-astralis-blue/10 text-astralis-blue":"bg-slate-100 text-slate-500"),children:(0,t.jsx)(h,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(o.ZB,{className:"text-lg",children:s.name}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,t.jsx)(u.E,{variant:s.isActive?"success":"default",className:"text-xs",children:s.isActive?"Active":"Inactive"}),(0,t.jsx)(u.E,{variant:"default",className:"text-xs capitalize",children:s.triggerType.toLowerCase()})]})]})]}),(0,t.jsx)("div",{className:"flex items-center gap-1",children:(0,t.jsx)(r.$,{variant:"ghost",size:"icon",onClick:()=>{a&&a(s.id,!s.isActive)},title:s.isActive?"Pause automation":"Activate automation",children:s.isActive?(0,t.jsx)(w.A,{className:"h-4 w-4"}):(0,t.jsx)(y.A,{className:"h-4 w-4"})})})]})}),(0,t.jsxs)(o.Wu,{className:"space-y-4",children:[s.description&&(0,t.jsx)(o.BT,{className:"line-clamp-2",children:s.description}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-3 pt-3 border-t border-slate-200",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs text-slate-500",children:[(0,t.jsx)(A.A,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:"Executions"})]}),(0,t.jsx)("p",{className:"text-lg font-semibold text-astralis-navy",children:s.executionCount})]}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs text-slate-500",children:[(0,t.jsx)(E.A,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:"Success Rate"})]}),(0,t.jsxs)("p",{className:"text-lg font-semibold text-astralis-navy",children:[m,"%"]})]}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs text-slate-500",children:[(0,t.jsx)(b.A,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:"Avg Time"})]}),(0,t.jsx)("p",{className:"text-lg font-semibold text-astralis-navy",children:s.avgExecutionTime?"".concat(Math.round(s.avgExecutionTime/1e3),"s"):"-"})]})]}),s.tags&&s.tags.length>0&&(0,t.jsxs)("div",{className:"flex flex-wrap gap-1 pt-2",children:[s.tags.slice(0,3).map(e=>(0,t.jsx)(u.E,{variant:"secondary",className:"text-xs",children:e},e)),s.tags.length>3&&(0,t.jsxs)(u.E,{variant:"secondary",className:"text-xs",children:["+",s.tags.length-3]})]}),d&&(0,t.jsxs)("div",{className:"flex items-center gap-2 pt-3 border-t border-slate-200",children:[(0,t.jsxs)(r.$,{variant:"primary",size:"sm",onClick:e=>{e.preventDefault(),c&&c(s.id)},className:"flex-1",children:[(0,t.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Execute"]}),(0,t.jsx)(r.$,{variant:"outline",size:"icon",className:"h-9 w-9",onClick:e=>{e.preventDefault(),window.location.href="/automations/".concat(s.id,"/settings")},children:(0,t.jsx)(C.A,{className:"h-5 w-5"})}),(0,t.jsx)(r.$,{variant:"destructive",size:"icon",className:"h-9 w-9",onClick:e=>{e.preventDefault(),i&&confirm('Are you sure you want to delete "'.concat(s.name,'"?'))&&i(s.id)},children:(0,t.jsx)(S.A,{className:"h-5 w-5"})})]}),s.lastExecutedAt&&(0,t.jsxs)("div",{className:"text-xs text-slate-500 pt-2",children:["Last executed"," ",new Date(s.lastExecutedAt).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]})})}var L=a(89559),D=a(6191),F=a(86651);function O(){let e=(0,i.usePathname)(),s=(0,i.useSearchParams)(),[a,c]=(0,l.useState)([]),[u,j]=(0,l.useState)(!0),[v,g]=(0,l.useState)(null),[p,N]=(0,l.useState)(""),[f,w]=(0,l.useState)("all"),[y,A]=(0,l.useState)("all"),E=(0,l.useCallback)(async()=>{try{j(!0);let e=await fetch("/api/automations");if(!e.ok)throw Error("Failed to fetch automations");let s=await e.json();c(s.automations||[])}catch(e){g(e instanceof Error?e.message:"Failed to load automations")}finally{j(!1)}},[]);(0,l.useEffect)(()=>{E()},[e,s,E]);let b=async(e,s)=>{try{if(!(await fetch("/api/automations/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:s})})).ok)throw Error("Failed to toggle automation");c(a=>a.map(a=>a.id===e?{...a,isActive:s}:a))}catch(e){alert(e instanceof Error?e.message:"Failed to toggle automation")}},C=async e=>{try{if(!(await fetch("/api/automations/".concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete automation");c(s=>s.filter(s=>s.id!==e))}catch(e){alert(e instanceof Error?e.message:"Failed to delete automation")}},S=async e=>{try{let s=await fetch("/api/automations/".concat(e,"/execute"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({triggerData:{}})});if(!s.ok)throw Error("Failed to execute automation");await s.json(),alert("Automation executed successfully!"),E()}catch(e){alert(e instanceof Error?e.message:"Failed to execute automation")}},T=a.filter(e=>{var s;let a=""===p||e.name.toLowerCase().includes(p.toLowerCase())||(null==(s=e.description)?void 0:s.toLowerCase().includes(p.toLowerCase())),t="all"===f||"active"===f&&e.isActive||"inactive"===f&&!e.isActive,l="all"===y||e.triggerType===y;return a&&t&&l});return(0,t.jsx)("div",{className:"min-h-screen bg-slate-50 p-6",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-astralis-navy",children:"Automations"}),(0,t.jsx)("p",{className:"text-slate-600 mt-1",children:"Manage your business automation workflows"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)(r.$,{variant:"outline",className:"gap-2",onClick:E,disabled:u,children:[(0,t.jsx)(L.A,{className:"h-5 w-5 ".concat(u?"animate-spin":"")}),"Refresh"]}),(0,t.jsx)(r.$,{variant:"primary",className:"gap-2",asChild:!0,children:(0,t.jsxs)(n(),{href:"/automations/new",children:[(0,t.jsx)(D.A,{className:"h-5 w-5"}),"Create Automation"]})})]})]}),(0,t.jsx)(o.Zp,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,t.jsxs)("div",{className:"flex-1 relative",children:[(0,t.jsx)(F.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-slate-400"}),(0,t.jsx)(d.p,{placeholder:"Search automations...",value:p,onChange:e=>N(e.target.value),className:"pl-10"})]}),(0,t.jsxs)(x.l6,{value:f,onValueChange:e=>w(e),children:[(0,t.jsx)(x.bq,{className:"w-full md:w-48",children:(0,t.jsx)(x.yv,{placeholder:"Filter by status"})}),(0,t.jsxs)(x.gC,{children:[(0,t.jsx)(x.eb,{value:"all",children:"All Status"}),(0,t.jsx)(x.eb,{value:"active",children:"Active Only"}),(0,t.jsx)(x.eb,{value:"inactive",children:"Inactive Only"})]})]}),(0,t.jsxs)(x.l6,{value:y,onValueChange:e=>A(e),children:[(0,t.jsx)(x.bq,{className:"w-full md:w-48",children:(0,t.jsx)(x.yv,{placeholder:"Filter by trigger"})}),(0,t.jsxs)(x.gC,{children:[(0,t.jsx)(x.eb,{value:"all",children:"All Triggers"}),(0,t.jsx)(x.eb,{value:"WEBHOOK",children:"Webhook"}),(0,t.jsx)(x.eb,{value:"SCHEDULE",children:"Schedule"}),(0,t.jsx)(x.eb,{value:"EVENT",children:"Event"}),(0,t.jsx)(x.eb,{value:"MANUAL",children:"Manual"}),(0,t.jsx)(x.eb,{value:"API",children:"API"})]})]})]})}),v&&(0,t.jsxs)(m.Fc,{variant:"error",showIcon:!0,children:[(0,t.jsx)(m.XL,{children:"Error"}),(0,t.jsx)(m.TN,{children:v})]}),u&&(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(e=>(0,t.jsx)(o.Zp,{className:"h-64",children:(0,t.jsxs)("div",{className:"p-6 space-y-4",children:[(0,t.jsx)(h.EA,{className:"h-6 w-3/4"}),(0,t.jsx)(h.EA,{className:"h-4 w-full"}),(0,t.jsx)(h.EA,{className:"h-4 w-full"}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4 pt-4",children:[(0,t.jsx)(h.EA,{className:"h-12"}),(0,t.jsx)(h.EA,{className:"h-12"}),(0,t.jsx)(h.EA,{className:"h-12"})]})]})},e))}),!u&&0===T.length&&!v&&(0,t.jsx)(o.Zp,{className:"text-center py-12",children:(0,t.jsxs)("div",{className:"max-w-md mx-auto space-y-4",children:[(0,t.jsx)("div",{className:"text-4xl",children:"\uD83E\uDD16"}),(0,t.jsx)("h3",{className:"text-xl font-bold text-astralis-navy",children:p||"all"!==f||"all"!==y?"No automations found":"No automations yet"}),(0,t.jsx)("p",{className:"text-slate-600",children:p||"all"!==f||"all"!==y?"Try adjusting your filters to see more results.":"Get started by creating your first automation workflow."}),!p&&"all"===f&&"all"===y&&(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 justify-center pt-4",children:[(0,t.jsx)(r.$,{variant:"primary",asChild:!0,children:(0,t.jsxs)(n(),{href:"/automations/new",children:[(0,t.jsx)(D.A,{className:"w-5 h-5 mr-2"}),"Create Automation"]})}),(0,t.jsx)(r.$,{variant:"secondary",asChild:!0,children:(0,t.jsx)(n(),{href:"/automations/templates",children:"Browse Templates"})})]})]})}),!u&&T.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("p",{className:"text-sm text-slate-600",children:["Showing ",T.length," of ",a.length," automation",1!==a.length?"s":""]})}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:T.map(e=>(0,t.jsx)(k,{automation:e,onToggle:b,onDelete:C,onExecute:S},e.id))})]})]})})}}},e=>{e.O(0,[4909,2619,756,9566,4657,3645,9290,7546,4628,8296,3432,207,1101,9336,4007,6011,9248,9084,7358],()=>e(e.s=33888)),_N_E=e.O()}]);